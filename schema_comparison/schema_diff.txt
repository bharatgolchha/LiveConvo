--- schema_comparison/prod_schema.sql	2025-07-15 13:43:35
+++ schema_comparison/dev_schema.sql	2025-07-15 13:41:15
@@ -2,10 +2,10 @@
 -- PostgreSQL database dump
 --
 
--- Dumped from database version 17.4
+-- Dumped from database version 15.8
 -- Dumped by pg_dump version 17.5 (Homebrew)
 
--- Started on 2025-07-15 13:41:30 +0545
+-- Started on 2025-07-15 13:40:47 +0545
 
 SET statement_timeout = 0;
 SET lock_timeout = 0;
@@ -20,7 +20,7 @@
 SET row_security = off;
 
 --
--- TOC entry 19 (class 2615 OID 16492)
+-- TOC entry 37 (class 2615 OID 16481)
 -- Name: auth; Type: SCHEMA; Schema: -; Owner: supabase_admin
 --
 
@@ -30,7 +30,7 @@
 ALTER SCHEMA auth OWNER TO supabase_admin;
 
 --
--- TOC entry 15 (class 2615 OID 16388)
+-- TOC entry 23 (class 2615 OID 16388)
 -- Name: extensions; Type: SCHEMA; Schema: -; Owner: postgres
 --
 
@@ -40,7 +40,7 @@
 ALTER SCHEMA extensions OWNER TO postgres;
 
 --
--- TOC entry 17 (class 2615 OID 16622)
+-- TOC entry 35 (class 2615 OID 16611)
 -- Name: graphql; Type: SCHEMA; Schema: -; Owner: supabase_admin
 --
 
@@ -50,7 +50,7 @@
 ALTER SCHEMA graphql OWNER TO supabase_admin;
 
 --
--- TOC entry 16 (class 2615 OID 16611)
+-- TOC entry 34 (class 2615 OID 16600)
 -- Name: graphql_public; Type: SCHEMA; Schema: -; Owner: supabase_admin
 --
 
@@ -60,7 +60,7 @@
 ALTER SCHEMA graphql_public OWNER TO supabase_admin;
 
 --
--- TOC entry 12 (class 2615 OID 16386)
+-- TOC entry 13 (class 2615 OID 16386)
 -- Name: pgbouncer; Type: SCHEMA; Schema: -; Owner: pgbouncer
 --
 
@@ -70,7 +70,7 @@
 ALTER SCHEMA pgbouncer OWNER TO pgbouncer;
 
 --
--- TOC entry 20 (class 2615 OID 16603)
+-- TOC entry 41 (class 2615 OID 16592)
 -- Name: realtime; Type: SCHEMA; Schema: -; Owner: supabase_admin
 --
 
@@ -80,7 +80,7 @@
 ALTER SCHEMA realtime OWNER TO supabase_admin;
 
 --
--- TOC entry 18 (class 2615 OID 16540)
+-- TOC entry 36 (class 2615 OID 16529)
 -- Name: storage; Type: SCHEMA; Schema: -; Owner: supabase_admin
 --
 
@@ -90,7 +90,7 @@
 ALTER SCHEMA storage OWNER TO supabase_admin;
 
 --
--- TOC entry 10 (class 2615 OID 17269)
+-- TOC entry 85 (class 2615 OID 28923)
 -- Name: supabase_migrations; Type: SCHEMA; Schema: -; Owner: postgres
 --
 
@@ -100,7 +100,7 @@
 ALTER SCHEMA supabase_migrations OWNER TO postgres;
 
 --
--- TOC entry 14 (class 2615 OID 16651)
+-- TOC entry 32 (class 2615 OID 16638)
 -- Name: vault; Type: SCHEMA; Schema: -; Owner: supabase_admin
 --
 
@@ -110,7 +110,7 @@
 ALTER SCHEMA vault OWNER TO supabase_admin;
 
 --
--- TOC entry 6 (class 3079 OID 16687)
+-- TOC entry 7 (class 3079 OID 16666)
 -- Name: pg_graphql; Type: EXTENSION; Schema: -; Owner: -
 --
 
@@ -118,8 +118,8 @@
 
 
 --
--- TOC entry 5474 (class 0 OID 0)
--- Dependencies: 6
+-- TOC entry 5596 (class 0 OID 0)
+-- Dependencies: 7
 -- Name: EXTENSION pg_graphql; Type: COMMENT; Schema: -; Owner: 
 --
 
@@ -127,7 +127,7 @@
 
 
 --
--- TOC entry 2 (class 3079 OID 16389)
+-- TOC entry 3 (class 3079 OID 16389)
 -- Name: pg_stat_statements; Type: EXTENSION; Schema: -; Owner: -
 --
 
@@ -135,8 +135,8 @@
 
 
 --
--- TOC entry 5475 (class 0 OID 0)
--- Dependencies: 2
+-- TOC entry 5597 (class 0 OID 0)
+-- Dependencies: 3
 -- Name: EXTENSION pg_stat_statements; Type: COMMENT; Schema: -; Owner: 
 --
 
@@ -144,7 +144,7 @@
 
 
 --
--- TOC entry 4 (class 3079 OID 16441)
+-- TOC entry 5 (class 3079 OID 16434)
 -- Name: pgcrypto; Type: EXTENSION; Schema: -; Owner: -
 --
 
@@ -152,8 +152,8 @@
 
 
 --
--- TOC entry 5476 (class 0 OID 0)
--- Dependencies: 4
+-- TOC entry 5598 (class 0 OID 0)
+-- Dependencies: 5
 -- Name: EXTENSION pgcrypto; Type: COMMENT; Schema: -; Owner: 
 --
 
@@ -161,7 +161,7 @@
 
 
 --
--- TOC entry 5 (class 3079 OID 16652)
+-- TOC entry 6 (class 3079 OID 16639)
 -- Name: supabase_vault; Type: EXTENSION; Schema: -; Owner: -
 --
 
@@ -169,8 +169,8 @@
 
 
 --
--- TOC entry 5477 (class 0 OID 0)
--- Dependencies: 5
+-- TOC entry 5599 (class 0 OID 0)
+-- Dependencies: 6
 -- Name: EXTENSION supabase_vault; Type: COMMENT; Schema: -; Owner: 
 --
 
@@ -178,7 +178,7 @@
 
 
 --
--- TOC entry 3 (class 3079 OID 16430)
+-- TOC entry 4 (class 3079 OID 16423)
 -- Name: uuid-ossp; Type: EXTENSION; Schema: -; Owner: -
 --
 
@@ -186,8 +186,8 @@
 
 
 --
--- TOC entry 5478 (class 0 OID 0)
--- Dependencies: 3
+-- TOC entry 5600 (class 0 OID 0)
+-- Dependencies: 4
 -- Name: EXTENSION "uuid-ossp"; Type: COMMENT; Schema: -; Owner: 
 --
 
@@ -195,7 +195,7 @@
 
 
 --
--- TOC entry 7 (class 3079 OID 35065)
+-- TOC entry 2 (class 3079 OID 80908)
 -- Name: vector; Type: EXTENSION; Schema: -; Owner: -
 --
 
@@ -203,8 +203,8 @@
 
 
 --
--- TOC entry 5479 (class 0 OID 0)
--- Dependencies: 7
+-- TOC entry 5601 (class 0 OID 0)
+-- Dependencies: 2
 -- Name: EXTENSION vector; Type: COMMENT; Schema: -; Owner: 
 --
 
@@ -212,7 +212,7 @@
 
 
 --
--- TOC entry 1250 (class 1247 OID 16780)
+-- TOC entry 1344 (class 1247 OID 16756)
 -- Name: aal_level; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -226,7 +226,7 @@
 ALTER TYPE auth.aal_level OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 1274 (class 1247 OID 16921)
+-- TOC entry 1368 (class 1247 OID 16897)
 -- Name: code_challenge_method; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -239,7 +239,7 @@
 ALTER TYPE auth.code_challenge_method OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 1247 (class 1247 OID 16774)
+-- TOC entry 1341 (class 1247 OID 16750)
 -- Name: factor_status; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -252,7 +252,7 @@
 ALTER TYPE auth.factor_status OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 1244 (class 1247 OID 16769)
+-- TOC entry 1338 (class 1247 OID 16744)
 -- Name: factor_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -266,7 +266,7 @@
 ALTER TYPE auth.factor_type OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 1280 (class 1247 OID 16963)
+-- TOC entry 1374 (class 1247 OID 16939)
 -- Name: one_time_token_type; Type: TYPE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -283,7 +283,7 @@
 ALTER TYPE auth.one_time_token_type OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 1487 (class 1247 OID 32181)
+-- TOC entry 1548 (class 1247 OID 76197)
 -- Name: referral_event_type; Type: TYPE; Schema: public; Owner: postgres
 --
 
@@ -307,16 +307,7 @@
 ALTER TYPE public.referral_event_type OWNER TO postgres;
 
 --
--- TOC entry 5485 (class 0 OID 0)
--- Dependencies: 1487
--- Name: TYPE referral_event_type; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON TYPE public.referral_event_type IS 'Enum type for tracking different referral system events';
-
-
---
--- TOC entry 1463 (class 1247 OID 26887)
+-- TOC entry 1498 (class 1247 OID 76113)
 -- Name: referral_status; Type: TYPE; Schema: public; Owner: postgres
 --
 
@@ -331,7 +322,7 @@
 ALTER TYPE public.referral_status OWNER TO postgres;
 
 --
--- TOC entry 1295 (class 1247 OID 17134)
+-- TOC entry 1443 (class 1247 OID 17105)
 -- Name: action; Type: TYPE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -347,7 +338,7 @@
 ALTER TYPE realtime.action OWNER TO supabase_admin;
 
 --
--- TOC entry 1304 (class 1247 OID 17090)
+-- TOC entry 1389 (class 1247 OID 17037)
 -- Name: equality_op; Type: TYPE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -365,7 +356,7 @@
 ALTER TYPE realtime.equality_op OWNER TO supabase_admin;
 
 --
--- TOC entry 1307 (class 1247 OID 17105)
+-- TOC entry 1392 (class 1247 OID 17052)
 -- Name: user_defined_filter; Type: TYPE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -379,7 +370,7 @@
 ALTER TYPE realtime.user_defined_filter OWNER TO supabase_admin;
 
 --
--- TOC entry 1301 (class 1247 OID 17177)
+-- TOC entry 1449 (class 1247 OID 17146)
 -- Name: wal_column; Type: TYPE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -396,7 +387,7 @@
 ALTER TYPE realtime.wal_column OWNER TO supabase_admin;
 
 --
--- TOC entry 1298 (class 1247 OID 17147)
+-- TOC entry 1446 (class 1247 OID 17117)
 -- Name: wal_rls; Type: TYPE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -411,7 +402,7 @@
 ALTER TYPE realtime.wal_rls OWNER TO supabase_admin;
 
 --
--- TOC entry 395 (class 1255 OID 16538)
+-- TOC entry 464 (class 1255 OID 16527)
 -- Name: email(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -429,8 +420,8 @@
 ALTER FUNCTION auth.email() OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5519 (class 0 OID 0)
--- Dependencies: 395
+-- TOC entry 5640 (class 0 OID 0)
+-- Dependencies: 464
 -- Name: FUNCTION email(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -438,7 +429,7 @@
 
 
 --
--- TOC entry 414 (class 1255 OID 16751)
+-- TOC entry 624 (class 1255 OID 16726)
 -- Name: jwt(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -456,7 +447,7 @@
 ALTER FUNCTION auth.jwt() OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 394 (class 1255 OID 16537)
+-- TOC entry 463 (class 1255 OID 16526)
 -- Name: role(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -474,8 +465,8 @@
 ALTER FUNCTION auth.role() OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5522 (class 0 OID 0)
--- Dependencies: 394
+-- TOC entry 5643 (class 0 OID 0)
+-- Dependencies: 463
 -- Name: FUNCTION role(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -483,7 +474,7 @@
 
 
 --
--- TOC entry 393 (class 1255 OID 16536)
+-- TOC entry 462 (class 1255 OID 16525)
 -- Name: uid(); Type: FUNCTION; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -501,8 +492,8 @@
 ALTER FUNCTION auth.uid() OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5524 (class 0 OID 0)
--- Dependencies: 393
+-- TOC entry 5645 (class 0 OID 0)
+-- Dependencies: 462
 -- Name: FUNCTION uid(); Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -510,7 +501,7 @@
 
 
 --
--- TOC entry 396 (class 1255 OID 16595)
+-- TOC entry 623 (class 1255 OID 16584)
 -- Name: grant_pg_cron_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
 --
 
@@ -550,8 +541,8 @@
 ALTER FUNCTION extensions.grant_pg_cron_access() OWNER TO supabase_admin;
 
 --
--- TOC entry 5540 (class 0 OID 0)
--- Dependencies: 396
+-- TOC entry 5661 (class 0 OID 0)
+-- Dependencies: 623
 -- Name: FUNCTION grant_pg_cron_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
 --
 
@@ -559,7 +550,7 @@
 
 
 --
--- TOC entry 400 (class 1255 OID 16616)
+-- TOC entry 543 (class 1255 OID 16605)
 -- Name: grant_pg_graphql_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
 --
 
@@ -620,8 +611,8 @@
 ALTER FUNCTION extensions.grant_pg_graphql_access() OWNER TO supabase_admin;
 
 --
--- TOC entry 5542 (class 0 OID 0)
--- Dependencies: 400
+-- TOC entry 5663 (class 0 OID 0)
+-- Dependencies: 543
 -- Name: FUNCTION grant_pg_graphql_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
 --
 
@@ -629,7 +620,7 @@
 
 
 --
--- TOC entry 397 (class 1255 OID 16597)
+-- TOC entry 529 (class 1255 OID 16586)
 -- Name: grant_pg_net_access(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
 --
 
@@ -683,8 +674,8 @@
 ALTER FUNCTION extensions.grant_pg_net_access() OWNER TO supabase_admin;
 
 --
--- TOC entry 5544 (class 0 OID 0)
--- Dependencies: 397
+-- TOC entry 5665 (class 0 OID 0)
+-- Dependencies: 529
 -- Name: FUNCTION grant_pg_net_access(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
 --
 
@@ -692,7 +683,7 @@
 
 
 --
--- TOC entry 398 (class 1255 OID 16607)
+-- TOC entry 541 (class 1255 OID 16596)
 -- Name: pgrst_ddl_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
 --
 
@@ -728,7 +719,7 @@
 ALTER FUNCTION extensions.pgrst_ddl_watch() OWNER TO supabase_admin;
 
 --
--- TOC entry 399 (class 1255 OID 16608)
+-- TOC entry 523 (class 1255 OID 16597)
 -- Name: pgrst_drop_watch(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
 --
 
@@ -762,7 +753,7 @@
 ALTER FUNCTION extensions.pgrst_drop_watch() OWNER TO supabase_admin;
 
 --
--- TOC entry 401 (class 1255 OID 16618)
+-- TOC entry 621 (class 1255 OID 16607)
 -- Name: set_graphql_placeholder(); Type: FUNCTION; Schema: extensions; Owner: supabase_admin
 --
 
@@ -822,8 +813,8 @@
 ALTER FUNCTION extensions.set_graphql_placeholder() OWNER TO supabase_admin;
 
 --
--- TOC entry 5573 (class 0 OID 0)
--- Dependencies: 401
+-- TOC entry 5694 (class 0 OID 0)
+-- Dependencies: 621
 -- Name: FUNCTION set_graphql_placeholder(); Type: COMMENT; Schema: extensions; Owner: supabase_admin
 --
 
@@ -831,7 +822,7 @@
 
 
 --
--- TOC entry 343 (class 1255 OID 16387)
+-- TOC entry 399 (class 1255 OID 16387)
 -- Name: get_auth(text); Type: FUNCTION; Schema: pgbouncer; Owner: supabase_admin
 --
 
@@ -857,38 +848,116 @@
 ALTER FUNCTION pgbouncer.get_auth(p_usename text) OWNER TO supabase_admin;
 
 --
--- TOC entry 446 (class 1255 OID 18713)
+-- TOC entry 448 (class 1255 OID 56217)
 -- Name: auto_complete_orphaned_recordings(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.auto_complete_orphaned_recordings() RETURNS TABLE(updated_count integer)
-    LANGUAGE plpgsql SECURITY DEFINER
+CREATE FUNCTION public.auto_complete_orphaned_recordings() RETURNS TABLE(sessions_fixed integer, bot_records_fixed integer, total_minutes_recovered integer)
+    LANGUAGE plpgsql
     AS $$
 DECLARE
-    v_updated_count INTEGER;
+    sessions_count INTEGER := 0;
+    bot_count INTEGER := 0;
+    minutes_recovered INTEGER := 0;
 BEGIN
-    -- Update sessions that have been recording for more than 2 hours without activity
-    UPDATE sessions
-    SET 
-        is_recording = FALSE,
-        recording_stopped_at = COALESCE(recording_stopped_at, CURRENT_TIMESTAMP),
-        finalized_at = COALESCE(finalized_at, CURRENT_TIMESTAMP),
-        updated_at = CURRENT_TIMESTAMP
-    WHERE 
-        is_recording = TRUE
-        AND recording_started_at < CURRENT_TIMESTAMP - INTERVAL '2 hours'
-        AND (
-            updated_at < CURRENT_TIMESTAMP - INTERVAL '10 minutes'
-            OR NOT EXISTS (
-                SELECT 1 FROM transcripts t 
-                WHERE t.session_id = sessions.id 
-                AND t.created_at > CURRENT_TIMESTAMP - INTERVAL '10 minutes'
-            )
-        );
-    
-    GET DIAGNOSTICS v_updated_count = ROW_COUNT;
-    
-    RETURN QUERY SELECT v_updated_count;
+    -- Auto-complete orphaned bot recordings
+    WITH orphaned_sessions AS (
+        SELECT DISTINCT
+            but.bot_id,
+            but.session_id,
+            but.user_id,
+            but.organization_id,
+            but.recording_started_at,
+            s.recording_ended_at,
+            s.status as session_status,
+            but.status as bot_status,
+            -- Find latest transcript for this session
+            COALESCE(
+                (SELECT MAX(created_at) FROM transcripts WHERE session_id = but.session_id),
+                but.recording_started_at
+            ) as last_transcript_time,
+            -- Calculate if this should be considered "orphaned"
+            CASE 
+                WHEN s.recording_ended_at IS NOT NULL AND but.recording_ended_at IS NULL THEN 'session_ended_but_bot_active'
+                WHEN s.status = 'completed' AND but.status = 'recording' THEN 'session_completed_but_bot_recording'
+                WHEN but.recording_started_at < NOW() - INTERVAL '5 minutes' 
+                     AND COALESCE((SELECT MAX(created_at) FROM transcripts WHERE session_id = but.session_id), but.recording_started_at) < NOW() - INTERVAL '5 minutes'
+                     AND but.status = 'recording' THEN 'no_activity_timeout'
+                ELSE NULL
+            END as orphan_reason
+        FROM bot_usage_tracking but
+        JOIN sessions s ON s.id = but.session_id
+        WHERE but.status = 'recording'
+            AND but.recording_started_at IS NOT NULL
+    ),
+    orphan_calculations AS (
+        SELECT 
+            bot_id,
+            session_id,
+            user_id,
+            organization_id,
+            recording_started_at,
+            orphan_reason,
+            -- Calculate what the end time should be
+            CASE 
+                WHEN orphan_reason = 'session_ended_but_bot_active' THEN 
+                    (SELECT recording_ended_at FROM sessions WHERE id = session_id)
+                WHEN orphan_reason = 'session_completed_but_bot_recording' THEN 
+                    COALESCE(
+                        (SELECT recording_ended_at FROM sessions WHERE id = session_id),
+                        last_transcript_time + INTERVAL '30 seconds'
+                    )
+                WHEN orphan_reason = 'no_activity_timeout' THEN 
+                    last_transcript_time + INTERVAL '30 seconds'
+                ELSE NULL
+            END as calculated_end_time
+        FROM orphaned_sessions 
+        WHERE orphan_reason IS NOT NULL
+    ),
+    calculated_usage AS (
+        SELECT 
+            *,
+            EXTRACT(EPOCH FROM (calculated_end_time - recording_started_at))::INTEGER as duration_seconds,
+            CEIL(EXTRACT(EPOCH FROM (calculated_end_time - recording_started_at)) / 60.0)::INTEGER as billable_minutes
+        FROM orphan_calculations
+        WHERE calculated_end_time IS NOT NULL
+            AND calculated_end_time > recording_started_at
+    ),
+    bot_updates AS (
+        UPDATE bot_usage_tracking 
+        SET 
+            recording_ended_at = cu.calculated_end_time,
+            total_recording_seconds = cu.duration_seconds,
+            billable_minutes = cu.billable_minutes,
+            status = 'completed',
+            updated_at = NOW()
+        FROM calculated_usage cu
+        WHERE bot_usage_tracking.bot_id = cu.bot_id
+            AND bot_usage_tracking.status = 'recording'
+        RETURNING bot_usage_tracking.session_id, cu.billable_minutes
+    ),
+    session_updates AS (
+        UPDATE sessions 
+        SET 
+            bot_recording_minutes = bu.billable_minutes,
+            bot_billable_amount = (bu.billable_minutes * 0.10)::DECIMAL(10,2),
+            recall_bot_status = 'completed',
+            status = CASE WHEN status = 'active' THEN 'completed' ELSE status END,
+            updated_at = NOW()
+        FROM bot_updates bu
+        WHERE sessions.id = bu.session_id
+        RETURNING sessions.id, bu.billable_minutes
+    )
+    SELECT 
+        COUNT(DISTINCT su.id)::INTEGER,
+        COUNT(DISTINCT bu.session_id)::INTEGER,
+        COALESCE(SUM(su.billable_minutes), 0)::INTEGER
+    INTO sessions_count, bot_count, minutes_recovered
+    FROM session_updates su
+    FULL OUTER JOIN bot_updates bu ON su.id = bu.session_id;
+
+    -- Return the results
+    RETURN QUERY SELECT sessions_count, bot_count, minutes_recovered;
 END;
 $$;
 
@@ -896,7 +965,7 @@
 ALTER FUNCTION public.auto_complete_orphaned_recordings() OWNER TO postgres;
 
 --
--- TOC entry 454 (class 1255 OID 24383)
+-- TOC entry 397 (class 1255 OID 60792)
 -- Name: calculate_bot_usage_metrics(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -921,7 +990,34 @@
 ALTER FUNCTION public.calculate_bot_usage_metrics() OWNER TO postgres;
 
 --
--- TOC entry 457 (class 1255 OID 24386)
+-- TOC entry 400 (class 1255 OID 67000)
+-- Name: can_access_session(uuid, uuid); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.can_access_session(p_session_id uuid, p_user_id uuid) RETURNS boolean
+    LANGUAGE plpgsql SECURITY DEFINER
+    AS $$
+BEGIN
+  RETURN EXISTS (
+    SELECT 1 FROM sessions 
+    WHERE id = p_session_id 
+    AND (
+      user_id = p_user_id OR
+      EXISTS (
+        SELECT 1 FROM report_collaborators rc
+        WHERE rc.session_id = p_session_id 
+        AND rc.user_id = p_user_id
+      )
+    )
+  );
+END;
+$$;
+
+
+ALTER FUNCTION public.can_access_session(p_session_id uuid, p_user_id uuid) OWNER TO postgres;
+
+--
+-- TOC entry 647 (class 1255 OID 39018)
 -- Name: cancel_old_subscriptions(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -950,200 +1046,65 @@
 ALTER FUNCTION public.cancel_old_subscriptions() OWNER TO postgres;
 
 --
--- TOC entry 451 (class 1255 OID 23582)
--- Name: check_and_enforce_bot_limits(); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 510 (class 1255 OID 65706)
+-- Name: check_single_owner_org_per_user(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.check_and_enforce_bot_limits() RETURNS TABLE(session_id uuid, bot_id text, user_id uuid, minutes_used integer, minutes_limit integer, is_over_limit boolean, grace_period_remaining integer, should_stop boolean)
+CREATE FUNCTION public.check_single_owner_org_per_user() RETURNS trigger
     LANGUAGE plpgsql
     AS $$
-DECLARE
-  GRACE_PERIOD_MINUTES CONSTANT INTEGER := 5;
 BEGIN
-  RETURN QUERY
-  WITH active_bots AS (
-    SELECT 
-      but.session_id,
-      but.bot_id,
-      but.user_id,
-      but.organization_id,
-      but.started_at,
-      but.grace_period_notified,
-      but.grace_period_started_at,
-      EXTRACT(EPOCH FROM (NOW() - but.started_at))::INTEGER / 60 AS current_minutes
-    FROM bot_usage_tracking but
-    WHERE but.status = 'active'
-      AND but.ended_at IS NULL
-  ),
-  user_limits AS (
-    SELECT 
-      ab.session_id,
-      ab.bot_id,
-      ab.user_id,
-      ab.current_minutes::INTEGER as minutes_used,
-      COALESCE(
-        (SELECT COALESCE(om.monthly_audio_hours_limit, o.monthly_audio_hours_limit, 10) * 60
-         FROM organizations o
-         LEFT JOIN organization_members om ON om.user_id = ab.user_id AND om.organization_id = o.id
-         WHERE o.id = ab.organization_id
-         LIMIT 1),
-        600
-      ) AS minutes_limit,
-      (SELECT COALESCE(SUM(total_minutes_used), 0)
-       FROM monthly_usage_cache muc
-       WHERE muc.user_id = ab.user_id 
-         AND muc.organization_id = ab.organization_id
-         AND muc.month_year = TO_CHAR(CURRENT_DATE, 'YYYY-MM')
-      ) AS total_monthly_minutes
-    FROM active_bots ab
-  )
-  SELECT 
-    ul.session_id,
-    ul.bot_id,
-    ul.user_id,
-    ul.minutes_used,
-    ul.minutes_limit,
-    (ul.total_monthly_minutes + ul.minutes_used) > ul.minutes_limit AS is_over_limit,
-    CASE 
-      WHEN ab.grace_period_started_at IS NOT NULL THEN
-        GREATEST(0, GRACE_PERIOD_MINUTES - EXTRACT(EPOCH FROM (NOW() - ab.grace_period_started_at))::INTEGER / 60)
-      ELSE 0
-    END::INTEGER AS grace_period_remaining,
-    -- Should stop if over limit and grace period has expired
-    CASE
-      WHEN (ul.total_monthly_minutes + ul.minutes_used) > ul.minutes_limit THEN
-        CASE
-          WHEN ab.grace_period_started_at IS NULL THEN FALSE -- Grace period not started yet
-          WHEN EXTRACT(EPOCH FROM (NOW() - ab.grace_period_started_at)) > (GRACE_PERIOD_MINUTES * 60) THEN TRUE -- Grace period expired
-          ELSE FALSE -- Still in grace period
-        END
-      ELSE FALSE
-    END AS should_stop
-  FROM user_limits ul
-  JOIN active_bots ab ON ul.session_id = ab.session_id;
+  -- Only check for 'owner' role insertions
+  IF NEW.role = 'owner' THEN
+    -- Check if user already owns another organization
+    IF EXISTS (
+      SELECT 1 
+      FROM organization_members 
+      WHERE user_id = NEW.user_id 
+      AND role = 'owner' 
+      AND status = 'active'
+      AND organization_id != NEW.organization_id
+    ) THEN
+      RAISE EXCEPTION 'User already owns an organization. A user can only own one organization at a time.';
+    END IF;
+  END IF;
+  
+  RETURN NEW;
 END;
 $$;
 
 
-ALTER FUNCTION public.check_and_enforce_bot_limits() OWNER TO postgres;
+ALTER FUNCTION public.check_single_owner_org_per_user() OWNER TO postgres;
 
 --
--- TOC entry 5592 (class 0 OID 0)
--- Dependencies: 451
--- Name: FUNCTION check_and_enforce_bot_limits(); Type: COMMENT; Schema: public; Owner: postgres
+-- TOC entry 5714 (class 0 OID 0)
+-- Dependencies: 510
+-- Name: FUNCTION check_single_owner_org_per_user(); Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON FUNCTION public.check_and_enforce_bot_limits() IS 'Checks active bots against user limits and determines which should be stopped after grace period';
+COMMENT ON FUNCTION public.check_single_owner_org_per_user() IS 'Ensures a user can only own one organization at a time to prevent duplicate individual organizations';
 
 
 --
--- TOC entry 459 (class 1255 OID 26976)
--- Name: check_referral_limits(uuid, inet, text); Type: FUNCTION; Schema: public; Owner: postgres
---
-
-CREATE FUNCTION public.check_referral_limits(p_referrer_id uuid, p_ip_address inet, p_device_id text) RETURNS boolean
-    LANGUAGE plpgsql
-    AS $$
-DECLARE
-    v_daily_limit INTEGER := 5;
-    v_ip_count INTEGER;
-    v_device_count INTEGER;
-BEGIN
-    -- Check IP-based limit
-    SELECT COUNT(*)
-    INTO v_ip_count
-    FROM public.user_referrals
-    WHERE referrer_user_id = p_referrer_id
-        AND ip_address = p_ip_address
-        AND created_at > NOW() - INTERVAL '24 hours';
-    
-    IF v_ip_count >= v_daily_limit THEN
-        RETURN FALSE;
-    END IF;
-    
-    -- Check device-based limit
-    IF p_device_id IS NOT NULL THEN
-        SELECT COUNT(*)
-        INTO v_device_count
-        FROM public.user_referrals
-        WHERE referrer_user_id = p_referrer_id
-            AND device_id = p_device_id
-            AND created_at > NOW() - INTERVAL '24 hours';
-        
-        IF v_device_count >= v_daily_limit THEN
-            RETURN FALSE;
-        END IF;
-    END IF;
-    
-    RETURN TRUE;
-END;
-$$;
-
-
-ALTER FUNCTION public.check_referral_limits(p_referrer_id uuid, p_ip_address inet, p_device_id text) OWNER TO postgres;
-
---
--- TOC entry 437 (class 1255 OID 17279)
+-- TOC entry 520 (class 1255 OID 39039)
 -- Name: check_usage_limit(uuid, uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.check_usage_limit(p_user_id uuid, p_organization_id uuid) RETURNS TABLE(can_record boolean, minutes_used integer, minutes_limit integer, minutes_remaining integer, percentage_used numeric)
-    LANGUAGE plpgsql
+CREATE FUNCTION public.check_usage_limit(p_user_id uuid, p_organization_id uuid) RETURNS TABLE(can_record boolean, minutes_used integer, minutes_limit integer, minutes_remaining integer, percentage_used integer)
+    LANGUAGE plpgsql SECURITY DEFINER
     AS $$
 DECLARE
-    v_minutes_used integer;
-    v_minutes_limit integer;
-    v_plan_limit integer;
-    v_member_limit integer;
-    current_month varchar(7);
+    v_result record;
 BEGIN
-    -- Get current month
-    current_month := TO_CHAR(CURRENT_DATE, 'YYYY-MM');
+    -- Call the v2 function and return compatible results
+    SELECT * INTO v_result FROM check_usage_limit_v2(p_user_id, p_organization_id);
     
-    -- Get usage from cache (default to 0 if not found)
-    SELECT COALESCE(total_minutes_used, 0) INTO v_minutes_used
-    FROM monthly_usage_cache
-    WHERE user_id = p_user_id 
-    AND organization_id = p_organization_id
-    AND month_year = current_month;
-    
-    -- If no usage record exists, set to 0
-    IF v_minutes_used IS NULL THEN
-        v_minutes_used := 0;
-    END IF;
-    
-    -- Get limits from organization and member settings
-    SELECT 
-        COALESCE(o.monthly_audio_hours_limit, 10) * 60,  -- Default to 10 hours if NULL
-        COALESCE(om.monthly_audio_hours_limit, 0) * 60
-    INTO v_plan_limit, v_member_limit
-    FROM organizations o
-    LEFT JOIN organization_members om ON om.user_id = p_user_id AND om.organization_id = o.id
-    WHERE o.id = p_organization_id;
-    
-    -- If no organization found, use default
-    IF v_plan_limit IS NULL THEN
-        v_plan_limit := 600;  -- 10 hours default
-    END IF;
-    
-    -- Use the most restrictive limit (but ignore 0 values)
-    IF v_member_limit > 0 THEN
-        v_minutes_limit := LEAST(v_plan_limit, v_member_limit);
-    ELSE
-        v_minutes_limit := v_plan_limit;
-    END IF;
-    
     RETURN QUERY SELECT 
-        v_minutes_used < v_minutes_limit AS can_record,
-        v_minutes_used AS minutes_used,
-        v_minutes_limit AS minutes_limit,
-        GREATEST(0, v_minutes_limit - v_minutes_used) AS minutes_remaining,
-        CASE 
-            WHEN v_minutes_limit > 0 THEN 
-                ROUND((v_minutes_used::numeric / v_minutes_limit) * 100, 2)
-            ELSE 
-                0
-        END AS percentage_used;
+        v_result.can_record,
+        v_result.minutes_used,
+        v_result.minutes_limit,
+        v_result.minutes_remaining,
+        v_result.percentage_used::integer;
 END;
 $$;
 
@@ -1151,18 +1112,37 @@
 ALTER FUNCTION public.check_usage_limit(p_user_id uuid, p_organization_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 453 (class 1255 OID 24382)
+-- TOC entry 486 (class 1255 OID 74986)
 -- Name: check_usage_limit_v2(uuid, uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
 CREATE FUNCTION public.check_usage_limit_v2(p_user_id uuid, p_organization_id uuid) RETURNS TABLE(can_record boolean, minutes_used integer, minutes_limit integer, minutes_remaining integer, percentage_used numeric, is_unlimited boolean)
-    LANGUAGE plpgsql
+    LANGUAGE plpgsql SECURITY DEFINER
     AS $$
 DECLARE
   user_limit INTEGER;
   user_used INTEGER;
   is_unlimited_plan BOOLEAN;
+  billing_start TIMESTAMP WITH TIME ZONE;
+  billing_end TIMESTAMP WITH TIME ZONE;
 BEGIN
+  -- Get the current billing period from active subscription
+  SELECT 
+    s.current_period_start,
+    s.current_period_end
+  INTO billing_start, billing_end
+  FROM subscriptions s
+  WHERE s.organization_id = p_organization_id
+    AND s.status = 'active'
+  ORDER BY s.created_at DESC
+  LIMIT 1;
+  
+  -- If no active subscription, use current calendar month as fallback
+  IF billing_start IS NULL THEN
+    billing_start := DATE_TRUNC('month', NOW());
+    billing_end := DATE_TRUNC('month', NOW()) + INTERVAL '1 month';
+  END IF;
+
   -- Get user's current plan limit - prioritize bot minutes over audio hours
   SELECT 
     COALESCE(
@@ -1198,23 +1178,26 @@
     LIMIT 1;
   END IF;
   
-  -- Get current month usage from cache
-  SELECT COALESCE(total_minutes_used, 0)
+  -- Calculate usage for the billing period
+  -- First check bot_usage_tracking for bot minutes
+  SELECT COALESCE(SUM(billable_minutes), 0)::INTEGER
   INTO user_used
-  FROM monthly_usage_cache 
+  FROM bot_usage_tracking
   WHERE user_id = p_user_id 
     AND organization_id = p_organization_id
-    AND month_year = to_char(now(), 'YYYY-MM')
-  LIMIT 1;
+    AND created_at >= billing_start
+    AND created_at < billing_end;
   
-  -- If no cache, calculate from usage_tracking (including bot usage)
-  IF user_used IS NULL THEN
-    SELECT COALESCE(CEILING(SUM(seconds_recorded) / 60.0), 0)
+  -- If no bot usage, check sessions table as fallback
+  IF user_used = 0 THEN
+    SELECT COALESCE(SUM(bot_recording_minutes), 0)::INTEGER
     INTO user_used
-    FROM usage_tracking 
+    FROM sessions
     WHERE user_id = p_user_id 
       AND organization_id = p_organization_id
-      AND DATE_TRUNC('month', created_at) = DATE_TRUNC('month', now());
+      AND created_at >= billing_start
+      AND created_at < billing_end
+      AND bot_recording_minutes > 0;
   END IF;
   
   -- Return results
@@ -1232,99 +1215,65 @@
 ALTER FUNCTION public.check_usage_limit_v2(p_user_id uuid, p_organization_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 450 (class 1255 OID 22095)
--- Name: check_webhook_health(integer); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 552 (class 1255 OID 38970)
+-- Name: cleanup_old_usage_data(integer); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.check_webhook_health(hours_back integer DEFAULT 24) RETURNS TABLE(webhook_type text, total_count bigint, processed_count bigint, failed_count bigint, avg_processing_time_ms numeric, last_received timestamp with time zone, last_processed timestamp with time zone, oldest_unprocessed timestamp with time zone, health_status text)
-    LANGUAGE plpgsql
+CREATE FUNCTION public.cleanup_old_usage_data(months_to_keep integer DEFAULT 12) RETURNS void
+    LANGUAGE plpgsql SECURITY DEFINER
     AS $$
 BEGIN
-  RETURN QUERY
-  WITH webhook_stats AS (
-    SELECT 
-      wl.webhook_type,
-      COUNT(*) as total_count,
-      COUNT(CASE WHEN wl.processed = true THEN 1 END) as processed_count,
-      COUNT(CASE WHEN wl.processed = false THEN 1 END) as failed_count,
-      AVG(CASE WHEN wl.processed = true THEN wl.processing_time_ms END) as avg_processing_time_ms,
-      MAX(wl.created_at) as last_received,
-      MAX(CASE WHEN wl.processed = true THEN wl.created_at END) as last_processed,
-      MIN(CASE WHEN wl.processed = false THEN wl.created_at END) as oldest_unprocessed
-    FROM webhook_logs wl
-    WHERE wl.created_at >= NOW() - INTERVAL '1 hour' * hours_back
-    GROUP BY wl.webhook_type
-  )
-  SELECT 
-    ws.webhook_type,
-    ws.total_count,
-    ws.processed_count,
-    ws.failed_count,
-    ROUND(ws.avg_processing_time_ms, 2),
-    ws.last_received,
-    ws.last_processed,
-    ws.oldest_unprocessed,
-    CASE 
-      WHEN ws.failed_count > ws.processed_count THEN 'critical'
-      WHEN ws.failed_count > 0 THEN 'warning'
-      WHEN ws.avg_processing_time_ms > 5000 THEN 'slow'
-      ELSE 'healthy'
-    END as health_status
-  FROM webhook_stats ws
-  ORDER BY ws.webhook_type;
+    -- Delete usage cache entries older than specified months
+    DELETE FROM monthly_usage_cache
+    WHERE last_updated < NOW() - (months_to_keep || ' months')::interval;
+    
+    -- Delete old usage tracking records
+    DELETE FROM usage_tracking
+    WHERE tracked_at < NOW() - (months_to_keep || ' months')::interval;
 END;
 $$;
 
 
-ALTER FUNCTION public.check_webhook_health(hours_back integer) OWNER TO postgres;
+ALTER FUNCTION public.cleanup_old_usage_data(months_to_keep integer) OWNER TO postgres;
 
 --
--- TOC entry 464 (class 1255 OID 32359)
+-- TOC entry 532 (class 1255 OID 76193)
 -- Name: complete_referral(uuid, text); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
 CREATE FUNCTION public.complete_referral(p_referee_id uuid, p_payment_intent_id text) RETURNS boolean
-    LANGUAGE plpgsql SECURITY DEFINER
+    LANGUAGE plpgsql
     AS $$
 DECLARE
     v_referral_id UUID;
+    v_referrer_id UUID;
+    v_reward_amount DECIMAL;
 BEGIN
-    -- Find the pending referral for this referee
-    SELECT id INTO v_referral_id
-    FROM public.user_referrals
+    -- Find the referral
+    SELECT id, referrer_id, reward_amount 
+    INTO v_referral_id, v_referrer_id, v_reward_amount
+    FROM user_referrals
     WHERE referee_id = p_referee_id
     AND status = 'pending'
-    ORDER BY created_at DESC
-    LIMIT 1;
+    FOR UPDATE;
     
     IF v_referral_id IS NULL THEN
         RETURN FALSE;
     END IF;
     
-    -- Update the referral status
-    UPDATE public.user_referrals
+    -- Update referral status
+    UPDATE user_referrals
     SET 
         status = 'completed',
-        completed_at = now(),
+        completed_at = NOW(),
         stripe_payment_intent_id = p_payment_intent_id
     WHERE id = v_referral_id;
     
-    -- Log the event if audit logs table exists
-    IF EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'referral_audit_logs') THEN
-        INSERT INTO public.referral_audit_logs (
-            event_type,
-            referee_id,
-            referral_id,
-            event_data
-        ) VALUES (
-            'payment_completed',
-            p_referee_id,
-            v_referral_id,
-            jsonb_build_object('payment_intent_id', p_payment_intent_id)
-        );
-    END IF;
-    
     RETURN TRUE;
+EXCEPTION
+    WHEN OTHERS THEN
+        RAISE NOTICE 'Error in complete_referral: %', SQLERRM;
+        RETURN FALSE;
 END;
 $$;
 
@@ -1332,79 +1281,89 @@
 ALTER FUNCTION public.complete_referral(p_referee_id uuid, p_payment_intent_id text) OWNER TO postgres;
 
 --
--- TOC entry 5598 (class 0 OID 0)
--- Dependencies: 464
--- Name: FUNCTION complete_referral(p_referee_id uuid, p_payment_intent_id text); Type: COMMENT; Schema: public; Owner: postgres
+-- TOC entry 596 (class 1255 OID 73869)
+-- Name: create_default_user_preferences(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-COMMENT ON FUNCTION public.complete_referral(p_referee_id uuid, p_payment_intent_id text) IS 'Marks a referral as completed when the referee makes their first payment';
-
-
---
--- TOC entry 449 (class 1255 OID 22094)
--- Name: create_meeting_notification(uuid, uuid, uuid, text, text, text, text); Type: FUNCTION; Schema: public; Owner: postgres
---
-
-CREATE FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text DEFAULT NULL::text) RETURNS uuid
-    LANGUAGE plpgsql
+CREATE FUNCTION public.create_default_user_preferences() RETURNS trigger
+    LANGUAGE plpgsql SECURITY DEFINER
     AS $$
-DECLARE
-  v_notification_id UUID;
 BEGIN
-  -- For now, just log to auto_join_logs as a notification
-  -- In the future, this could create actual user notifications
-  INSERT INTO calendar_auto_join_logs (
-    user_id,
-    calendar_event_id,
-    session_id,
-    bot_id,
-    action,
-    status,
-    metadata,
-    created_at
-  ) VALUES (
-    p_user_id,
-    p_event_id,
-    p_session_id,
-    NULL,
-    'notification',
-    p_type,
-    jsonb_build_object(
-      'title', p_title,
-      'message', p_message,
-      'action_url', p_action_url
-    ),
-    NOW()
-  ) RETURNING id INTO v_notification_id;
-  
-  RETURN v_notification_id;
+    -- Wait a moment to ensure user record exists
+    PERFORM pg_sleep(0.1);
+    
+    INSERT INTO public.user_preferences (
+        user_id,
+        email_notifications,
+        webhook_enabled,
+        personal_context
+    )
+    VALUES (
+        NEW.id,
+        true,
+        false,
+        ''
+    )
+    ON CONFLICT (user_id) DO NOTHING;
+    
+    RETURN NEW;
+EXCEPTION
+    WHEN others THEN
+        RAISE LOG 'Error creating user preferences: %', SQLERRM;
+        RETURN NEW;
 END;
 $$;
 
 
-ALTER FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) OWNER TO postgres;
+ALTER FUNCTION public.create_default_user_preferences() OWNER TO postgres;
 
 --
--- TOC entry 462 (class 1255 OID 32289)
--- Name: create_user_preferences_for_new_user(); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 5723 (class 0 OID 0)
+-- Dependencies: 596
+-- Name: FUNCTION create_default_user_preferences(); Type: COMMENT; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.create_user_preferences_for_new_user() RETURNS trigger
-    LANGUAGE plpgsql
+COMMENT ON FUNCTION public.create_default_user_preferences() IS 'Creates default user preferences when a new auth user is created. Handles errors gracefully.';
+
+
+--
+-- TOC entry 508 (class 1255 OID 64453)
+-- Name: create_meeting_notification(uuid, uuid, uuid, text, text, text, text); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text DEFAULT NULL::text) RETURNS uuid
+    LANGUAGE plpgsql SECURITY DEFINER
     AS $$
+DECLARE
+    v_notification_id UUID;
 BEGIN
-    INSERT INTO public.user_preferences (user_id)
-    VALUES (NEW.id)
-    ON CONFLICT (user_id) DO NOTHING;
-    RETURN NEW;
+    INSERT INTO meeting_notifications (
+        user_id,
+        calendar_event_id,
+        session_id,
+        notification_type,
+        title,
+        message,
+        action_url
+    ) VALUES (
+        p_user_id,
+        p_event_id,
+        p_session_id,
+        p_type,
+        p_title,
+        p_message,
+        p_action_url
+    ) RETURNING id INTO v_notification_id;
+    
+    RETURN v_notification_id;
 END;
 $$;
 
 
-ALTER FUNCTION public.create_user_preferences_for_new_user() OWNER TO postgres;
+ALTER FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) OWNER TO postgres;
 
 --
--- TOC entry 465 (class 1255 OID 32360)
+-- TOC entry 455 (class 1255 OID 76174)
 -- Name: generate_referral_code(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1412,22 +1371,28 @@
     LANGUAGE plpgsql
     AS $$
 DECLARE
-    v_code TEXT;
-    v_exists BOOLEAN;
+    chars TEXT := 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
+    result TEXT := '';
+    i INTEGER;
+    max_attempts INTEGER := 10;
+    attempt INTEGER := 0;
 BEGIN
-    LOOP
-        -- Generate a random 6-character alphanumeric code
-        v_code := UPPER(SUBSTRING(MD5(RANDOM()::TEXT), 1, 6));
+    WHILE attempt < max_attempts LOOP
+        result := '';
+        FOR i IN 1..6 LOOP
+            result := result || substr(chars, floor(random() * length(chars) + 1)::int, 1);
+        END LOOP;
         
         -- Check if code already exists
-        SELECT EXISTS(
-            SELECT 1 FROM public.users WHERE referral_code = v_code
-        ) INTO v_exists;
+        IF NOT EXISTS (SELECT 1 FROM users WHERE referral_code = result) THEN
+            RETURN result;
+        END IF;
         
-        EXIT WHEN NOT v_exists;
+        attempt := attempt + 1;
     END LOOP;
     
-    RETURN v_code;
+    -- If we couldn't generate a unique code, append timestamp
+    RETURN result || to_char(now(), 'SSSS');
 END;
 $$;
 
@@ -1435,16 +1400,7 @@
 ALTER FUNCTION public.generate_referral_code() OWNER TO postgres;
 
 --
--- TOC entry 5605 (class 0 OID 0)
--- Dependencies: 465
--- Name: FUNCTION generate_referral_code(); Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON FUNCTION public.generate_referral_code() IS 'Generates a unique 6-character alphanumeric referral code';
-
-
---
--- TOC entry 466 (class 1255 OID 32361)
+-- TOC entry 487 (class 1255 OID 76176)
 -- Name: generate_user_referral_code(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1453,7 +1409,7 @@
     AS $$
 BEGIN
     IF NEW.referral_code IS NULL THEN
-        NEW.referral_code = generate_referral_code();
+        NEW.referral_code := generate_referral_code();
     END IF;
     RETURN NEW;
 END;
@@ -1463,16 +1419,7 @@
 ALTER FUNCTION public.generate_user_referral_code() OWNER TO postgres;
 
 --
--- TOC entry 5607 (class 0 OID 0)
--- Dependencies: 466
--- Name: FUNCTION generate_user_referral_code(); Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON FUNCTION public.generate_user_referral_code() IS 'Trigger function to automatically generate referral codes for new users';
-
-
---
--- TOC entry 438 (class 1255 OID 17524)
+-- TOC entry 648 (class 1255 OID 28898)
 -- Name: get_next_transcript_sequence(uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1495,7 +1442,60 @@
 ALTER FUNCTION public.get_next_transcript_sequence(session_uuid uuid) OWNER TO postgres;
 
 --
--- TOC entry 458 (class 1255 OID 26664)
+-- TOC entry 629 (class 1255 OID 76276)
+-- Name: get_session_participants(uuid); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.get_session_participants(p_session_id uuid) RETURNS jsonb
+    LANGUAGE plpgsql SECURITY DEFINER
+    AS $$
+DECLARE
+  v_participants JSONB;
+BEGIN
+  -- First try to get from sessions table
+  SELECT participants INTO v_participants
+  FROM sessions
+  WHERE id = p_session_id;
+  
+  -- If empty, try to get from linked calendar event
+  IF v_participants IS NULL OR v_participants = '[]'::jsonb THEN
+    SELECT ce.attendees INTO v_participants
+    FROM calendar_events ce
+    WHERE ce.session_id = p_session_id
+    LIMIT 1;
+  END IF;
+  
+  -- Return empty array if still null
+  RETURN COALESCE(v_participants, '[]'::jsonb);
+END;
+$$;
+
+
+ALTER FUNCTION public.get_session_participants(p_session_id uuid) OWNER TO postgres;
+
+--
+-- TOC entry 402 (class 1255 OID 67001)
+-- Name: get_unread_mentions_count(uuid); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.get_unread_mentions_count(p_user_id uuid) RETURNS integer
+    LANGUAGE plpgsql SECURITY DEFINER
+    AS $$
+BEGIN
+  RETURN (
+    SELECT COUNT(*)
+    FROM comment_mentions
+    WHERE mentioned_user_id = p_user_id
+    AND is_read = FALSE
+  );
+END;
+$$;
+
+
+ALTER FUNCTION public.get_unread_mentions_count(p_user_id uuid) OWNER TO postgres;
+
+--
+-- TOC entry 512 (class 1255 OID 74991)
 -- Name: get_upcoming_meetings(uuid, integer); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1531,7 +1531,7 @@
 ALTER FUNCTION public.get_upcoming_meetings(p_user_id uuid, p_days_ahead integer) OWNER TO postgres;
 
 --
--- TOC entry 439 (class 1255 OID 17525)
+-- TOC entry 473 (class 1255 OID 30260)
 -- Name: get_usage_details(uuid, uuid, date, date); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1558,42 +1558,64 @@
 ALTER FUNCTION public.get_usage_details(p_user_id uuid, p_organization_id uuid, p_start_date date, p_end_date date) OWNER TO postgres;
 
 --
--- TOC entry 445 (class 1255 OID 18712)
+-- TOC entry 566 (class 1255 OID 38971)
 -- Name: get_user_billing_period(uuid, uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.get_user_billing_period(p_user_id uuid, p_organization_id uuid) RETURNS TABLE(billing_period_start timestamp with time zone, billing_period_end timestamp with time zone, subscription_status text, plan_name text)
+CREATE FUNCTION public.get_user_billing_period(p_user_id uuid, p_organization_id uuid) RETURNS TABLE(period_start timestamp with time zone, period_end timestamp with time zone, period_key text)
     LANGUAGE plpgsql SECURITY DEFINER
     AS $$
+DECLARE
+    v_subscription_start timestamp with time zone;
+    v_subscription_end timestamp with time zone;
+    v_has_subscription boolean := false;
 BEGIN
-    RETURN QUERY
+    -- First check if user has an active subscription
     SELECT 
-        CASE 
-            WHEN o.subscription_period = 'monthly' THEN 
-                date_trunc('month', CURRENT_TIMESTAMP AT TIME ZONE 'UTC')
-            ELSE 
-                date_trunc('year', CURRENT_TIMESTAMP AT TIME ZONE 'UTC')
-        END as billing_period_start,
-        CASE 
-            WHEN o.subscription_period = 'monthly' THEN 
-                date_trunc('month', CURRENT_TIMESTAMP AT TIME ZONE 'UTC') + INTERVAL '1 month' - INTERVAL '1 second'
-            ELSE 
-                date_trunc('year', CURRENT_TIMESTAMP AT TIME ZONE 'UTC') + INTERVAL '1 year' - INTERVAL '1 second'
-        END as billing_period_end,
-        COALESCE(o.subscription_status, 'active') as subscription_status,
-        COALESCE(o.plan_name, 'free') as plan_name
-    FROM organizations o
-    WHERE o.id = p_organization_id;
-    
-    -- If no organization found, return default values
-    IF NOT FOUND THEN
-        RETURN QUERY
+        s.current_period_start,
+        s.current_period_end,
+        true
+    INTO 
+        v_subscription_start,
+        v_subscription_end,
+        v_has_subscription
+    FROM subscriptions s
+    WHERE s.user_id = p_user_id
+    AND s.status = 'active'
+    ORDER BY s.created_at DESC
+    LIMIT 1;
+    
+    -- If no personal subscription, check organization subscription
+    IF NOT v_has_subscription AND p_organization_id IS NOT NULL THEN
         SELECT 
-            date_trunc('month', CURRENT_TIMESTAMP AT TIME ZONE 'UTC') as billing_period_start,
-            date_trunc('month', CURRENT_TIMESTAMP AT TIME ZONE 'UTC') + INTERVAL '1 month' - INTERVAL '1 second' as billing_period_end,
-            'active'::TEXT as subscription_status,
-            'free'::TEXT as plan_name;
+            s.current_period_start,
+            s.current_period_end,
+            true
+        INTO 
+            v_subscription_start,
+            v_subscription_end,
+            v_has_subscription
+        FROM organizations o
+        JOIN subscriptions s ON s.user_id = o.owner_id
+        WHERE o.id = p_organization_id
+        AND s.status = 'active'
+        ORDER BY s.created_at DESC
+        LIMIT 1;
     END IF;
+    
+    -- If user has a subscription, use subscription period
+    IF v_has_subscription THEN
+        RETURN QUERY SELECT 
+            v_subscription_start as period_start,
+            v_subscription_end as period_end,
+            TO_CHAR(v_subscription_start, 'YYYY-MM')::text as period_key;  -- Changed to YYYY-MM
+    ELSE
+        -- For free users, use calendar month
+        RETURN QUERY SELECT 
+            date_trunc('month', CURRENT_DATE)::timestamp with time zone as period_start,
+            (date_trunc('month', CURRENT_DATE) + interval '1 month')::timestamp with time zone as period_end,
+            TO_CHAR(CURRENT_DATE, 'YYYY-MM')::text as period_key;
+    END IF;
 END;
 $$;
 
@@ -1601,60 +1623,49 @@
 ALTER FUNCTION public.get_user_billing_period(p_user_id uuid, p_organization_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 469 (class 1255 OID 32366)
+-- TOC entry 595 (class 1255 OID 73867)
 -- Name: handle_new_user(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
 CREATE FUNCTION public.handle_new_user() RETURNS trigger
     LANGUAGE plpgsql SECURITY DEFINER
     AS $$
-DECLARE
-    v_pending_referral RECORD;
 BEGIN
-    -- Generate referral code if not provided
-    IF NEW.referral_code IS NULL THEN
-        NEW.referral_code = generate_referral_code();
-    END IF;
+    -- Insert user record
+    INSERT INTO public.users (
+        id,
+        email,
+        full_name,
+        referral_code,
+        has_completed_onboarding,
+        has_completed_organization_setup,
+        is_active,
+        created_at,
+        updated_at
+    )
+    VALUES (
+        NEW.id,
+        NEW.email,
+        COALESCE(NEW.raw_user_meta_data->>'full_name', split_part(NEW.email, '@', 1)),
+        generate_referral_code(),
+        false,
+        false,
+        true,
+        NOW(),
+        NOW()
+    )
+    ON CONFLICT (id) DO UPDATE
+    SET 
+        email = EXCLUDED.email,
+        full_name = COALESCE(EXCLUDED.full_name, public.users.full_name),
+        updated_at = NOW();
     
-    -- Check for pending referrals for this email
-    SELECT * INTO v_pending_referral
-    FROM public.user_referrals
-    WHERE LOWER(referee_email) = LOWER(NEW.email)
-    AND status = 'pending'
-    ORDER BY created_at DESC
-    LIMIT 1;
-    
-    -- If a pending referral exists, update it with the new user ID
-    IF v_pending_referral.id IS NOT NULL THEN
-        UPDATE public.user_referrals
-        SET 
-            referee_id = NEW.id,
-            metadata = COALESCE(metadata, '{}'::jsonb) || 
-                      jsonb_build_object('signup_completed_at', now())
-        WHERE id = v_pending_referral.id;
-        
-        -- Log the signup completion
-        PERFORM log_referral_event(
-            'signup_completed'::referral_event_type,
-            NEW.id,
-            v_pending_referral.referrer_id,
-            NEW.id,
-            v_pending_referral.id,
-            NULL,
-            NULL,
-            NULL,
-            NULL,
-            jsonb_build_object(
-                'email', NEW.email,
-                'referral_id', v_pending_referral.id
-            )
-        );
-        
-        -- Update the new user's referred_by_user_id field (correct column name)
-        NEW.referred_by_user_id = v_pending_referral.referrer_id;
-    END IF;
-    
     RETURN NEW;
+EXCEPTION
+    WHEN others THEN
+        -- Log the error but don't fail the auth flow
+        RAISE LOG 'Error in handle_new_user trigger: %', SQLERRM;
+        RETURN NEW;
 END;
 $$;
 
@@ -1662,88 +1673,16 @@
 ALTER FUNCTION public.handle_new_user() OWNER TO postgres;
 
 --
--- TOC entry 5631 (class 0 OID 0)
--- Dependencies: 469
+-- TOC entry 5752 (class 0 OID 0)
+-- Dependencies: 595
 -- Name: FUNCTION handle_new_user(); Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON FUNCTION public.handle_new_user() IS 'Handles new user setup including default values, referral code generation, and processing pending referrals';
+COMMENT ON FUNCTION public.handle_new_user() IS 'Creates a corresponding user record in public.users when a new auth user is created. Handles duplicate emails gracefully.';
 
 
 --
--- TOC entry 460 (class 1255 OID 26979)
--- Name: handle_new_user_referral(); Type: FUNCTION; Schema: public; Owner: postgres
---
-
-CREATE FUNCTION public.handle_new_user_referral() RETURNS trigger
-    LANGUAGE plpgsql SECURITY DEFINER
-    AS $$
-DECLARE
-    v_referral_code VARCHAR(10);
-    v_referrer_id UUID;
-    v_device_id TEXT;
-    v_ip_address INET;
-BEGIN
-    -- Generate referral code for new user if not already set
-    IF NEW.referral_code IS NULL THEN
-        NEW.referral_code := public.generate_referral_code(NEW.id);
-    END IF;
-    
-    -- Check if user was referred (from auth.users metadata)
-    IF auth.uid() IS NOT NULL THEN
-        -- Get referral code from user metadata
-        SELECT 
-            (current_setting('request.jwt.claims', true)::json->>'raw_user_meta_data')::json->>'referral_code'
-        INTO v_referral_code;
-        
-        -- Get device info from metadata if available
-        SELECT 
-            (current_setting('request.jwt.claims', true)::json->>'raw_user_meta_data')::json->>'device_id'
-        INTO v_device_id;
-        
-        -- Get IP address from current connection
-        v_ip_address := inet_client_addr();
-        
-        IF v_referral_code IS NOT NULL AND v_referral_code != '' THEN
-            -- Look up referrer
-            SELECT id INTO v_referrer_id
-            FROM public.users
-            WHERE referral_code = UPPER(v_referral_code)
-            AND id != NEW.id; -- Prevent self-referral
-            
-            IF v_referrer_id IS NOT NULL THEN
-                -- Update new user with referrer
-                NEW.referred_by_user_id := v_referrer_id;
-                
-                -- Create referral record
-                INSERT INTO public.user_referrals (
-                    referrer_user_id,
-                    referee_user_id,
-                    referral_code,
-                    status,
-                    device_id,
-                    ip_address
-                ) VALUES (
-                    v_referrer_id,
-                    NEW.id,
-                    UPPER(v_referral_code),
-                    'pending',
-                    v_device_id,
-                    v_ip_address
-                );
-            END IF;
-        END IF;
-    END IF;
-    
-    RETURN NEW;
-END;
-$$;
-
-
-ALTER FUNCTION public.handle_new_user_referral() OWNER TO postgres;
-
---
--- TOC entry 456 (class 1255 OID 24385)
+-- TOC entry 588 (class 1255 OID 38972)
 -- Name: handle_subscription_renewal(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1787,14 +1726,31 @@
 ALTER FUNCTION public.handle_subscription_renewal() OWNER TO postgres;
 
 --
--- TOC entry 588 (class 1255 OID 35430)
--- Name: hybrid_search_sessions(public.vector, text, double precision, integer, uuid); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 567 (class 1255 OID 72680)
+-- Name: handle_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.hybrid_search_sessions(query_embedding public.vector, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) RETURNS TABLE(id uuid, title text, participant_me text, participant_them text, created_at timestamp with time zone, similarity double precision, keyword_match boolean, combined_score double precision, summary_title text, tldr text, key_decisions jsonb, action_items jsonb)
+CREATE FUNCTION public.handle_updated_at() RETURNS trigger
     LANGUAGE plpgsql
     AS $$
 BEGIN
+    NEW.updated_at = NOW();
+    RETURN NEW;
+END;
+$$;
+
+
+ALTER FUNCTION public.handle_updated_at() OWNER TO postgres;
+
+--
+-- TOC entry 642 (class 1255 OID 81271)
+-- Name: hybrid_search_sessions(public.halfvec, text, double precision, integer, uuid); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.hybrid_search_sessions(query_embedding public.halfvec, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) RETURNS TABLE(id uuid, title text, participant_me text, participant_them text, created_at timestamp with time zone, similarity double precision, keyword_match boolean, combined_score double precision, summary_title text, tldr text, key_decisions jsonb, action_items jsonb)
+    LANGUAGE plpgsql
+    AS $$
+BEGIN
   RETURN QUERY
   WITH vector_matches AS (
     SELECT 
@@ -1868,10 +1824,10 @@
 $$;
 
 
-ALTER FUNCTION public.hybrid_search_sessions(query_embedding public.vector, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) OWNER TO postgres;
+ALTER FUNCTION public.hybrid_search_sessions(query_embedding public.halfvec, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 440 (class 1255 OID 17526)
+-- TOC entry 663 (class 1255 OID 17705)
 -- Name: is_active_org_member(uuid, uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1890,7 +1846,7 @@
 ALTER FUNCTION public.is_active_org_member(p_user_id uuid, p_org_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 444 (class 1255 OID 18528)
+-- TOC entry 416 (class 1255 OID 60810)
 -- Name: is_admin(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -1907,39 +1863,53 @@
 ALTER FUNCTION public.is_admin() OWNER TO postgres;
 
 --
--- TOC entry 448 (class 1255 OID 22093)
+-- TOC entry 513 (class 1255 OID 76189)
+-- Name: is_valid_referral_code(text); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.is_valid_referral_code(code text) RETURNS boolean
+    LANGUAGE plpgsql IMMUTABLE
+    AS $_$
+BEGIN
+  RETURN code ~ '^[A-Z0-9]{6,10}$';
+END;
+$_$;
+
+
+ALTER FUNCTION public.is_valid_referral_code(code text) OWNER TO postgres;
+
+--
+-- TOC entry 507 (class 1255 OID 64452)
 -- Name: log_auto_join_activity(uuid, uuid, uuid, text, text, text, text, jsonb); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
 CREATE FUNCTION public.log_auto_join_activity(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_bot_id text, p_action text, p_status text, p_error_message text DEFAULT NULL::text, p_metadata jsonb DEFAULT NULL::jsonb) RETURNS uuid
-    LANGUAGE plpgsql
+    LANGUAGE plpgsql SECURITY DEFINER
     AS $$
 DECLARE
-  v_log_id UUID;
+    v_log_id UUID;
 BEGIN
-  INSERT INTO calendar_auto_join_logs (
-    user_id,
-    calendar_event_id,
-    session_id,
-    bot_id,
-    action,
-    status,
-    error_message,
-    metadata,
-    created_at
-  ) VALUES (
-    p_user_id,
-    p_event_id,
-    p_session_id,
-    p_bot_id,
-    p_action,
-    p_status,
-    p_error_message,
-    p_metadata,
-    NOW()
-  ) RETURNING id INTO v_log_id;
-  
-  RETURN v_log_id;
+    INSERT INTO calendar_auto_join_logs (
+        user_id,
+        calendar_event_id,
+        session_id,
+        bot_id,
+        action,
+        status,
+        error_message,
+        metadata
+    ) VALUES (
+        p_user_id,
+        p_event_id,
+        p_session_id,
+        p_bot_id,
+        p_action,
+        p_status,
+        p_error_message,
+        p_metadata
+    ) RETURNING id INTO v_log_id;
+    
+    RETURN v_log_id;
 END;
 $$;
 
@@ -1947,48 +1917,76 @@
 ALTER FUNCTION public.log_auto_join_activity(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_bot_id text, p_action text, p_status text, p_error_message text, p_metadata jsonb) OWNER TO postgres;
 
 --
--- TOC entry 467 (class 1255 OID 32363)
+-- TOC entry 475 (class 1255 OID 67002)
+-- Name: log_comment_activity(); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.log_comment_activity() RETURNS trigger
+    LANGUAGE plpgsql
+    AS $$
+BEGIN
+  -- Only log activity if we have either user_id or guest_id
+  IF NEW.user_id IS NOT NULL OR NEW.guest_id IS NOT NULL THEN
+    INSERT INTO report_activity (session_id, user_id, activity_type, details)
+    VALUES (
+      NEW.session_id,
+      NEW.user_id,  -- This can be NULL for guest comments
+      'commented',
+      jsonb_build_object(
+        'comment_id', NEW.id,
+        'parent_comment_id', NEW.parent_comment_id,
+        'section_id', NEW.section_id,
+        'is_guest', NEW.is_guest,
+        'guest_id', NEW.guest_id,
+        'guest_name', NEW.guest_name
+      )
+    );
+  END IF;
+  RETURN NEW;
+END;
+$$;
+
+
+ALTER FUNCTION public.log_comment_activity() OWNER TO postgres;
+
+--
+-- TOC entry 551 (class 1255 OID 76260)
 -- Name: log_referral_event(public.referral_event_type, uuid, uuid, uuid, uuid, character varying, inet, text, character varying, jsonb, text); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
 CREATE FUNCTION public.log_referral_event(p_event_type public.referral_event_type, p_user_id uuid DEFAULT NULL::uuid, p_referrer_id uuid DEFAULT NULL::uuid, p_referee_id uuid DEFAULT NULL::uuid, p_referral_id uuid DEFAULT NULL::uuid, p_referral_code character varying DEFAULT NULL::character varying, p_ip_address inet DEFAULT NULL::inet, p_user_agent text DEFAULT NULL::text, p_device_id character varying DEFAULT NULL::character varying, p_event_data jsonb DEFAULT '{}'::jsonb, p_error_message text DEFAULT NULL::text) RETURNS uuid
-    LANGUAGE plpgsql SECURITY DEFINER
+    LANGUAGE plpgsql
     AS $$
 DECLARE
-    v_log_id UUID;
+  v_log_id UUID;
 BEGIN
-    -- Only insert if the audit logs table exists
-    IF EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'referral_audit_logs') THEN
-        INSERT INTO public.referral_audit_logs (
-            event_type,
-            user_id,
-            referrer_id,
-            referee_id,
-            referral_id,
-            referral_code,
-            ip_address,
-            user_agent,
-            device_id,
-            event_data,
-            error_message
-        ) VALUES (
-            p_event_type,
-            p_user_id,
-            p_referrer_id,
-            p_referee_id,
-            p_referral_id,
-            p_referral_code,
-            p_ip_address,
-            p_user_agent,
-            p_device_id,
-            p_event_data,
-            p_error_message
-        ) RETURNING id INTO v_log_id;
-        
-        RETURN v_log_id;
-    END IF;
-    
-    RETURN NULL;
+  INSERT INTO referral_audit_logs (
+    event_type,
+    user_id,
+    referrer_id,
+    referee_id,
+    referral_id,
+    referral_code,
+    ip_address,
+    user_agent,
+    device_id,
+    event_data,
+    error_message
+  ) VALUES (
+    p_event_type,
+    p_user_id,
+    p_referrer_id,
+    p_referee_id,
+    p_referral_id,
+    p_referral_code,
+    p_ip_address,
+    p_user_agent,
+    p_device_id,
+    p_event_data,
+    p_error_message
+  ) RETURNING id INTO v_log_id;
+  
+  RETURN v_log_id;
 END;
 $$;
 
@@ -1996,20 +1994,68 @@
 ALTER FUNCTION public.log_referral_event(p_event_type public.referral_event_type, p_user_id uuid, p_referrer_id uuid, p_referee_id uuid, p_referral_id uuid, p_referral_code character varying, p_ip_address inet, p_user_agent text, p_device_id character varying, p_event_data jsonb, p_error_message text) OWNER TO postgres;
 
 --
--- TOC entry 5661 (class 0 OID 0)
--- Dependencies: 467
--- Name: FUNCTION log_referral_event(p_event_type public.referral_event_type, p_user_id uuid, p_referrer_id uuid, p_referee_id uuid, p_referral_id uuid, p_referral_code character varying, p_ip_address inet, p_user_agent text, p_device_id character varying, p_event_data jsonb, p_error_message text); Type: COMMENT; Schema: public; Owner: postgres
+-- TOC entry 461 (class 1255 OID 67004)
+-- Name: log_task_activity(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-COMMENT ON FUNCTION public.log_referral_event(p_event_type public.referral_event_type, p_user_id uuid, p_referrer_id uuid, p_referee_id uuid, p_referral_id uuid, p_referral_code character varying, p_ip_address inet, p_user_agent text, p_device_id character varying, p_event_data jsonb, p_error_message text) IS 'Logs referral system events to the audit table for tracking and analysis';
+CREATE FUNCTION public.log_task_activity() RETURNS trigger
+    LANGUAGE plpgsql
+    AS $$
+BEGIN
+  IF TG_OP = 'INSERT' THEN
+    INSERT INTO report_activity (session_id, user_id, activity_type, details)
+    VALUES (
+      NEW.session_id,
+      NEW.created_by,
+      'task_created',
+      jsonb_build_object(
+        'task_id', NEW.id,
+        'title', NEW.title,
+        'assigned_to', NEW.assigned_to
+      )
+    );
+  ELSIF TG_OP = 'UPDATE' THEN
+    -- Log task completion
+    IF OLD.status != 'completed' AND NEW.status = 'completed' THEN
+      INSERT INTO report_activity (session_id, user_id, activity_type, details)
+      VALUES (
+        NEW.session_id,
+        auth.uid(),
+        'task_completed',
+        jsonb_build_object(
+          'task_id', NEW.id,
+          'title', NEW.title
+        )
+      );
+    -- Log task assignment changes
+    ELSIF OLD.assigned_to IS DISTINCT FROM NEW.assigned_to THEN
+      INSERT INTO report_activity (session_id, user_id, activity_type, details)
+      VALUES (
+        NEW.session_id,
+        auth.uid(),
+        'task_assigned',
+        jsonb_build_object(
+          'task_id', NEW.id,
+          'title', NEW.title,
+          'assigned_to', NEW.assigned_to,
+          'previous_assignee', OLD.assigned_to
+        )
+      );
+    END IF;
+  END IF;
+  RETURN NEW;
+END;
+$$;
 
 
+ALTER FUNCTION public.log_task_activity() OWNER TO postgres;
+
 --
--- TOC entry 586 (class 1255 OID 35428)
--- Name: match_sessions_by_title(public.vector, double precision, integer, uuid); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 640 (class 1255 OID 81244)
+-- Name: match_sessions_by_title(public.halfvec, double precision, integer, uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.match_sessions_by_title(query_embedding public.vector, match_threshold double precision DEFAULT 0.5, match_count integer DEFAULT 10, target_user_id uuid DEFAULT NULL::uuid) RETURNS TABLE(id uuid, title text, participant_me text, participant_them text, created_at timestamp with time zone, similarity double precision)
+CREATE FUNCTION public.match_sessions_by_title(query_embedding public.halfvec, match_threshold double precision DEFAULT 0.5, match_count integer DEFAULT 10, target_user_id uuid DEFAULT NULL::uuid) RETURNS TABLE(id uuid, title text, participant_me text, participant_them text, created_at timestamp with time zone, similarity double precision)
     LANGUAGE plpgsql
     AS $$
 BEGIN
@@ -2032,14 +2078,14 @@
 $$;
 
 
-ALTER FUNCTION public.match_sessions_by_title(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) OWNER TO postgres;
+ALTER FUNCTION public.match_sessions_by_title(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 587 (class 1255 OID 35429)
--- Name: match_summaries_by_content(public.vector, double precision, integer, uuid); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 651 (class 1255 OID 81270)
+-- Name: match_summaries_by_content(public.halfvec, double precision, integer, uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.match_summaries_by_content(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) RETURNS TABLE(id uuid, session_id uuid, title text, tldr text, created_at timestamp with time zone, similarity double precision)
+CREATE FUNCTION public.match_summaries_by_content(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) RETURNS TABLE(id uuid, session_id uuid, title text, tldr text, created_at timestamp with time zone, similarity double precision)
     LANGUAGE plpgsql
     AS $$
 BEGIN
@@ -2062,161 +2108,175 @@
 $$;
 
 
-ALTER FUNCTION public.match_summaries_by_content(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) OWNER TO postgres;
+ALTER FUNCTION public.match_summaries_by_content(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 468 (class 1255 OID 32364)
--- Name: process_referral_code(character varying, character varying, inet, text, character varying); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 553 (class 1255 OID 76175)
+-- Name: process_referral_code(uuid, text, text, inet); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet DEFAULT NULL::inet, p_user_agent text DEFAULT NULL::text, p_device_id character varying DEFAULT NULL::character varying) RETURNS jsonb
-    LANGUAGE plpgsql SECURITY DEFINER
+CREATE FUNCTION public.process_referral_code(p_user_id uuid, p_referral_code text, p_device_id text DEFAULT NULL::text, p_ip_address inet DEFAULT NULL::inet) RETURNS boolean
+    LANGUAGE plpgsql
     AS $$
 DECLARE
     v_referrer_id UUID;
+    v_existing_referral UUID;
+    v_clean_code TEXT;
     v_referral_id UUID;
-    v_is_self_referral BOOLEAN;
-    v_result JSONB;
 BEGIN
-    -- Validate referral code
-    IF p_referral_code IS NULL OR LENGTH(TRIM(p_referral_code)) = 0 THEN
-        -- Log invalid code event
-        PERFORM log_referral_event(
-            'code_invalid'::referral_event_type,
-            NULL,
-            NULL,
-            NULL,
-            NULL,
-            p_referral_code,
-            p_ip_address,
-            p_user_agent,
-            p_device_id,
-            jsonb_build_object('reason', 'empty_code'),
-            'Referral code is empty'
-        );
-        
-        RETURN jsonb_build_object(
-            'success', false,
-            'error', 'Invalid referral code'
-        );
-    END IF;
+    -- Normalize and validate referral code
+    v_clean_code := UPPER(TRIM(p_referral_code));
     
-    -- Find the referrer
-    SELECT id INTO v_referrer_id
-    FROM public.users
-    WHERE UPPER(referral_code) = UPPER(TRIM(p_referral_code));
+    -- Log validation attempt
+    PERFORM log_referral_event(
+      'code_validated',
+      p_user_id,
+      NULL,
+      NULL,
+      NULL,
+      v_clean_code,
+      p_ip_address,
+      NULL,
+      p_device_id
+    );
     
-    IF v_referrer_id IS NULL THEN
-        -- Log invalid code event
+    IF NOT is_valid_referral_code(v_clean_code) THEN
         PERFORM log_referral_event(
-            'code_invalid'::referral_event_type,
-            NULL,
-            NULL,
-            NULL,
-            NULL,
-            p_referral_code,
-            p_ip_address,
-            p_user_agent,
-            p_device_id,
-            jsonb_build_object('reason', 'code_not_found'),
-            'Referral code not found'
-        );
-        
-        RETURN jsonb_build_object(
-            'success', false,
-            'error', 'Invalid referral code'
+          'code_invalid',
+          p_user_id,
+          NULL,
+          NULL,
+          NULL,
+          v_clean_code,
+          p_ip_address,
+          NULL,
+          p_device_id,
+          jsonb_build_object('reason', 'invalid_format')
         );
+        RETURN FALSE;
     END IF;
     
-    -- Check for self-referral
-    SELECT EXISTS(
-        SELECT 1 FROM public.users 
-        WHERE id = v_referrer_id 
-        AND LOWER(email) = LOWER(p_referee_email)
-    ) INTO v_is_self_referral;
+    -- Find referrer by code
+    SELECT id INTO v_referrer_id 
+    FROM users 
+    WHERE referral_code = v_clean_code 
+    AND id != p_user_id;
     
-    IF v_is_self_referral THEN
-        -- Log self-referral attempt
+    IF v_referrer_id IS NULL THEN
         PERFORM log_referral_event(
-            'self_referral_blocked'::referral_event_type,
-            v_referrer_id,
-            v_referrer_id,
-            NULL,
-            NULL,
-            p_referral_code,
-            p_ip_address,
-            p_user_agent,
-            p_device_id,
-            jsonb_build_object('referee_email', p_referee_email),
-            'Self-referral attempted'
+          'code_invalid',
+          p_user_id,
+          NULL,
+          NULL,
+          NULL,
+          v_clean_code,
+          p_ip_address,
+          NULL,
+          p_device_id,
+          jsonb_build_object('reason', 'code_not_found')
         );
-        
-        RETURN jsonb_build_object(
-            'success', false,
-            'error', 'Self-referrals are not allowed'
+        RETURN FALSE;
+    END IF;
+    
+    -- Check for self-referral
+    IF v_referrer_id = p_user_id THEN
+        PERFORM log_referral_event(
+          'self_referral_blocked',
+          p_user_id,
+          v_referrer_id,
+          p_user_id,
+          NULL,
+          v_clean_code,
+          p_ip_address,
+          NULL,
+          p_device_id
         );
+        RETURN FALSE;
     END IF;
     
-    -- Create the referral record
-    INSERT INTO public.user_referrals (
+    -- Check if user already has a referral
+    SELECT id INTO v_existing_referral
+    FROM user_referrals
+    WHERE referee_id = p_user_id;
+    
+    IF v_existing_referral IS NOT NULL THEN
+        PERFORM log_referral_event(
+          'signup_attempted',
+          p_user_id,
+          v_referrer_id,
+          p_user_id,
+          v_existing_referral,
+          v_clean_code,
+          p_ip_address,
+          NULL,
+          p_device_id,
+          jsonb_build_object('reason', 'already_referred')
+        );
+        RETURN FALSE;
+    END IF;
+    
+    -- Create referral record
+    INSERT INTO user_referrals (
         referrer_id,
         referee_id,
         referee_email,
-        status,
-        ip_address,
         device_id,
-        metadata
-    ) VALUES (
+        ip_address
+    )
+    SELECT 
         v_referrer_id,
-        NULL, -- Will be updated when referee signs up
-        p_referee_email,
-        'pending',
-        p_ip_address,
+        p_user_id,
+        u.email,
         p_device_id,
-        jsonb_build_object(
-            'user_agent', p_user_agent,
-            'created_via', 'process_referral_code_function'
-        )
-    ) RETURNING id INTO v_referral_id;
+        p_ip_address
+    FROM users u
+    WHERE u.id = p_user_id
+    RETURNING id INTO v_referral_id;
     
-    -- Log successful validation
+    -- Update user's referred_by
+    UPDATE users 
+    SET referred_by_user_id = v_referrer_id
+    WHERE id = p_user_id;
+    
+    -- Log successful signup
     PERFORM log_referral_event(
-        'code_validated'::referral_event_type,
-        NULL,
-        v_referrer_id,
-        NULL,
-        v_referral_id,
-        p_referral_code,
-        p_ip_address,
-        p_user_agent,
-        p_device_id,
-        jsonb_build_object('referee_email', p_referee_email)
+      'signup_completed',
+      p_user_id,
+      v_referrer_id,
+      p_user_id,
+      v_referral_id,
+      v_clean_code,
+      p_ip_address,
+      NULL,
+      p_device_id
     );
     
-    RETURN jsonb_build_object(
-        'success', true,
-        'referral_id', v_referral_id,
-        'referrer_id', v_referrer_id,
-        'discount_percentage', 10, -- Default discount
-        'reward_amount', 5.00 -- Default reward
-    );
+    RETURN TRUE;
+EXCEPTION
+    WHEN OTHERS THEN
+        -- Log error
+        PERFORM log_referral_event(
+          'error',
+          p_user_id,
+          v_referrer_id,
+          p_user_id,
+          NULL,
+          v_clean_code,
+          p_ip_address,
+          NULL,
+          p_device_id,
+          jsonb_build_object('error', SQLERRM),
+          SQLERRM
+        );
+        RETURN FALSE;
 END;
 $$;
 
 
-ALTER FUNCTION public.process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet, p_user_agent text, p_device_id character varying) OWNER TO postgres;
+ALTER FUNCTION public.process_referral_code(p_user_id uuid, p_referral_code text, p_device_id text, p_ip_address inet) OWNER TO postgres;
 
 --
--- TOC entry 5665 (class 0 OID 0)
--- Dependencies: 468
--- Name: FUNCTION process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet, p_user_agent text, p_device_id character varying); Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON FUNCTION public.process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet, p_user_agent text, p_device_id character varying) IS 'Validates and processes a referral code, creating a pending referral record';
-
-
---
--- TOC entry 584 (class 1255 OID 35420)
+-- TOC entry 650 (class 1255 OID 81262)
 -- Name: queue_session_embedding(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -2244,7 +2304,7 @@
 ALTER FUNCTION public.queue_session_embedding() OWNER TO postgres;
 
 --
--- TOC entry 585 (class 1255 OID 35421)
+-- TOC entry 641 (class 1255 OID 81264)
 -- Name: queue_summary_embedding(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -2300,7 +2360,7 @@
 ALTER FUNCTION public.queue_summary_embedding() OWNER TO postgres;
 
 --
--- TOC entry 441 (class 1255 OID 17527)
+-- TOC entry 662 (class 1255 OID 28940)
 -- Name: set_transcript_sequence_number(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -2322,51 +2382,65 @@
 ALTER FUNCTION public.set_transcript_sequence_number() OWNER TO postgres;
 
 --
--- TOC entry 447 (class 1255 OID 22092)
+-- TOC entry 509 (class 1255 OID 64451)
 -- Name: should_auto_join_meeting(uuid, uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
 CREATE FUNCTION public.should_auto_join_meeting(p_event_id uuid, p_user_id uuid) RETURNS boolean
-    LANGUAGE plpgsql
+    LANGUAGE plpgsql SECURITY DEFINER
     AS $$
 DECLARE
-  v_preferences RECORD;
-  v_event RECORD;
-  v_keyword TEXT;
+    v_preferences RECORD;
+    v_event RECORD;
+    v_excluded_keywords TEXT[];
+    v_actual_user_id UUID;
 BEGIN
-  -- Get user preferences
-  SELECT * INTO v_preferences
-  FROM calendar_preferences
-  WHERE user_id = p_user_id;
-  
-  -- If no preferences or auto-join disabled, return false
-  IF NOT FOUND OR NOT v_preferences.auto_join_enabled THEN
-    RETURN FALSE;
-  END IF;
-  
-  -- Get event details
-  SELECT * INTO v_event
-  FROM calendar_events
-  WHERE id = p_event_id;
-  
-  -- Check if event has a meeting URL
-  IF v_event.meeting_url IS NULL OR v_event.meeting_url = '' THEN
-    RETURN FALSE;
-  END IF;
-  
-  -- Check excluded keywords if any
-  IF v_preferences.excluded_keywords IS NOT NULL AND array_length(v_preferences.excluded_keywords, 1) > 0 THEN
-    -- Check if title contains any excluded keywords
-    FOREACH v_keyword IN ARRAY v_preferences.excluded_keywords
-    LOOP
-      IF lower(v_event.title) LIKE '%' || lower(v_keyword) || '%' THEN
+    -- Get the actual user_id from the calendar event through calendar_connection
+    SELECT cc.user_id INTO v_actual_user_id
+    FROM calendar_events ce
+    JOIN calendar_connections cc ON ce.calendar_connection_id = cc.id
+    WHERE ce.id = p_event_id;
+    
+    -- Get user preferences from calendar_preferences table
+    SELECT * INTO v_preferences
+    FROM calendar_preferences
+    WHERE user_id = COALESCE(p_user_id, v_actual_user_id);
+    
+    -- Check if preferences exist and auto-join is enabled
+    IF v_preferences IS NULL OR NOT COALESCE(v_preferences.auto_record_enabled, FALSE) THEN
         RETURN FALSE;
-      END IF;
-    END LOOP;
-  END IF;
-  
-  -- All checks passed
-  RETURN TRUE;
+    END IF;
+    
+    -- Get event details
+    SELECT * INTO v_event
+    FROM calendar_events
+    WHERE id = p_event_id;
+    
+    -- Check if already processed
+    IF v_event.auto_session_created THEN
+        RETURN FALSE;
+    END IF;
+    
+    -- Check if meeting URL exists
+    IF v_event.meeting_url IS NULL THEN
+        RETURN FALSE;
+    END IF;
+    
+    -- Check excluded keywords
+    v_excluded_keywords := v_preferences.excluded_keywords;
+    
+    IF v_excluded_keywords IS NOT NULL AND array_length(v_excluded_keywords, 1) > 0 THEN
+        -- Check if title contains any excluded keywords
+        IF EXISTS (
+            SELECT 1 
+            FROM unnest(v_excluded_keywords) AS keyword
+            WHERE LOWER(v_event.title) LIKE '%' || LOWER(keyword) || '%'
+        ) THEN
+            RETURN FALSE;
+        END IF;
+    END IF;
+    
+    RETURN TRUE;
 END;
 $$;
 
@@ -2374,31 +2448,30 @@
 ALTER FUNCTION public.should_auto_join_meeting(p_event_id uuid, p_user_id uuid) OWNER TO postgres;
 
 --
--- TOC entry 452 (class 1255 OID 23583)
--- Name: start_bot_grace_period(text); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 616 (class 1255 OID 76274)
+-- Name: sync_session_participants(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.start_bot_grace_period(p_bot_id text) RETURNS boolean
+CREATE FUNCTION public.sync_session_participants() RETURNS trigger
     LANGUAGE plpgsql
     AS $$
 BEGIN
-  UPDATE bot_usage_tracking
-  SET 
-    grace_period_started_at = NOW(),
-    grace_period_notified = TRUE
-  WHERE bot_id = p_bot_id
-    AND status = 'active'
-    AND grace_period_started_at IS NULL;
-    
-  RETURN FOUND;
+  -- Only sync if session_id is set and attendees exist
+  IF NEW.session_id IS NOT NULL AND NEW.attendees IS NOT NULL THEN
+    UPDATE sessions 
+    SET participants = NEW.attendees,
+        updated_at = NOW()
+    WHERE id = NEW.session_id;
+  END IF;
+  RETURN NEW;
 END;
 $$;
 
 
-ALTER FUNCTION public.start_bot_grace_period(p_bot_id text) OWNER TO postgres;
+ALTER FUNCTION public.sync_session_participants() OWNER TO postgres;
 
 --
--- TOC entry 455 (class 1255 OID 24384)
+-- TOC entry 474 (class 1255 OID 39033)
 -- Name: sync_subscription_limits(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -2436,24 +2509,259 @@
 ALTER FUNCTION public.sync_subscription_limits() OWNER TO postgres;
 
 --
--- TOC entry 461 (class 1255 OID 32264)
--- Name: update_email_notifications_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 471 (class 1255 OID 36638)
+-- Name: test_user_access(uuid); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.update_email_notifications_updated_at() RETURNS trigger
+CREATE FUNCTION public.test_user_access(test_user_id uuid) RETURNS TABLE(test_name text, result text)
+    LANGUAGE plpgsql SECURITY DEFINER
+    AS $$
+BEGIN
+    -- Set the auth context to the test user
+    PERFORM set_config('request.jwt.claims', json_build_object('sub', test_user_id::text)::text, true);
+    
+    -- Test 1: Can user see their own record
+    RETURN QUERY
+    SELECT 
+        'User can see own record'::text,
+        CASE 
+            WHEN EXISTS(SELECT 1 FROM users WHERE id = test_user_id) 
+            THEN 'SUCCESS: User found'
+            ELSE 'FAIL: User not found'
+        END;
+        
+    -- Test 2: Can user see their organization
+    RETURN QUERY
+    SELECT 
+        'User can see their organization'::text,
+        CASE 
+            WHEN EXISTS(
+                SELECT 1 FROM organizations o
+                JOIN organization_members om ON o.id = om.organization_id
+                WHERE om.user_id = test_user_id
+            ) 
+            THEN 'SUCCESS: Organization found'
+            ELSE 'FAIL: Organization not found'
+        END;
+END;
+$$;
+
+
+ALTER FUNCTION public.test_user_access(test_user_id uuid) OWNER TO postgres;
+
+--
+-- TOC entry 412 (class 1255 OID 36599)
+-- Name: test_users_rls(uuid); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.test_users_rls(test_user_id uuid) RETURNS TABLE(test_name text, can_access boolean, details text)
+    LANGUAGE plpgsql SECURITY DEFINER
+    AS $$
+BEGIN
+    -- Test 1: User can see their own record
+    RETURN QUERY
+    SELECT 
+        'User can see own record'::text,
+        EXISTS(
+            SELECT 1 FROM users 
+            WHERE id = test_user_id
+        ),
+        'Checking if user can access their own record'::text;
+        
+    -- Test 2: Check if user exists and is admin
+    RETURN QUERY
+    SELECT 
+        'User admin status'::text,
+        COALESCE((
+            SELECT is_admin 
+            FROM users 
+            WHERE id = test_user_id
+        ), false),
+        'Checking if user is admin'::text;
+END;
+$$;
+
+
+ALTER FUNCTION public.test_users_rls(test_user_id uuid) OWNER TO postgres;
+
+--
+-- TOC entry 447 (class 1255 OID 36600)
+-- Name: test_users_rls_policies(); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.test_users_rls_policies() RETURNS TABLE(test_scenario text, expected_result text, actual_result text, passed boolean)
+    LANGUAGE plpgsql SECURITY DEFINER
+    AS $$
+DECLARE
+    admin_user_id uuid := '47fa2a65-5444-40f4-8c3f-136e51e1c192'; -- bgolchha+1@gmail.com (admin)
+    regular_user_id uuid := '754a6166-1dbf-48b0-a858-01df9e74a839'; -- bgolchha+3@gmail.com (non-admin)
+    test_result boolean;
+BEGIN
+    -- Test 1: Regular user can see only their own record
+    RETURN QUERY
+    SELECT 
+        'Regular user accessing own record'::text,
+        'Should see 1 record'::text,
+        (SELECT COUNT(*)::text FROM users WHERE id = regular_user_id)::text,
+        (SELECT COUNT(*) FROM users WHERE id = regular_user_id) = 1;
+        
+    -- Test 2: Regular user cannot see other users
+    RETURN QUERY
+    SELECT 
+        'Regular user accessing other records'::text,
+        'Should see only own record'::text,
+        'Cannot test - requires auth context'::text,
+        true; -- We'll need to test this from the app
+        
+    -- Test 3: Admin can see all users
+    RETURN QUERY
+    SELECT 
+        'Admin user accessing all records'::text,
+        'Should see all records'::text,
+        'Cannot test - requires auth context'::text,
+        true; -- We'll need to test this from the app
+        
+    -- Test 4: User can update own record
+    RETURN QUERY
+    SELECT 
+        'User updating own record'::text,
+        'Update should succeed'::text,
+        'Cannot test - requires auth context'::text,
+        true; -- We'll need to test this from the app
+        
+    -- Test 5: Verify no DELETE policy exists
+    RETURN QUERY
+    SELECT 
+        'DELETE policy check'::text,
+        'No DELETE policy should exist'::text,
+        CASE 
+            WHEN EXISTS (
+                SELECT 1 FROM pg_policy 
+                WHERE polrelid = 'users'::regclass 
+                AND polcmd = 'd'
+            ) THEN 'DELETE policy exists'
+            ELSE 'No DELETE policy'
+        END,
+        NOT EXISTS (
+            SELECT 1 FROM pg_policy 
+            WHERE polrelid = 'users'::regclass 
+            AND polcmd = 'd'
+        );
+END;
+$$;
+
+
+ALTER FUNCTION public.test_users_rls_policies() OWNER TO postgres;
+
+--
+-- TOC entry 518 (class 1255 OID 38965)
+-- Name: track_minute_usage(uuid, uuid, uuid, integer); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.track_minute_usage(p_user_id uuid, p_organization_id uuid, p_session_id uuid, p_minutes_to_add integer) RETURNS void
+    LANGUAGE plpgsql SECURITY DEFINER
+    AS $$
+DECLARE
+    v_period_key varchar(20);
+    v_period_start timestamp with time zone;
+    v_period_end timestamp with time zone;
+BEGIN
+    -- Get the current billing period for the user
+    SELECT period_key, period_start, period_end
+    INTO v_period_key, v_period_start, v_period_end
+    FROM get_user_billing_period(p_user_id, p_organization_id);
+    
+    -- Insert or update monthly usage cache using the billing period
+    INSERT INTO monthly_usage_cache (
+        user_id,
+        organization_id,
+        month_year,
+        total_minutes_used,
+        total_seconds_used,
+        last_updated
+    )
+    VALUES (
+        p_user_id,
+        p_organization_id,
+        v_period_key,
+        p_minutes_to_add,
+        p_minutes_to_add * 60,
+        NOW()
+    )
+    ON CONFLICT (user_id, organization_id, month_year)
+    DO UPDATE SET
+        total_minutes_used = monthly_usage_cache.total_minutes_used + p_minutes_to_add,
+        total_seconds_used = monthly_usage_cache.total_seconds_used + (p_minutes_to_add * 60),
+        last_updated = NOW();
+    
+    -- Also update organization member's current month usage
+    UPDATE organization_members
+    SET 
+        current_month_minutes_used = COALESCE(current_month_minutes_used, 0) + p_minutes_to_add,
+        current_month_start = v_period_key,
+        updated_at = NOW()
+    WHERE user_id = p_user_id 
+    AND organization_id = p_organization_id;
+    
+    -- Log the usage record
+    INSERT INTO usage_tracking (
+        user_id,
+        organization_id,
+        session_id,
+        action_type,
+        minutes_tracked,
+        tracked_at
+    )
+    VALUES (
+        p_user_id,
+        p_organization_id,
+        p_session_id,
+        'minute_tracked',
+        p_minutes_to_add,
+        NOW()
+    );
+END;
+$$;
+
+
+ALTER FUNCTION public.track_minute_usage(p_user_id uuid, p_organization_id uuid, p_session_id uuid, p_minutes_to_add integer) OWNER TO postgres;
+
+--
+-- TOC entry 396 (class 1255 OID 53915)
+-- Name: update_bot_usage_tracking_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.update_bot_usage_tracking_updated_at() RETURNS trigger
     LANGUAGE plpgsql
     AS $$
 BEGIN
+    NEW.updated_at = now();
+    RETURN NEW;
+END;
+$$;
+
+
+ALTER FUNCTION public.update_bot_usage_tracking_updated_at() OWNER TO postgres;
+
+--
+-- TOC entry 398 (class 1255 OID 64372)
+-- Name: update_calendar_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.update_calendar_updated_at() RETURNS trigger
+    LANGUAGE plpgsql
+    AS $$
+BEGIN
     NEW.updated_at = CURRENT_TIMESTAMP;
     RETURN NEW;
 END;
 $$;
 
 
-ALTER FUNCTION public.update_email_notifications_updated_at() OWNER TO postgres;
+ALTER FUNCTION public.update_calendar_updated_at() OWNER TO postgres;
 
 --
--- TOC entry 442 (class 1255 OID 17528)
+-- TOC entry 446 (class 1255 OID 35391)
 -- Name: update_member_usage(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
@@ -2462,33 +2770,57 @@
     AS $$
 DECLARE
     current_month varchar(7);
+    old_minutes integer;
+    old_seconds integer;
+    new_seconds integer;
+    new_minutes integer;
+    minute_increment integer;
 BEGIN
     -- Get current month in YYYY-MM format
     current_month := TO_CHAR(NEW.minute_timestamp, 'YYYY-MM');
-    
-    -- Update organization_members current month usage
+
+    -- Fetch existing totals from monthly cache
+    SELECT total_minutes_used, total_seconds_used
+    INTO old_minutes, old_seconds
+    FROM monthly_usage_cache
+    WHERE organization_id = NEW.organization_id
+      AND user_id = NEW.user_id
+      AND month_year = current_month;
+
+    -- Initialize if no existing record
+    IF old_minutes IS NULL THEN
+        old_minutes := 0;
+        old_seconds := 0;
+    END IF;
+
+    -- Calculate new totals based on actual seconds recorded
+    new_seconds := old_seconds + NEW.seconds_recorded;
+    new_minutes := CEIL(new_seconds::numeric / 60.0);
+    minute_increment := new_minutes - old_minutes;
+
+    -- Update organization_members current month usage accurately
     UPDATE organization_members
-    SET 
-        current_month_minutes_used = CASE 
-            WHEN current_month_start IS NULL OR TO_CHAR(current_month_start, 'YYYY-MM') != current_month 
-            THEN 1  -- Reset if new month
-            ELSE current_month_minutes_used + 1
+    SET
+        current_month_minutes_used = CASE
+            WHEN current_month_start IS NULL OR TO_CHAR(current_month_start, 'YYYY-MM') != current_month
+            THEN new_minutes  -- Set to new total if new month
+            ELSE current_month_minutes_used + minute_increment  -- Add only the difference
         END,
-        current_month_start = CASE 
-            WHEN current_month_start IS NULL OR TO_CHAR(current_month_start, 'YYYY-MM') != current_month 
+        current_month_start = CASE
+            WHEN current_month_start IS NULL OR TO_CHAR(current_month_start, 'YYYY-MM') != current_month
             THEN DATE_TRUNC('month', NEW.minute_timestamp)::date
             ELSE current_month_start
         END,
-        total_audio_hours_used = total_audio_hours_used + (1.0 / 60.0), -- Add 1 minute as fraction of hour
+        total_audio_hours_used = total_audio_hours_used + (NEW.seconds_recorded::numeric / 3600.0),
         updated_at = CURRENT_TIMESTAMP
-    WHERE user_id = NEW.user_id 
+    WHERE user_id = NEW.user_id
     AND organization_id = NEW.organization_id;
-    
-    -- Update or insert monthly usage cache
+
+    -- Upsert monthly usage cache with accurate totals
     INSERT INTO monthly_usage_cache (
-        organization_id, 
-        user_id, 
-        month_year, 
+        organization_id,
+        user_id,
+        month_year,
         total_minutes_used,
         total_seconds_used,
         last_updated
@@ -2496,16 +2828,16 @@
         NEW.organization_id,
         NEW.user_id,
         current_month,
-        1,
-        NEW.seconds_recorded,
+        new_minutes,
+        new_seconds,
         CURRENT_TIMESTAMP
     )
-    ON CONFLICT (organization_id, user_id, month_year) 
-    DO UPDATE SET 
-        total_minutes_used = monthly_usage_cache.total_minutes_used + 1,
-        total_seconds_used = monthly_usage_cache.total_seconds_used + NEW.seconds_recorded,
+    ON CONFLICT (organization_id, user_id, month_year)
+    DO UPDATE SET
+        total_minutes_used = EXCLUDED.total_minutes_used,
+        total_seconds_used = EXCLUDED.total_seconds_used,
         last_updated = CURRENT_TIMESTAMP;
-    
+
     RETURN NEW;
 END;
 $$;
@@ -2514,41 +2846,115 @@
 ALTER FUNCTION public.update_member_usage() OWNER TO postgres;
 
 --
--- TOC entry 443 (class 1255 OID 17904)
--- Name: update_updated_at_column(); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 415 (class 1255 OID 60794)
+-- Name: update_monthly_usage_cache(); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.update_updated_at_column() RETURNS trigger
+CREATE FUNCTION public.update_monthly_usage_cache() RETURNS trigger
     LANGUAGE plpgsql
     AS $$
 BEGIN
-  NEW.updated_at = NOW();
-  RETURN NEW;
+    -- Update or insert into monthly_usage_cache
+    INSERT INTO monthly_usage_cache (
+        id,
+        organization_id,
+        user_id,
+        month_year,
+        total_minutes_used,
+        total_seconds_used,
+        last_updated
+    )
+    SELECT 
+        COALESCE(muc.id, gen_random_uuid()),
+        NEW.organization_id,
+        NEW.user_id,
+        TO_CHAR(NEW.created_at, 'YYYY-MM'),
+        SUM(but.billable_minutes),
+        SUM(but.total_recording_seconds),
+        NOW()
+    FROM bot_usage_tracking but
+    LEFT JOIN monthly_usage_cache muc ON 
+        muc.user_id = NEW.user_id 
+        AND muc.organization_id = NEW.organization_id
+        AND muc.month_year = TO_CHAR(NEW.created_at, 'YYYY-MM')
+    WHERE but.user_id = NEW.user_id 
+        AND but.organization_id = NEW.organization_id
+        AND TO_CHAR(but.created_at, 'YYYY-MM') = TO_CHAR(NEW.created_at, 'YYYY-MM')
+        AND but.status = 'completed'
+    GROUP BY muc.id, NEW.organization_id, NEW.user_id
+    ON CONFLICT DO NOTHING;
+    
+    -- If we have a conflict, update the existing record
+    UPDATE monthly_usage_cache
+    SET 
+        total_minutes_used = (
+            SELECT SUM(billable_minutes)
+            FROM bot_usage_tracking
+            WHERE user_id = NEW.user_id 
+                AND organization_id = NEW.organization_id
+                AND TO_CHAR(created_at, 'YYYY-MM') = TO_CHAR(NEW.created_at, 'YYYY-MM')
+                AND status = 'completed'
+        ),
+        total_seconds_used = (
+            SELECT SUM(total_recording_seconds)
+            FROM bot_usage_tracking
+            WHERE user_id = NEW.user_id 
+                AND organization_id = NEW.organization_id
+                AND TO_CHAR(created_at, 'YYYY-MM') = TO_CHAR(NEW.created_at, 'YYYY-MM')
+                AND status = 'completed'
+        ),
+        last_updated = NOW()
+    WHERE user_id = NEW.user_id 
+        AND organization_id = NEW.organization_id
+        AND month_year = TO_CHAR(NEW.created_at, 'YYYY-MM');
+    
+    RETURN NEW;
 END;
 $$;
 
 
-ALTER FUNCTION public.update_updated_at_column() OWNER TO postgres;
+ALTER FUNCTION public.update_monthly_usage_cache() OWNER TO postgres;
 
 --
--- TOC entry 463 (class 1255 OID 32291)
--- Name: update_user_preferences_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
+-- TOC entry 456 (class 1255 OID 51506)
+-- Name: update_session_stats(uuid, integer, numeric); Type: FUNCTION; Schema: public; Owner: postgres
 --
 
-CREATE FUNCTION public.update_user_preferences_updated_at() RETURNS trigger
+CREATE FUNCTION public.update_session_stats(p_session_id uuid, p_words_to_add integer DEFAULT 0, p_duration_to_add numeric DEFAULT 0) RETURNS void
     LANGUAGE plpgsql
     AS $$
 BEGIN
-    NEW.updated_at = CURRENT_TIMESTAMP;
-    RETURN NEW;
+    UPDATE sessions
+    SET 
+        total_words = COALESCE(total_words, 0) + p_words_to_add,
+        total_duration = COALESCE(total_duration, 0) + p_duration_to_add,
+        updated_at = NOW()
+    WHERE id = p_session_id;
 END;
 $$;
 
 
-ALTER FUNCTION public.update_user_preferences_updated_at() OWNER TO postgres;
+ALTER FUNCTION public.update_session_stats(p_session_id uuid, p_words_to_add integer, p_duration_to_add numeric) OWNER TO postgres;
 
 --
--- TOC entry 430 (class 1255 OID 17169)
+-- TOC entry 661 (class 1255 OID 17692)
+-- Name: update_updated_at_column(); Type: FUNCTION; Schema: public; Owner: postgres
+--
+
+CREATE FUNCTION public.update_updated_at_column() RETURNS trigger
+    LANGUAGE plpgsql
+    AS $$
+BEGIN
+  NEW.updated_at = NOW();
+  RETURN NEW;
+END;
+$$;
+
+
+ALTER FUNCTION public.update_updated_at_column() OWNER TO postgres;
+
+--
+-- TOC entry 656 (class 1255 OID 17139)
 -- Name: apply_rls(jsonb, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -2856,7 +3262,7 @@
 ALTER FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer) OWNER TO supabase_admin;
 
 --
--- TOC entry 436 (class 1255 OID 17250)
+-- TOC entry 654 (class 1255 OID 17217)
 -- Name: broadcast_changes(text, text, text, text, text, record, record, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -2888,7 +3294,7 @@
 ALTER FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text) OWNER TO supabase_admin;
 
 --
--- TOC entry 432 (class 1255 OID 17182)
+-- TOC entry 652 (class 1255 OID 17151)
 -- Name: build_prepared_statement_sql(text, regclass, realtime.wal_column[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -2924,7 +3330,7 @@
 ALTER FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]) OWNER TO supabase_admin;
 
 --
--- TOC entry 428 (class 1255 OID 17131)
+-- TOC entry 658 (class 1255 OID 17102)
 -- Name: cast(text, regtype); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -2943,7 +3349,7 @@
 ALTER FUNCTION realtime."cast"(val text, type_ regtype) OWNER TO supabase_admin;
 
 --
--- TOC entry 427 (class 1255 OID 17122)
+-- TOC entry 653 (class 1255 OID 17097)
 -- Name: check_equality_op(realtime.equality_op, regtype, text, text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -2985,7 +3391,7 @@
 ALTER FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text) OWNER TO supabase_admin;
 
 --
--- TOC entry 431 (class 1255 OID 17178)
+-- TOC entry 649 (class 1255 OID 17147)
 -- Name: is_visible_through_filters(realtime.wal_column[], realtime.user_defined_filter[]); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -3024,7 +3430,7 @@
 ALTER FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]) OWNER TO supabase_admin;
 
 --
--- TOC entry 433 (class 1255 OID 17190)
+-- TOC entry 655 (class 1255 OID 17158)
 -- Name: list_changes(name, name, integer, integer); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -3093,7 +3499,7 @@
 ALTER FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer) OWNER TO supabase_admin;
 
 --
--- TOC entry 426 (class 1255 OID 17121)
+-- TOC entry 643 (class 1255 OID 17095)
 -- Name: quote_wal2json(regclass); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -3134,7 +3540,7 @@
 ALTER FUNCTION realtime.quote_wal2json(entity regclass) OWNER TO supabase_admin;
 
 --
--- TOC entry 435 (class 1255 OID 17249)
+-- TOC entry 660 (class 1255 OID 17216)
 -- Name: send(jsonb, text, text, boolean); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -3170,7 +3576,7 @@
 ALTER FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean) OWNER TO supabase_admin;
 
 --
--- TOC entry 425 (class 1255 OID 17119)
+-- TOC entry 657 (class 1255 OID 17086)
 -- Name: subscription_check_filters(); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -3247,7 +3653,7 @@
 ALTER FUNCTION realtime.subscription_check_filters() OWNER TO supabase_admin;
 
 --
--- TOC entry 429 (class 1255 OID 17158)
+-- TOC entry 644 (class 1255 OID 17128)
 -- Name: to_regrole(text); Type: FUNCTION; Schema: realtime; Owner: supabase_admin
 --
 
@@ -3259,7 +3665,7 @@
 ALTER FUNCTION realtime.to_regrole(role_name text) OWNER TO supabase_admin;
 
 --
--- TOC entry 434 (class 1255 OID 17243)
+-- TOC entry 659 (class 1255 OID 17210)
 -- Name: topic(); Type: FUNCTION; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -3273,7 +3679,7 @@
 ALTER FUNCTION realtime.topic() OWNER TO supabase_realtime_admin;
 
 --
--- TOC entry 421 (class 1255 OID 17033)
+-- TOC entry 634 (class 1255 OID 17004)
 -- Name: can_insert_object(text, text, uuid, jsonb); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3293,7 +3699,7 @@
 ALTER FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb) OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 417 (class 1255 OID 17007)
+-- TOC entry 627 (class 1255 OID 16978)
 -- Name: extension(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3315,7 +3721,7 @@
 ALTER FUNCTION storage.extension(name text) OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 416 (class 1255 OID 17006)
+-- TOC entry 626 (class 1255 OID 16977)
 -- Name: filename(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3334,7 +3740,7 @@
 ALTER FUNCTION storage.filename(name text) OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 415 (class 1255 OID 17005)
+-- TOC entry 625 (class 1255 OID 16976)
 -- Name: foldername(text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3353,7 +3759,7 @@
 ALTER FUNCTION storage.foldername(name text) OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 418 (class 1255 OID 17019)
+-- TOC entry 630 (class 1255 OID 16990)
 -- Name: get_size_by_bucket(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3372,7 +3778,7 @@
 ALTER FUNCTION storage.get_size_by_bucket() OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 423 (class 1255 OID 17072)
+-- TOC entry 635 (class 1255 OID 17072)
 -- Name: list_multipart_uploads_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3421,7 +3827,7 @@
 ALTER FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, next_key_token text, next_upload_token text) OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 422 (class 1255 OID 17035)
+-- TOC entry 628 (class 1255 OID 17006)
 -- Name: list_objects_with_delimiter(text, text, text, integer, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3468,7 +3874,7 @@
 ALTER FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer, start_after text, next_token text) OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 424 (class 1255 OID 17088)
+-- TOC entry 646 (class 1255 OID 17096)
 -- Name: operation(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3484,7 +3890,7 @@
 ALTER FUNCTION storage.operation() OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 419 (class 1255 OID 17022)
+-- TOC entry 645 (class 1255 OID 16993)
 -- Name: search(text, text, integer, integer, integer, text, text, text); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3556,7 +3962,7 @@
 ALTER FUNCTION storage.search(prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text) OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 420 (class 1255 OID 17023)
+-- TOC entry 633 (class 1255 OID 16994)
 -- Name: update_updated_at_column(); Type: FUNCTION; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -3577,7 +3983,7 @@
 SET default_table_access_method = heap;
 
 --
--- TOC entry 238 (class 1259 OID 16523)
+-- TOC entry 301 (class 1259 OID 16512)
 -- Name: audit_log_entries; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3593,8 +3999,8 @@
 ALTER TABLE auth.audit_log_entries OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5727 (class 0 OID 0)
--- Dependencies: 238
+-- TOC entry 5855 (class 0 OID 0)
+-- Dependencies: 301
 -- Name: TABLE audit_log_entries; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3602,7 +4008,7 @@
 
 
 --
--- TOC entry 255 (class 1259 OID 16925)
+-- TOC entry 318 (class 1259 OID 16901)
 -- Name: flow_state; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3625,8 +4031,8 @@
 ALTER TABLE auth.flow_state OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5729 (class 0 OID 0)
--- Dependencies: 255
+-- TOC entry 5857 (class 0 OID 0)
+-- Dependencies: 318
 -- Name: TABLE flow_state; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3634,7 +4040,7 @@
 
 
 --
--- TOC entry 246 (class 1259 OID 16723)
+-- TOC entry 309 (class 1259 OID 16698)
 -- Name: identities; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3654,8 +4060,8 @@
 ALTER TABLE auth.identities OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5731 (class 0 OID 0)
--- Dependencies: 246
+-- TOC entry 5859 (class 0 OID 0)
+-- Dependencies: 309
 -- Name: TABLE identities; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3663,8 +4069,8 @@
 
 
 --
--- TOC entry 5732 (class 0 OID 0)
--- Dependencies: 246
+-- TOC entry 5860 (class 0 OID 0)
+-- Dependencies: 309
 -- Name: COLUMN identities.email; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3672,7 +4078,7 @@
 
 
 --
--- TOC entry 237 (class 1259 OID 16516)
+-- TOC entry 300 (class 1259 OID 16505)
 -- Name: instances; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3688,8 +4094,8 @@
 ALTER TABLE auth.instances OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5734 (class 0 OID 0)
--- Dependencies: 237
+-- TOC entry 5862 (class 0 OID 0)
+-- Dependencies: 300
 -- Name: TABLE instances; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3697,7 +4103,7 @@
 
 
 --
--- TOC entry 250 (class 1259 OID 16812)
+-- TOC entry 313 (class 1259 OID 16788)
 -- Name: mfa_amr_claims; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3713,8 +4119,8 @@
 ALTER TABLE auth.mfa_amr_claims OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5736 (class 0 OID 0)
--- Dependencies: 250
+-- TOC entry 5864 (class 0 OID 0)
+-- Dependencies: 313
 -- Name: TABLE mfa_amr_claims; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3722,7 +4128,7 @@
 
 
 --
--- TOC entry 249 (class 1259 OID 16800)
+-- TOC entry 312 (class 1259 OID 16776)
 -- Name: mfa_challenges; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3740,8 +4146,8 @@
 ALTER TABLE auth.mfa_challenges OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5738 (class 0 OID 0)
--- Dependencies: 249
+-- TOC entry 5866 (class 0 OID 0)
+-- Dependencies: 312
 -- Name: TABLE mfa_challenges; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3749,7 +4155,7 @@
 
 
 --
--- TOC entry 248 (class 1259 OID 16787)
+-- TOC entry 311 (class 1259 OID 16763)
 -- Name: mfa_factors; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3772,8 +4178,8 @@
 ALTER TABLE auth.mfa_factors OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5740 (class 0 OID 0)
--- Dependencies: 248
+-- TOC entry 5868 (class 0 OID 0)
+-- Dependencies: 311
 -- Name: TABLE mfa_factors; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3781,7 +4187,7 @@
 
 
 --
--- TOC entry 256 (class 1259 OID 16975)
+-- TOC entry 319 (class 1259 OID 16951)
 -- Name: one_time_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3800,7 +4206,7 @@
 ALTER TABLE auth.one_time_tokens OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 236 (class 1259 OID 16505)
+-- TOC entry 299 (class 1259 OID 16494)
 -- Name: refresh_tokens; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3820,8 +4226,8 @@
 ALTER TABLE auth.refresh_tokens OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5743 (class 0 OID 0)
--- Dependencies: 236
+-- TOC entry 5871 (class 0 OID 0)
+-- Dependencies: 299
 -- Name: TABLE refresh_tokens; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3829,7 +4235,7 @@
 
 
 --
--- TOC entry 235 (class 1259 OID 16504)
+-- TOC entry 298 (class 1259 OID 16493)
 -- Name: refresh_tokens_id_seq; Type: SEQUENCE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3844,8 +4250,8 @@
 ALTER SEQUENCE auth.refresh_tokens_id_seq OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5745 (class 0 OID 0)
--- Dependencies: 235
+-- TOC entry 5873 (class 0 OID 0)
+-- Dependencies: 298
 -- Name: refresh_tokens_id_seq; Type: SEQUENCE OWNED BY; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3853,7 +4259,7 @@
 
 
 --
--- TOC entry 253 (class 1259 OID 16854)
+-- TOC entry 316 (class 1259 OID 16830)
 -- Name: saml_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3876,8 +4282,8 @@
 ALTER TABLE auth.saml_providers OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5747 (class 0 OID 0)
--- Dependencies: 253
+-- TOC entry 5875 (class 0 OID 0)
+-- Dependencies: 316
 -- Name: TABLE saml_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3885,7 +4291,7 @@
 
 
 --
--- TOC entry 254 (class 1259 OID 16872)
+-- TOC entry 317 (class 1259 OID 16848)
 -- Name: saml_relay_states; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3905,8 +4311,8 @@
 ALTER TABLE auth.saml_relay_states OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5749 (class 0 OID 0)
--- Dependencies: 254
+-- TOC entry 5877 (class 0 OID 0)
+-- Dependencies: 317
 -- Name: TABLE saml_relay_states; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3914,7 +4320,7 @@
 
 
 --
--- TOC entry 239 (class 1259 OID 16531)
+-- TOC entry 302 (class 1259 OID 16520)
 -- Name: schema_migrations; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3926,8 +4332,8 @@
 ALTER TABLE auth.schema_migrations OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5751 (class 0 OID 0)
--- Dependencies: 239
+-- TOC entry 5879 (class 0 OID 0)
+-- Dependencies: 302
 -- Name: TABLE schema_migrations; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3935,7 +4341,7 @@
 
 
 --
--- TOC entry 247 (class 1259 OID 16753)
+-- TOC entry 310 (class 1259 OID 16728)
 -- Name: sessions; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3957,8 +4363,8 @@
 ALTER TABLE auth.sessions OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5753 (class 0 OID 0)
--- Dependencies: 247
+-- TOC entry 5881 (class 0 OID 0)
+-- Dependencies: 310
 -- Name: TABLE sessions; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3966,8 +4372,8 @@
 
 
 --
--- TOC entry 5754 (class 0 OID 0)
--- Dependencies: 247
+-- TOC entry 5882 (class 0 OID 0)
+-- Dependencies: 310
 -- Name: COLUMN sessions.not_after; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3975,7 +4381,7 @@
 
 
 --
--- TOC entry 252 (class 1259 OID 16839)
+-- TOC entry 315 (class 1259 OID 16815)
 -- Name: sso_domains; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -3992,8 +4398,8 @@
 ALTER TABLE auth.sso_domains OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5756 (class 0 OID 0)
--- Dependencies: 252
+-- TOC entry 5884 (class 0 OID 0)
+-- Dependencies: 315
 -- Name: TABLE sso_domains; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -4001,7 +4407,7 @@
 
 
 --
--- TOC entry 251 (class 1259 OID 16830)
+-- TOC entry 314 (class 1259 OID 16806)
 -- Name: sso_providers; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -4017,8 +4423,8 @@
 ALTER TABLE auth.sso_providers OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5758 (class 0 OID 0)
--- Dependencies: 251
+-- TOC entry 5886 (class 0 OID 0)
+-- Dependencies: 314
 -- Name: TABLE sso_providers; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -4026,8 +4432,8 @@
 
 
 --
--- TOC entry 5759 (class 0 OID 0)
--- Dependencies: 251
+-- TOC entry 5887 (class 0 OID 0)
+-- Dependencies: 314
 -- Name: COLUMN sso_providers.resource_id; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -4035,7 +4441,7 @@
 
 
 --
--- TOC entry 234 (class 1259 OID 16493)
+-- TOC entry 297 (class 1259 OID 16482)
 -- Name: users; Type: TABLE; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -4082,8 +4488,8 @@
 ALTER TABLE auth.users OWNER TO supabase_auth_admin;
 
 --
--- TOC entry 5761 (class 0 OID 0)
--- Dependencies: 234
+-- TOC entry 5889 (class 0 OID 0)
+-- Dependencies: 297
 -- Name: TABLE users; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -4091,8 +4497,8 @@
 
 
 --
--- TOC entry 5762 (class 0 OID 0)
--- Dependencies: 234
+-- TOC entry 5890 (class 0 OID 0)
+-- Dependencies: 297
 -- Name: COLUMN users.is_sso_user; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -4100,7 +4506,7 @@
 
 
 --
--- TOC entry 270 (class 1259 OID 17325)
+-- TOC entry 339 (class 1259 OID 17544)
 -- Name: plans; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4144,7 +4550,16 @@
 ALTER TABLE public.plans OWNER TO postgres;
 
 --
--- TOC entry 283 (class 1259 OID 17476)
+-- TOC entry 5894 (class 0 OID 0)
+-- Dependencies: 339
+-- Name: COLUMN plans.monthly_bot_minutes_limit; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.plans.monthly_bot_minutes_limit IS 'Monthly limit for bot recording minutes (replaces audio hours for bot-focused plans)';
+
+
+--
+-- TOC entry 340 (class 1259 OID 17578)
 -- Name: subscriptions; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4171,7 +4586,7 @@
 ALTER TABLE public.subscriptions OWNER TO postgres;
 
 --
--- TOC entry 326 (class 1259 OID 32374)
+-- TOC entry 386 (class 1259 OID 77434)
 -- Name: active_user_subscriptions; Type: VIEW; Schema: public; Owner: postgres
 --
 
@@ -4214,7 +4629,7 @@
 ALTER VIEW public.active_user_subscriptions OWNER TO postgres;
 
 --
--- TOC entry 276 (class 1259 OID 17407)
+-- TOC entry 352 (class 1259 OID 30448)
 -- Name: beta_waitlist; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4228,6 +4643,9 @@
     notes text,
     created_at timestamp with time zone DEFAULT now(),
     updated_at timestamp with time zone DEFAULT now(),
+    referral_source text,
+    interest_level text,
+    approved_at timestamp with time zone,
     CONSTRAINT beta_waitlist_status_check CHECK ((status = ANY (ARRAY['pending'::text, 'approved'::text, 'rejected'::text, 'invited'::text]))),
     CONSTRAINT beta_waitlist_use_case_check CHECK ((use_case = ANY (ARRAY['sales'::text, 'consulting'::text, 'hiring'::text, 'support'::text, 'other'::text])))
 );
@@ -4236,7 +4654,7 @@
 ALTER TABLE public.beta_waitlist OWNER TO postgres;
 
 --
--- TOC entry 289 (class 1259 OID 17949)
+-- TOC entry 362 (class 1259 OID 60845)
 -- Name: bot_recordings; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4258,7 +4676,7 @@
 ALTER TABLE public.bot_recordings OWNER TO postgres;
 
 --
--- TOC entry 290 (class 1259 OID 17957)
+-- TOC entry 359 (class 1259 OID 53879)
 -- Name: bot_usage_tracking; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4275,15 +4693,14 @@
     status text DEFAULT 'recording'::text,
     created_at timestamp with time zone DEFAULT now(),
     updated_at timestamp with time zone DEFAULT now(),
-    grace_period_notified boolean DEFAULT false,
-    grace_period_started_at timestamp with time zone
+    CONSTRAINT bot_usage_tracking_status_check CHECK ((status = ANY (ARRAY['recording'::text, 'completed'::text, 'failed'::text])))
 );
 
 
 ALTER TABLE public.bot_usage_tracking OWNER TO postgres;
 
 --
--- TOC entry 291 (class 1259 OID 17968)
+-- TOC entry 368 (class 1259 OID 64393)
 -- Name: calendar_auto_join_logs; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4297,14 +4714,16 @@
     status text NOT NULL,
     error_message text,
     metadata jsonb,
-    created_at timestamp with time zone DEFAULT now()
+    created_at timestamp with time zone DEFAULT now(),
+    CONSTRAINT calendar_auto_join_logs_action_check CHECK ((action = ANY (ARRAY['session_created'::text, 'bot_deployed'::text, 'bot_joined'::text, 'bot_failed'::text, 'session_ended'::text]))),
+    CONSTRAINT calendar_auto_join_logs_status_check CHECK ((status = ANY (ARRAY['success'::text, 'failure'::text])))
 );
 
 
 ALTER TABLE public.calendar_auto_join_logs OWNER TO postgres;
 
 --
--- TOC entry 292 (class 1259 OID 17975)
+-- TOC entry 364 (class 1259 OID 64265)
 -- Name: calendar_connections; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4320,14 +4739,15 @@
     is_active boolean DEFAULT true,
     last_synced_at timestamp with time zone,
     created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
-    updated_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP
+    updated_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
+    CONSTRAINT calendar_connections_provider_check CHECK ((provider = ANY (ARRAY['google_calendar'::text, 'microsoft_outlook'::text])))
 );
 
 
 ALTER TABLE public.calendar_connections OWNER TO postgres;
 
 --
--- TOC entry 293 (class 1259 OID 17984)
+-- TOC entry 365 (class 1259 OID 64291)
 -- Name: calendar_events; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4353,15 +4773,16 @@
     auto_session_created boolean DEFAULT false,
     auto_session_id uuid,
     auto_bot_status text,
-    auto_join_enabled boolean
+    auto_join_enabled boolean,
+    CONSTRAINT calendar_events_auto_bot_status_check CHECK ((auto_bot_status = ANY (ARRAY['pending'::text, 'deployed'::text, 'joining'::text, 'in_call'::text, 'failed'::text, 'ended'::text])))
 );
 
 
 ALTER TABLE public.calendar_events OWNER TO postgres;
 
 --
--- TOC entry 5774 (class 0 OID 0)
--- Dependencies: 293
+-- TOC entry 5903 (class 0 OID 0)
+-- Dependencies: 365
 -- Name: COLUMN calendar_events.auto_join_enabled; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4369,7 +4790,7 @@
 
 
 --
--- TOC entry 294 (class 1259 OID 17996)
+-- TOC entry 367 (class 1259 OID 64330)
 -- Name: calendar_preferences; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4391,7 +4812,7 @@
 ALTER TABLE public.calendar_preferences OWNER TO postgres;
 
 --
--- TOC entry 295 (class 1259 OID 18011)
+-- TOC entry 366 (class 1259 OID 64316)
 -- Name: calendar_webhooks; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4409,7 +4830,7 @@
 ALTER TABLE public.calendar_webhooks OWNER TO postgres;
 
 --
--- TOC entry 296 (class 1259 OID 18018)
+-- TOC entry 372 (class 1259 OID 66863)
 -- Name: collaborative_action_items; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4428,14 +4849,17 @@
     created_at timestamp with time zone DEFAULT now(),
     updated_at timestamp with time zone DEFAULT now(),
     completed_at timestamp with time zone,
-    completed_by uuid
+    completed_by uuid,
+    CONSTRAINT collaborative_action_items_priority_check CHECK (((priority)::text = ANY ((ARRAY['low'::character varying, 'medium'::character varying, 'high'::character varying, 'urgent'::character varying])::text[]))),
+    CONSTRAINT collaborative_action_items_source_type_check CHECK (((source_type)::text = ANY ((ARRAY['ai_generated'::character varying, 'comment'::character varying, 'manual'::character varying])::text[]))),
+    CONSTRAINT collaborative_action_items_status_check CHECK (((status)::text = ANY ((ARRAY['pending'::character varying, 'in_progress'::character varying, 'completed'::character varying, 'cancelled'::character varying])::text[])))
 );
 
 
 ALTER TABLE public.collaborative_action_items OWNER TO postgres;
 
 --
--- TOC entry 297 (class 1259 OID 18028)
+-- TOC entry 371 (class 1259 OID 66843)
 -- Name: comment_mentions; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4452,7 +4876,7 @@
 ALTER TABLE public.comment_mentions OWNER TO postgres;
 
 --
--- TOC entry 298 (class 1259 OID 18034)
+-- TOC entry 354 (class 1259 OID 49163)
 -- Name: conversation_links; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4467,7 +4891,7 @@
 ALTER TABLE public.conversation_links OWNER TO postgres;
 
 --
--- TOC entry 322 (class 1259 OID 32207)
+-- TOC entry 384 (class 1259 OID 76279)
 -- Name: custom_reports; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4487,16 +4911,97 @@
 ALTER TABLE public.custom_reports OWNER TO postgres;
 
 --
--- TOC entry 5781 (class 0 OID 0)
--- Dependencies: 322
+-- TOC entry 5910 (class 0 OID 0)
+-- Dependencies: 384
 -- Name: TABLE custom_reports; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON TABLE public.custom_reports IS 'Stores custom generated reports for conversation sessions';
+COMMENT ON TABLE public.custom_reports IS 'Stores AI-generated custom reports created by users for their sessions';
 
 
 --
--- TOC entry 277 (class 1259 OID 17418)
+-- TOC entry 5911 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.id; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.id IS 'Unique identifier for the custom report';
+
+
+--
+-- TOC entry 5912 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.session_id; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.session_id IS 'Reference to the session this report is for';
+
+
+--
+-- TOC entry 5913 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.user_id; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.user_id IS 'User who created this report';
+
+
+--
+-- TOC entry 5914 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.prompt; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.prompt IS 'The prompt used to generate this report';
+
+
+--
+-- TOC entry 5915 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.template; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.template IS 'Template type used (e.g., executive-brief, technical-documentation)';
+
+
+--
+-- TOC entry 5916 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.generated_content; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.generated_content IS 'The AI-generated report content in markdown format';
+
+
+--
+-- TOC entry 5917 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.metadata; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.metadata IS 'Additional metadata about report generation options';
+
+
+--
+-- TOC entry 5918 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.created_at; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.created_at IS 'When the report was created';
+
+
+--
+-- TOC entry 5919 (class 0 OID 0)
+-- Dependencies: 384
+-- Name: COLUMN custom_reports.updated_at; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.custom_reports.updated_at IS 'When the report was last updated';
+
+
+--
+-- TOC entry 335 (class 1259 OID 17426)
 -- Name: documents; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4524,7 +5029,7 @@
 ALTER TABLE public.documents OWNER TO postgres;
 
 --
--- TOC entry 323 (class 1259 OID 32236)
+-- TOC entry 377 (class 1259 OID 73809)
 -- Name: email_notifications; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4538,24 +5043,14 @@
     error_message text,
     sent_at timestamp with time zone,
     created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
-    updated_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
-    CONSTRAINT email_notifications_status_check CHECK (((status)::text = ANY ((ARRAY['pending'::character varying, 'sent'::character varying, 'failed'::character varying, 'bounced'::character varying])::text[])))
+    updated_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP
 );
 
 
 ALTER TABLE public.email_notifications OWNER TO postgres;
 
 --
--- TOC entry 5784 (class 0 OID 0)
--- Dependencies: 323
--- Name: TABLE email_notifications; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON TABLE public.email_notifications IS 'Tracks all email notifications sent to users with delivery status';
-
-
---
--- TOC entry 331 (class 1259 OID 35393)
+-- TOC entry 394 (class 1259 OID 81247)
 -- Name: embedding_queue; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4569,14 +5064,15 @@
     status text DEFAULT 'pending'::text,
     error_message text,
     created_at timestamp with time zone DEFAULT now(),
-    processed_at timestamp with time zone
+    processed_at timestamp with time zone,
+    CONSTRAINT embedding_queue_status_check CHECK ((status = ANY (ARRAY['pending'::text, 'processing'::text, 'completed'::text, 'failed'::text])))
 );
 
 
 ALTER TABLE public.embedding_queue OWNER TO postgres;
 
 --
--- TOC entry 278 (class 1259 OID 17428)
+-- TOC entry 337 (class 1259 OID 17478)
 -- Name: guidance; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4604,7 +5100,7 @@
 ALTER TABLE public.guidance OWNER TO postgres;
 
 --
--- TOC entry 329 (class 1259 OID 33905)
+-- TOC entry 393 (class 1259 OID 80870)
 -- Name: integration_exports; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4627,8 +5123,8 @@
 ALTER TABLE public.integration_exports OWNER TO postgres;
 
 --
--- TOC entry 5788 (class 0 OID 0)
--- Dependencies: 329
+-- TOC entry 5925 (class 0 OID 0)
+-- Dependencies: 393
 -- Name: TABLE integration_exports; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4636,8 +5132,8 @@
 
 
 --
--- TOC entry 5789 (class 0 OID 0)
--- Dependencies: 329
+-- TOC entry 5926 (class 0 OID 0)
+-- Dependencies: 393
 -- Name: COLUMN integration_exports.status; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4645,8 +5141,8 @@
 
 
 --
--- TOC entry 5790 (class 0 OID 0)
--- Dependencies: 329
+-- TOC entry 5927 (class 0 OID 0)
+-- Dependencies: 393
 -- Name: COLUMN integration_exports.export_id; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4654,8 +5150,8 @@
 
 
 --
--- TOC entry 5791 (class 0 OID 0)
--- Dependencies: 329
+-- TOC entry 5928 (class 0 OID 0)
+-- Dependencies: 393
 -- Name: COLUMN integration_exports.url; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4663,8 +5159,8 @@
 
 
 --
--- TOC entry 5792 (class 0 OID 0)
--- Dependencies: 329
+-- TOC entry 5929 (class 0 OID 0)
+-- Dependencies: 393
 -- Name: COLUMN integration_exports.error; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4672,8 +5168,8 @@
 
 
 --
--- TOC entry 5793 (class 0 OID 0)
--- Dependencies: 329
+-- TOC entry 5930 (class 0 OID 0)
+-- Dependencies: 393
 -- Name: COLUMN integration_exports.metadata; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4681,7 +5177,7 @@
 
 
 --
--- TOC entry 328 (class 1259 OID 33880)
+-- TOC entry 392 (class 1259 OID 80845)
 -- Name: integration_settings; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4701,8 +5197,8 @@
 ALTER TABLE public.integration_settings OWNER TO postgres;
 
 --
--- TOC entry 5795 (class 0 OID 0)
--- Dependencies: 328
+-- TOC entry 5932 (class 0 OID 0)
+-- Dependencies: 392
 -- Name: TABLE integration_settings; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4710,8 +5206,8 @@
 
 
 --
--- TOC entry 5796 (class 0 OID 0)
--- Dependencies: 328
+-- TOC entry 5933 (class 0 OID 0)
+-- Dependencies: 392
 -- Name: COLUMN integration_settings.provider; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4719,8 +5215,8 @@
 
 
 --
--- TOC entry 5797 (class 0 OID 0)
--- Dependencies: 328
+-- TOC entry 5934 (class 0 OID 0)
+-- Dependencies: 392
 -- Name: COLUMN integration_settings.config; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4728,8 +5224,8 @@
 
 
 --
--- TOC entry 5798 (class 0 OID 0)
--- Dependencies: 328
+-- TOC entry 5935 (class 0 OID 0)
+-- Dependencies: 392
 -- Name: COLUMN integration_settings.is_active; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4737,7 +5233,7 @@
 
 
 --
--- TOC entry 299 (class 1259 OID 18039)
+-- TOC entry 357 (class 1259 OID 52616)
 -- Name: meeting_metadata; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4760,7 +5256,16 @@
 ALTER TABLE public.meeting_metadata OWNER TO postgres;
 
 --
--- TOC entry 300 (class 1259 OID 18048)
+-- TOC entry 5937 (class 0 OID 0)
+-- Dependencies: 357
+-- Name: TABLE meeting_metadata; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON TABLE public.meeting_metadata IS 'Stores additional metadata for video conference meetings';
+
+
+--
+-- TOC entry 369 (class 1259 OID 64421)
 -- Name: meeting_notifications; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4774,14 +5279,15 @@
     message text NOT NULL,
     action_url text,
     read boolean DEFAULT false,
-    created_at timestamp with time zone DEFAULT now()
+    created_at timestamp with time zone DEFAULT now(),
+    CONSTRAINT meeting_notifications_notification_type_check CHECK ((notification_type = ANY (ARRAY['meeting_starting'::text, 'bot_deployed'::text, 'bot_in_call'::text, 'bot_failed'::text])))
 );
 
 
 ALTER TABLE public.meeting_notifications OWNER TO postgres;
 
 --
--- TOC entry 274 (class 1259 OID 17389)
+-- TOC entry 350 (class 1259 OID 30224)
 -- Name: monthly_usage_cache; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4801,7 +5307,7 @@
 ALTER TABLE public.monthly_usage_cache OWNER TO postgres;
 
 --
--- TOC entry 279 (class 1259 OID 17440)
+-- TOC entry 332 (class 1259 OID 17316)
 -- Name: organization_invitations; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4826,7 +5332,7 @@
 ALTER TABLE public.organization_invitations OWNER TO postgres;
 
 --
--- TOC entry 269 (class 1259 OID 17310)
+-- TOC entry 331 (class 1259 OID 17284)
 -- Name: organization_members; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4853,7 +5359,7 @@
 ALTER TABLE public.organization_members OWNER TO postgres;
 
 --
--- TOC entry 268 (class 1259 OID 17297)
+-- TOC entry 330 (class 1259 OID 17264)
 -- Name: organizations; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4893,7 +5399,7 @@
 ALTER TABLE public.organizations OWNER TO postgres;
 
 --
--- TOC entry 280 (class 1259 OID 17450)
+-- TOC entry 346 (class 1259 OID 27368)
 -- Name: prep_checklist; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4912,8 +5418,8 @@
 ALTER TABLE public.prep_checklist OWNER TO postgres;
 
 --
--- TOC entry 5806 (class 0 OID 0)
--- Dependencies: 280
+-- TOC entry 5944 (class 0 OID 0)
+-- Dependencies: 346
 -- Name: TABLE prep_checklist; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4921,8 +5427,8 @@
 
 
 --
--- TOC entry 5807 (class 0 OID 0)
--- Dependencies: 280
+-- TOC entry 5945 (class 0 OID 0)
+-- Dependencies: 346
 -- Name: COLUMN prep_checklist.id; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4930,8 +5436,8 @@
 
 
 --
--- TOC entry 5808 (class 0 OID 0)
--- Dependencies: 280
+-- TOC entry 5946 (class 0 OID 0)
+-- Dependencies: 346
 -- Name: COLUMN prep_checklist.session_id; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4939,8 +5445,8 @@
 
 
 --
--- TOC entry 5809 (class 0 OID 0)
--- Dependencies: 280
+-- TOC entry 5947 (class 0 OID 0)
+-- Dependencies: 346
 -- Name: COLUMN prep_checklist.text; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4948,8 +5454,8 @@
 
 
 --
--- TOC entry 5810 (class 0 OID 0)
--- Dependencies: 280
+-- TOC entry 5948 (class 0 OID 0)
+-- Dependencies: 346
 -- Name: COLUMN prep_checklist.status; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -4957,7 +5463,34 @@
 
 
 --
--- TOC entry 301 (class 1259 OID 18056)
+-- TOC entry 5949 (class 0 OID 0)
+-- Dependencies: 346
+-- Name: COLUMN prep_checklist.created_at; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.prep_checklist.created_at IS 'Timestamp when item was created';
+
+
+--
+-- TOC entry 5950 (class 0 OID 0)
+-- Dependencies: 346
+-- Name: COLUMN prep_checklist.updated_at; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.prep_checklist.updated_at IS 'Timestamp when item was last updated';
+
+
+--
+-- TOC entry 5951 (class 0 OID 0)
+-- Dependencies: 346
+-- Name: COLUMN prep_checklist.created_by; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.prep_checklist.created_by IS 'Foreign key to users table - who created the item';
+
+
+--
+-- TOC entry 356 (class 1259 OID 51488)
 -- Name: recall_ai_webhooks; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4975,7 +5508,7 @@
 ALTER TABLE public.recall_ai_webhooks OWNER TO postgres;
 
 --
--- TOC entry 325 (class 1259 OID 32293)
+-- TOC entry 383 (class 1259 OID 76223)
 -- Name: referral_audit_logs; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -4999,16 +5532,7 @@
 ALTER TABLE public.referral_audit_logs OWNER TO postgres;
 
 --
--- TOC entry 5813 (class 0 OID 0)
--- Dependencies: 325
--- Name: TABLE referral_audit_logs; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON TABLE public.referral_audit_logs IS 'Comprehensive audit trail for all referral system events including clicks, validations, completions, and fraud detection';
-
-
---
--- TOC entry 318 (class 1259 OID 26954)
+-- TOC entry 390 (class 1259 OID 79694)
 -- Name: referral_fraud_checks; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5027,7 +5551,7 @@
 ALTER TABLE public.referral_fraud_checks OWNER TO postgres;
 
 --
--- TOC entry 302 (class 1259 OID 18064)
+-- TOC entry 373 (class 1259 OID 66902)
 -- Name: report_activity; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5039,14 +5563,15 @@
     details jsonb DEFAULT '{}'::jsonb,
     created_at timestamp with time zone DEFAULT now(),
     guest_id text,
-    guest_name text
+    guest_name text,
+    CONSTRAINT report_activity_activity_type_check CHECK (((activity_type)::text = ANY ((ARRAY['viewed'::character varying, 'commented'::character varying, 'resolved_comment'::character varying, 'mentioned_user'::character varying, 'task_created'::character varying, 'task_assigned'::character varying, 'task_completed'::character varying, 'task_updated'::character varying, 'report_shared'::character varying, 'bookmark_added'::character varying, 'reaction_added'::character varying])::text[])))
 );
 
 
 ALTER TABLE public.report_activity OWNER TO postgres;
 
 --
--- TOC entry 303 (class 1259 OID 18072)
+-- TOC entry 375 (class 1259 OID 66959)
 -- Name: report_bookmarks; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5059,14 +5584,15 @@
     content_snippet text,
     color character varying(20) DEFAULT 'yellow'::character varying,
     position_data jsonb,
-    created_at timestamp with time zone DEFAULT now()
+    created_at timestamp with time zone DEFAULT now(),
+    CONSTRAINT report_bookmarks_color_check CHECK (((color)::text = ANY ((ARRAY['yellow'::character varying, 'green'::character varying, 'blue'::character varying, 'pink'::character varying, 'purple'::character varying])::text[])))
 );
 
 
 ALTER TABLE public.report_bookmarks OWNER TO postgres;
 
 --
--- TOC entry 304 (class 1259 OID 18080)
+-- TOC entry 374 (class 1259 OID 66927)
 -- Name: report_collaborators; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5080,14 +5606,15 @@
     invited_by uuid NOT NULL,
     invited_at timestamp with time zone DEFAULT now(),
     accepted_at timestamp with time zone,
-    last_viewed_at timestamp with time zone
+    last_viewed_at timestamp with time zone,
+    CONSTRAINT report_collaborators_role_check CHECK (((role)::text = ANY ((ARRAY['viewer'::character varying, 'commenter'::character varying, 'editor'::character varying])::text[])))
 );
 
 
 ALTER TABLE public.report_collaborators OWNER TO postgres;
 
 --
--- TOC entry 305 (class 1259 OID 18086)
+-- TOC entry 370 (class 1259 OID 66811)
 -- Name: report_comments; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5107,14 +5634,15 @@
     reactions jsonb DEFAULT '{}'::jsonb,
     guest_id text,
     guest_name text,
-    is_guest boolean DEFAULT false
+    is_guest boolean DEFAULT false,
+    CONSTRAINT report_comments_author_check CHECK ((((user_id IS NOT NULL) AND (guest_id IS NULL) AND (is_guest = false)) OR ((user_id IS NULL) AND (guest_id IS NOT NULL) AND (guest_name IS NOT NULL) AND (is_guest = true))))
 );
 
 
 ALTER TABLE public.report_comments OWNER TO postgres;
 
 --
--- TOC entry 281 (class 1259 OID 17460)
+-- TOC entry 345 (class 1259 OID 26062)
 -- Name: session_context; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5135,7 +5663,7 @@
 ALTER TABLE public.session_context OWNER TO postgres;
 
 --
--- TOC entry 282 (class 1259 OID 17469)
+-- TOC entry 344 (class 1259 OID 18768)
 -- Name: session_timeline_events; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5154,7 +5682,7 @@
 ALTER TABLE public.session_timeline_events OWNER TO postgres;
 
 --
--- TOC entry 271 (class 1259 OID 17351)
+-- TOC entry 334 (class 1259 OID 17390)
 -- Name: sessions; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5198,17 +5726,74 @@
     recall_recording_status character varying(50),
     recall_recording_expires_at timestamp with time zone,
     ai_instructions text,
-    participants jsonb,
-    title_embedding public.vector(1536),
-    embedding_generated_at timestamp with time zone
+    participants jsonb DEFAULT '[]'::jsonb,
+    title_embedding public.halfvec(1536),
+    embedding_generated_at timestamp with time zone,
+    CONSTRAINT sessions_meeting_platform_check CHECK ((meeting_platform = ANY (ARRAY['zoom'::text, 'google_meet'::text, 'teams'::text, 'local'::text, NULL::text]))),
+    CONSTRAINT sessions_recording_type_check CHECK ((recording_type = ANY (ARRAY['local'::text, 'meeting'::text, 'desktop'::text]))),
+    CONSTRAINT sessions_transcription_provider_check CHECK ((transcription_provider = ANY (ARRAY['deepgram'::text, 'recall_ai'::text, 'hybrid'::text])))
 );
 
 
 ALTER TABLE public.sessions OWNER TO postgres;
 
 --
--- TOC entry 5822 (class 0 OID 0)
--- Dependencies: 271
+-- TOC entry 5962 (class 0 OID 0)
+-- Dependencies: 334
+-- Name: COLUMN sessions.participant_me; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.sessions.participant_me IS 'Name of the primary user/speaker (defaults to user full name)';
+
+
+--
+-- TOC entry 5963 (class 0 OID 0)
+-- Dependencies: 334
+-- Name: COLUMN sessions.participant_them; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.sessions.participant_them IS 'Name of the other participant(s) in the conversation';
+
+
+--
+-- TOC entry 5964 (class 0 OID 0)
+-- Dependencies: 334
+-- Name: COLUMN sessions.realtime_summary_last_processed_index; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.sessions.realtime_summary_last_processed_index IS 'Index of the last transcript message that was processed for the realtime summary. -1 means no summary generated yet.';
+
+
+--
+-- TOC entry 5965 (class 0 OID 0)
+-- Dependencies: 334
+-- Name: COLUMN sessions.recall_recording_url; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.sessions.recall_recording_url IS 'Direct URL to the Recall.ai recording video file';
+
+
+--
+-- TOC entry 5966 (class 0 OID 0)
+-- Dependencies: 334
+-- Name: COLUMN sessions.recall_recording_status; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.sessions.recall_recording_status IS 'Status of the recording: processing, done, failed';
+
+
+--
+-- TOC entry 5967 (class 0 OID 0)
+-- Dependencies: 334
+-- Name: COLUMN sessions.recall_recording_expires_at; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.sessions.recall_recording_expires_at IS 'Expiration timestamp for the recording URL';
+
+
+--
+-- TOC entry 5968 (class 0 OID 0)
+-- Dependencies: 334
 -- Name: COLUMN sessions.ai_instructions; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -5216,16 +5801,16 @@
 
 
 --
--- TOC entry 5823 (class 0 OID 0)
--- Dependencies: 271
+-- TOC entry 5969 (class 0 OID 0)
+-- Dependencies: 334
 -- Name: COLUMN sessions.participants; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON COLUMN public.sessions.participants IS 'JSONB array of participant information including names and emails';
+COMMENT ON COLUMN public.sessions.participants IS 'Array of participant objects with email, name, and response status from calendar events';
 
 
 --
--- TOC entry 306 (class 1259 OID 18098)
+-- TOC entry 363 (class 1259 OID 62006)
 -- Name: shared_reports; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5249,34 +5834,34 @@
 ALTER TABLE public.shared_reports OWNER TO postgres;
 
 --
--- TOC entry 5825 (class 0 OID 0)
--- Dependencies: 306
+-- TOC entry 5971 (class 0 OID 0)
+-- Dependencies: 363
 -- Name: COLUMN shared_reports.share_with_participants; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON COLUMN public.shared_reports.share_with_participants IS 'Whether to share the report with session participants';
+COMMENT ON COLUMN public.shared_reports.share_with_participants IS 'Whether this shared report was sent to all meeting participants';
 
 
 --
--- TOC entry 5826 (class 0 OID 0)
--- Dependencies: 306
+-- TOC entry 5972 (class 0 OID 0)
+-- Dependencies: 363
 -- Name: COLUMN shared_reports.excluded_participants; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON COLUMN public.shared_reports.excluded_participants IS 'Array of participant emails to exclude from sharing';
+COMMENT ON COLUMN public.shared_reports.excluded_participants IS 'Array of email addresses excluded from participant sharing';
 
 
 --
--- TOC entry 5827 (class 0 OID 0)
--- Dependencies: 306
+-- TOC entry 5973 (class 0 OID 0)
+-- Dependencies: 363
 -- Name: COLUMN shared_reports.email_send_status; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON COLUMN public.shared_reports.email_send_status IS 'Status of email sends to participants';
+COMMENT ON COLUMN public.shared_reports.email_send_status IS 'JSON object tracking email send status for each recipient';
 
 
 --
--- TOC entry 307 (class 1259 OID 18107)
+-- TOC entry 358 (class 1259 OID 52635)
 -- Name: smart_notes; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5298,7 +5883,43 @@
 ALTER TABLE public.smart_notes OWNER TO postgres;
 
 --
--- TOC entry 308 (class 1259 OID 18118)
+-- TOC entry 5975 (class 0 OID 0)
+-- Dependencies: 358
+-- Name: TABLE smart_notes; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON TABLE public.smart_notes IS 'Stores AI-generated and manual notes categorized by type';
+
+
+--
+-- TOC entry 5976 (class 0 OID 0)
+-- Dependencies: 358
+-- Name: COLUMN smart_notes.category; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.smart_notes.category IS 'Type of note: key_point, action_item, decision, question, insight';
+
+
+--
+-- TOC entry 5977 (class 0 OID 0)
+-- Dependencies: 358
+-- Name: COLUMN smart_notes.importance; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.smart_notes.importance IS 'Priority level: high, medium, low';
+
+
+--
+-- TOC entry 5978 (class 0 OID 0)
+-- Dependencies: 358
+-- Name: COLUMN smart_notes.is_manual; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.smart_notes.is_manual IS 'Whether the note was manually created by user or AI-generated';
+
+
+--
+-- TOC entry 353 (class 1259 OID 38974)
 -- Name: subscription_events; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5316,7 +5937,7 @@
 ALTER TABLE public.subscription_events OWNER TO postgres;
 
 --
--- TOC entry 284 (class 1259 OID 17485)
+-- TOC entry 338 (class 1259 OID 17511)
 -- Name: summaries; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5343,7 +5964,8 @@
     created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
     updated_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
     deleted_at timestamp with time zone,
-    content_embedding public.vector(1536),
+    memory_json jsonb,
+    content_embedding public.halfvec(1536),
     embedding_generated_at timestamp with time zone
 );
 
@@ -5351,7 +5973,7 @@
 ALTER TABLE public.summaries OWNER TO postgres;
 
 --
--- TOC entry 285 (class 1259 OID 17496)
+-- TOC entry 343 (class 1259 OID 17669)
 -- Name: system_logs; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5376,7 +5998,7 @@
 ALTER TABLE public.system_logs OWNER TO postgres;
 
 --
--- TOC entry 309 (class 1259 OID 18125)
+-- TOC entry 355 (class 1259 OID 50323)
 -- Name: system_settings; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5390,7 +6012,7 @@
 ALTER TABLE public.system_settings OWNER TO postgres;
 
 --
--- TOC entry 273 (class 1259 OID 17376)
+-- TOC entry 333 (class 1259 OID 17359)
 -- Name: templates; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5419,7 +6041,7 @@
 ALTER TABLE public.templates OWNER TO postgres;
 
 --
--- TOC entry 272 (class 1259 OID 17365)
+-- TOC entry 336 (class 1259 OID 17458)
 -- Name: transcripts; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5430,17 +6052,12 @@
     speaker character varying(50) DEFAULT 'user'::character varying,
     confidence_score numeric(3,2),
     start_time_seconds numeric(10,3) NOT NULL,
-    end_time_seconds numeric(10,3),
-    duration_seconds numeric(8,3),
     stt_provider character varying(50),
     is_final boolean DEFAULT false,
     created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
     updated_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
     client_id character varying(255),
     sequence_number integer DEFAULT 1 NOT NULL,
-    client_timestamp timestamp with time zone,
-    audio_timestamp_ms integer,
-    session_start_timestamp timestamp with time zone,
     is_owner boolean DEFAULT false
 );
 
@@ -5448,43 +6065,34 @@
 ALTER TABLE public.transcripts OWNER TO postgres;
 
 --
--- TOC entry 5835 (class 0 OID 0)
--- Dependencies: 272
--- Name: COLUMN transcripts.sequence_number; Type: COMMENT; Schema: public; Owner: postgres
+-- TOC entry 5985 (class 0 OID 0)
+-- Dependencies: 336
+-- Name: COLUMN transcripts.start_time_seconds; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON COLUMN public.transcripts.sequence_number IS 'Ordered sequence number for transcript lines within a session, used instead of timestamp-based uniqueness';
+COMMENT ON COLUMN public.transcripts.start_time_seconds IS 'Time offset in seconds from the start of the recording session';
 
 
 --
--- TOC entry 5836 (class 0 OID 0)
--- Dependencies: 272
--- Name: COLUMN transcripts.client_timestamp; Type: COMMENT; Schema: public; Owner: postgres
+-- TOC entry 5986 (class 0 OID 0)
+-- Dependencies: 336
+-- Name: COLUMN transcripts.sequence_number; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON COLUMN public.transcripts.client_timestamp IS 'Client-side timestamp when transcript was generated';
+COMMENT ON COLUMN public.transcripts.sequence_number IS 'Sequential order of transcript segments within a session, used for proper ordering';
 
 
 --
--- TOC entry 5837 (class 0 OID 0)
--- Dependencies: 272
--- Name: COLUMN transcripts.audio_timestamp_ms; Type: COMMENT; Schema: public; Owner: postgres
+-- TOC entry 5987 (class 0 OID 0)
+-- Dependencies: 336
+-- Name: COLUMN transcripts.is_owner; Type: COMMENT; Schema: public; Owner: postgres
 --
 
-COMMENT ON COLUMN public.transcripts.audio_timestamp_ms IS 'Precise audio timestamp in milliseconds from start of recording';
+COMMENT ON COLUMN public.transcripts.is_owner IS 'Indicates if this transcript line was spoken by the meeting organizer/initiator';
 
 
 --
--- TOC entry 5838 (class 0 OID 0)
--- Dependencies: 272
--- Name: COLUMN transcripts.session_start_timestamp; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON COLUMN public.transcripts.session_start_timestamp IS 'Session start time for calculating relative timestamps';
-
-
---
--- TOC entry 286 (class 1259 OID 17503)
+-- TOC entry 341 (class 1259 OID 17614)
 -- Name: usage_records; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5507,7 +6115,7 @@
 ALTER TABLE public.usage_records OWNER TO postgres;
 
 --
--- TOC entry 275 (class 1259 OID 17398)
+-- TOC entry 349 (class 1259 OID 30195)
 -- Name: usage_tracking; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5519,7 +6127,8 @@
     minute_timestamp timestamp with time zone NOT NULL,
     seconds_recorded integer DEFAULT 0 NOT NULL,
     created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
-    source text,
+    source text DEFAULT 'browser_recording'::text,
+    metadata jsonb DEFAULT '{}'::jsonb,
     CONSTRAINT seconds_recorded_check CHECK (((seconds_recorded >= 0) AND (seconds_recorded <= 60)))
 );
 
@@ -5527,7 +6136,7 @@
 ALTER TABLE public.usage_tracking OWNER TO postgres;
 
 --
--- TOC entry 287 (class 1259 OID 17510)
+-- TOC entry 342 (class 1259 OID 17649)
 -- Name: user_app_sessions; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5553,7 +6162,7 @@
 ALTER TABLE public.user_app_sessions OWNER TO postgres;
 
 --
--- TOC entry 316 (class 1259 OID 26930)
+-- TOC entry 382 (class 1259 OID 76153)
 -- Name: user_credits; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5564,51 +6173,54 @@
     type character varying(50) NOT NULL,
     description text,
     reference_id uuid,
+    stripe_customer_balance_txn_id character varying(255),
+    created_at timestamp with time zone DEFAULT now() NOT NULL,
     expires_at timestamp with time zone,
-    created_at timestamp with time zone DEFAULT now(),
-    stripe_customer_balance_txn_id text,
-    CONSTRAINT user_credits_type_check CHECK (((type)::text = ANY ((ARRAY['referral_reward'::character varying, 'promotional'::character varying, 'manual_adjustment'::character varying, 'redemption'::character varying])::text[])))
+    metadata jsonb DEFAULT '{}'::jsonb,
+    expiry_warning_sent boolean DEFAULT false,
+    CONSTRAINT positive_amount CHECK ((amount > (0)::numeric)),
+    CONSTRAINT user_credits_type_check CHECK (((type)::text = ANY ((ARRAY['referral_reward'::character varying, 'redemption'::character varying])::text[])))
 );
 
 
 ALTER TABLE public.user_credits OWNER TO postgres;
 
 --
--- TOC entry 317 (class 1259 OID 26949)
+-- TOC entry 389 (class 1259 OID 79689)
 -- Name: user_credit_balance; Type: VIEW; Schema: public; Owner: postgres
 --
 
 CREATE VIEW public.user_credit_balance AS
- SELECT user_id,
+ SELECT user_credits.user_id,
     sum(
         CASE
-            WHEN ((type)::text = 'redemption'::text) THEN (- amount)
-            ELSE amount
+            WHEN ((user_credits.type)::text = 'redemption'::text) THEN (- user_credits.amount)
+            ELSE user_credits.amount
         END) AS balance,
     count(
         CASE
-            WHEN ((type)::text = 'referral_reward'::text) THEN 1
+            WHEN ((user_credits.type)::text = 'referral_reward'::text) THEN 1
             ELSE NULL::integer
         END) AS total_referrals,
     sum(
         CASE
-            WHEN ((type)::text = 'referral_reward'::text) THEN amount
+            WHEN ((user_credits.type)::text = 'referral_reward'::text) THEN user_credits.amount
             ELSE (0)::numeric
         END) AS total_earned,
     sum(
         CASE
-            WHEN ((type)::text = 'redemption'::text) THEN amount
+            WHEN ((user_credits.type)::text = 'redemption'::text) THEN user_credits.amount
             ELSE (0)::numeric
         END) AS total_redeemed
    FROM public.user_credits
-  WHERE ((expires_at IS NULL) OR (expires_at > now()))
-  GROUP BY user_id;
+  WHERE ((user_credits.expires_at IS NULL) OR (user_credits.expires_at > now()))
+  GROUP BY user_credits.user_id;
 
 
 ALTER VIEW public.user_credit_balance OWNER TO postgres;
 
 --
--- TOC entry 324 (class 1259 OID 32266)
+-- TOC entry 378 (class 1259 OID 73837)
 -- Name: user_preferences; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5627,86 +6239,32 @@
 ALTER TABLE public.user_preferences OWNER TO postgres;
 
 --
--- TOC entry 5845 (class 0 OID 0)
--- Dependencies: 324
--- Name: TABLE user_preferences; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON TABLE public.user_preferences IS 'Stores user notification and email preferences';
-
-
---
--- TOC entry 315 (class 1259 OID 26903)
+-- TOC entry 381 (class 1259 OID 76129)
 -- Name: user_referrals; Type: TABLE; Schema: public; Owner: postgres
 --
 
 CREATE TABLE public.user_referrals (
     id uuid DEFAULT gen_random_uuid() NOT NULL,
-    referrer_user_id uuid NOT NULL,
-    referee_user_id uuid,
-    referral_code character varying(10) NOT NULL,
-    status public.referral_status DEFAULT 'pending'::public.referral_status,
+    referrer_id uuid NOT NULL,
+    referee_id uuid NOT NULL,
+    referee_email character varying(255) NOT NULL,
+    status public.referral_status DEFAULT 'pending'::public.referral_status NOT NULL,
+    created_at timestamp with time zone DEFAULT now() NOT NULL,
+    completed_at timestamp with time zone,
     reward_amount numeric(10,2) DEFAULT 5.00,
-    referee_discount_percent integer DEFAULT 10,
-    referee_discount_applied boolean DEFAULT false,
-    device_id character varying(255),
+    discount_percentage integer DEFAULT 10,
     ip_address inet,
-    created_at timestamp with time zone DEFAULT now(),
-    completed_at timestamp with time zone,
-    rewarded_at timestamp with time zone,
-    first_payment_id text,
-    stripe_coupon_id text,
-    stripe_checkout_session_id text,
-    referee_email character varying(255),
+    device_id character varying(255),
     stripe_customer_id character varying(255),
     stripe_payment_intent_id character varying(255),
-    metadata jsonb DEFAULT '{}'::jsonb,
-    referrer_id uuid NOT NULL,
-    referee_id uuid NOT NULL,
-    discount_percentage integer
+    metadata jsonb DEFAULT '{}'::jsonb
 );
 
 
 ALTER TABLE public.user_referrals OWNER TO postgres;
 
 --
--- TOC entry 5847 (class 0 OID 0)
--- Dependencies: 315
--- Name: COLUMN user_referrals.referee_email; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON COLUMN public.user_referrals.referee_email IS 'Email address of the referee';
-
-
---
--- TOC entry 5848 (class 0 OID 0)
--- Dependencies: 315
--- Name: COLUMN user_referrals.metadata; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON COLUMN public.user_referrals.metadata IS 'Additional metadata for the referral';
-
-
---
--- TOC entry 5849 (class 0 OID 0)
--- Dependencies: 315
--- Name: COLUMN user_referrals.referrer_id; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON COLUMN public.user_referrals.referrer_id IS 'User ID of the person who made the referral';
-
-
---
--- TOC entry 5850 (class 0 OID 0)
--- Dependencies: 315
--- Name: COLUMN user_referrals.referee_id; Type: COMMENT; Schema: public; Owner: postgres
---
-
-COMMENT ON COLUMN public.user_referrals.referee_id IS 'User ID of the person who was referred';
-
-
---
--- TOC entry 267 (class 1259 OID 17283)
+-- TOC entry 329 (class 1259 OID 17241)
 -- Name: users; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5737,15 +6295,16 @@
     onboarding_completed_at timestamp with time zone,
     last_subscription_change timestamp with time zone,
     referral_code character varying(10),
-    referred_by_user_id uuid
+    referred_by_user_id uuid,
+    CONSTRAINT valid_referral_code CHECK (((referral_code)::text ~ '^[A-Z0-9]{6,10}$'::text))
 );
 
 
 ALTER TABLE public.users OWNER TO postgres;
 
 --
--- TOC entry 5852 (class 0 OID 0)
--- Dependencies: 267
+-- TOC entry 5996 (class 0 OID 0)
+-- Dependencies: 329
 -- Name: COLUMN users.personal_context; Type: COMMENT; Schema: public; Owner: postgres
 --
 
@@ -5753,7 +6312,16 @@
 
 
 --
--- TOC entry 288 (class 1259 OID 17519)
+-- TOC entry 5997 (class 0 OID 0)
+-- Dependencies: 329
+-- Name: COLUMN users.is_admin; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON COLUMN public.users.is_admin IS 'Flag to indicate if user has admin privileges';
+
+
+--
+-- TOC entry 351 (class 1259 OID 30252)
 -- Name: user_stats; Type: VIEW; Schema: public; Owner: postgres
 --
 
@@ -5780,7 +6348,7 @@
 ALTER VIEW public.user_stats OWNER TO postgres;
 
 --
--- TOC entry 310 (class 1259 OID 18131)
+-- TOC entry 361 (class 1259 OID 57373)
 -- Name: webhook_dead_letter_queue; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5800,29 +6368,35 @@
 ALTER TABLE public.webhook_dead_letter_queue OWNER TO postgres;
 
 --
--- TOC entry 312 (class 1259 OID 22096)
+-- TOC entry 6000 (class 0 OID 0)
+-- Dependencies: 361
+-- Name: TABLE webhook_dead_letter_queue; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON TABLE public.webhook_dead_letter_queue IS 'Dead letter queue for failed webhooks after max retries';
+
+
+--
+-- TOC entry 376 (class 1259 OID 72666)
 -- Name: webhook_logs; Type: TABLE; Schema: public; Owner: postgres
 --
 
 CREATE TABLE public.webhook_logs (
     id uuid DEFAULT gen_random_uuid() NOT NULL,
-    webhook_type text NOT NULL,
-    event_type text,
-    event_id text,
+    event_type character varying(255) NOT NULL,
+    event_id character varying(255),
+    status character varying(50) NOT NULL,
     payload jsonb,
-    processed boolean DEFAULT false,
-    processing_time_ms integer,
     error_message text,
-    retry_count integer DEFAULT 0,
-    created_at timestamp with time zone DEFAULT now(),
-    processed_at timestamp with time zone
+    created_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
+    updated_at timestamp with time zone DEFAULT timezone('utc'::text, now()) NOT NULL
 );
 
 
 ALTER TABLE public.webhook_logs OWNER TO postgres;
 
 --
--- TOC entry 311 (class 1259 OID 18139)
+-- TOC entry 360 (class 1259 OID 57359)
 -- Name: webhook_retry_queue; Type: TABLE; Schema: public; Owner: postgres
 --
 
@@ -5838,14 +6412,24 @@
     next_retry_at timestamp with time zone,
     status character varying(50) DEFAULT 'pending'::character varying,
     created_at timestamp with time zone DEFAULT now(),
-    updated_at timestamp with time zone DEFAULT now()
+    updated_at timestamp with time zone DEFAULT now(),
+    CONSTRAINT webhook_retry_queue_status_check CHECK (((status)::text = ANY ((ARRAY['pending'::character varying, 'processing'::character varying, 'failed'::character varying, 'completed'::character varying])::text[])))
 );
 
 
 ALTER TABLE public.webhook_retry_queue OWNER TO postgres;
 
 --
--- TOC entry 265 (class 1259 OID 17253)
+-- TOC entry 6003 (class 0 OID 0)
+-- Dependencies: 360
+-- Name: TABLE webhook_retry_queue; Type: COMMENT; Schema: public; Owner: postgres
+--
+
+COMMENT ON TABLE public.webhook_retry_queue IS 'Queue for webhook retries with exponential backoff';
+
+
+--
+-- TOC entry 328 (class 1259 OID 17220)
 -- Name: messages; Type: TABLE; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -5865,7 +6449,7 @@
 ALTER TABLE realtime.messages OWNER TO supabase_realtime_admin;
 
 --
--- TOC entry 313 (class 1259 OID 25545)
+-- TOC entry 379 (class 1259 OID 73871)
 -- Name: messages_2025_07_12; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -5884,7 +6468,7 @@
 ALTER TABLE realtime.messages_2025_07_12 OWNER TO supabase_admin;
 
 --
--- TOC entry 314 (class 1259 OID 26874)
+-- TOC entry 380 (class 1259 OID 74996)
 -- Name: messages_2025_07_13; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -5903,7 +6487,7 @@
 ALTER TABLE realtime.messages_2025_07_13 OWNER TO supabase_admin;
 
 --
--- TOC entry 319 (class 1259 OID 28597)
+-- TOC entry 385 (class 1259 OID 76317)
 -- Name: messages_2025_07_14; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -5922,7 +6506,7 @@
 ALTER TABLE realtime.messages_2025_07_14 OWNER TO supabase_admin;
 
 --
--- TOC entry 320 (class 1259 OID 29946)
+-- TOC entry 387 (class 1259 OID 78552)
 -- Name: messages_2025_07_15; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -5941,7 +6525,7 @@
 ALTER TABLE realtime.messages_2025_07_15 OWNER TO supabase_admin;
 
 --
--- TOC entry 321 (class 1259 OID 31064)
+-- TOC entry 388 (class 1259 OID 78563)
 -- Name: messages_2025_07_16; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -5960,7 +6544,7 @@
 ALTER TABLE realtime.messages_2025_07_16 OWNER TO supabase_admin;
 
 --
--- TOC entry 327 (class 1259 OID 32418)
+-- TOC entry 391 (class 1259 OID 80826)
 -- Name: messages_2025_07_17; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -5979,7 +6563,7 @@
 ALTER TABLE realtime.messages_2025_07_17 OWNER TO supabase_admin;
 
 --
--- TOC entry 330 (class 1259 OID 33946)
+-- TOC entry 395 (class 1259 OID 82399)
 -- Name: messages_2025_07_18; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -5998,7 +6582,7 @@
 ALTER TABLE realtime.messages_2025_07_18 OWNER TO supabase_admin;
 
 --
--- TOC entry 257 (class 1259 OID 17000)
+-- TOC entry 320 (class 1259 OID 17007)
 -- Name: schema_migrations; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6011,7 +6595,7 @@
 ALTER TABLE realtime.schema_migrations OWNER TO supabase_admin;
 
 --
--- TOC entry 262 (class 1259 OID 17107)
+-- TOC entry 325 (class 1259 OID 17065)
 -- Name: subscription; Type: TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6029,7 +6613,7 @@
 ALTER TABLE realtime.subscription OWNER TO supabase_admin;
 
 --
--- TOC entry 261 (class 1259 OID 17106)
+-- TOC entry 324 (class 1259 OID 17064)
 -- Name: subscription_id_seq; Type: SEQUENCE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6044,7 +6628,7 @@
 
 
 --
--- TOC entry 240 (class 1259 OID 16544)
+-- TOC entry 303 (class 1259 OID 16533)
 -- Name: buckets; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -6065,8 +6649,8 @@
 ALTER TABLE storage.buckets OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 5869 (class 0 OID 0)
--- Dependencies: 240
+-- TOC entry 6016 (class 0 OID 0)
+-- Dependencies: 303
 -- Name: COLUMN buckets.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -6074,7 +6658,7 @@
 
 
 --
--- TOC entry 242 (class 1259 OID 16586)
+-- TOC entry 305 (class 1259 OID 16575)
 -- Name: migrations; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -6089,7 +6673,7 @@
 ALTER TABLE storage.migrations OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 241 (class 1259 OID 16559)
+-- TOC entry 304 (class 1259 OID 16548)
 -- Name: objects; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -6112,8 +6696,8 @@
 ALTER TABLE storage.objects OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 5871 (class 0 OID 0)
--- Dependencies: 241
+-- TOC entry 6018 (class 0 OID 0)
+-- Dependencies: 304
 -- Name: COLUMN objects.owner; Type: COMMENT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -6121,7 +6705,7 @@
 
 
 --
--- TOC entry 258 (class 1259 OID 17037)
+-- TOC entry 321 (class 1259 OID 17013)
 -- Name: s3_multipart_uploads; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -6141,7 +6725,7 @@
 ALTER TABLE storage.s3_multipart_uploads OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 259 (class 1259 OID 17051)
+-- TOC entry 322 (class 1259 OID 17027)
 -- Name: s3_multipart_uploads_parts; Type: TABLE; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -6162,7 +6746,7 @@
 ALTER TABLE storage.s3_multipart_uploads_parts OWNER TO supabase_storage_admin;
 
 --
--- TOC entry 266 (class 1259 OID 17270)
+-- TOC entry 347 (class 1259 OID 28924)
 -- Name: schema_migrations; Type: TABLE; Schema: supabase_migrations; Owner: postgres
 --
 
@@ -6178,7 +6762,20 @@
 ALTER TABLE supabase_migrations.schema_migrations OWNER TO postgres;
 
 --
--- TOC entry 4035 (class 0 OID 0)
+-- TOC entry 348 (class 1259 OID 28931)
+-- Name: seed_files; Type: TABLE; Schema: supabase_migrations; Owner: postgres
+--
+
+CREATE TABLE supabase_migrations.seed_files (
+    path text NOT NULL,
+    hash text NOT NULL
+);
+
+
+ALTER TABLE supabase_migrations.seed_files OWNER TO postgres;
+
+--
+-- TOC entry 4112 (class 0 OID 0)
 -- Name: messages_2025_07_12; Type: TABLE ATTACH; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6186,7 +6783,7 @@
 
 
 --
--- TOC entry 4036 (class 0 OID 0)
+-- TOC entry 4113 (class 0 OID 0)
 -- Name: messages_2025_07_13; Type: TABLE ATTACH; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6194,7 +6791,7 @@
 
 
 --
--- TOC entry 4037 (class 0 OID 0)
+-- TOC entry 4114 (class 0 OID 0)
 -- Name: messages_2025_07_14; Type: TABLE ATTACH; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6202,7 +6799,7 @@
 
 
 --
--- TOC entry 4038 (class 0 OID 0)
+-- TOC entry 4115 (class 0 OID 0)
 -- Name: messages_2025_07_15; Type: TABLE ATTACH; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6210,7 +6807,7 @@
 
 
 --
--- TOC entry 4039 (class 0 OID 0)
+-- TOC entry 4116 (class 0 OID 0)
 -- Name: messages_2025_07_16; Type: TABLE ATTACH; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6218,7 +6815,7 @@
 
 
 --
--- TOC entry 4040 (class 0 OID 0)
+-- TOC entry 4117 (class 0 OID 0)
 -- Name: messages_2025_07_17; Type: TABLE ATTACH; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6226,7 +6823,7 @@
 
 
 --
--- TOC entry 4041 (class 0 OID 0)
+-- TOC entry 4118 (class 0 OID 0)
 -- Name: messages_2025_07_18; Type: TABLE ATTACH; Schema: realtime; Owner: supabase_admin
 --
 
@@ -6234,7 +6831,7 @@
 
 
 --
--- TOC entry 4051 (class 2604 OID 16508)
+-- TOC entry 4128 (class 2604 OID 16497)
 -- Name: refresh_tokens id; Type: DEFAULT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6242,7 +6839,7 @@
 
 
 --
--- TOC entry 4474 (class 2606 OID 16825)
+-- TOC entry 4572 (class 2606 OID 16801)
 -- Name: mfa_amr_claims amr_id_pk; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6251,7 +6848,7 @@
 
 
 --
--- TOC entry 4432 (class 2606 OID 16529)
+-- TOC entry 4530 (class 2606 OID 16518)
 -- Name: audit_log_entries audit_log_entries_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6260,7 +6857,7 @@
 
 
 --
--- TOC entry 4496 (class 2606 OID 16931)
+-- TOC entry 4594 (class 2606 OID 16907)
 -- Name: flow_state flow_state_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6269,7 +6866,7 @@
 
 
 --
--- TOC entry 4453 (class 2606 OID 16949)
+-- TOC entry 4551 (class 2606 OID 16925)
 -- Name: identities identities_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6278,7 +6875,7 @@
 
 
 --
--- TOC entry 4455 (class 2606 OID 16959)
+-- TOC entry 4553 (class 2606 OID 16935)
 -- Name: identities identities_provider_id_provider_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6287,7 +6884,7 @@
 
 
 --
--- TOC entry 4430 (class 2606 OID 16522)
+-- TOC entry 4528 (class 2606 OID 16511)
 -- Name: instances instances_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6296,7 +6893,7 @@
 
 
 --
--- TOC entry 4476 (class 2606 OID 16818)
+-- TOC entry 4574 (class 2606 OID 16794)
 -- Name: mfa_amr_claims mfa_amr_claims_session_id_authentication_method_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6305,7 +6902,7 @@
 
 
 --
--- TOC entry 4472 (class 2606 OID 16806)
+-- TOC entry 4570 (class 2606 OID 16782)
 -- Name: mfa_challenges mfa_challenges_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6314,7 +6911,7 @@
 
 
 --
--- TOC entry 4464 (class 2606 OID 16999)
+-- TOC entry 4562 (class 2606 OID 16975)
 -- Name: mfa_factors mfa_factors_last_challenged_at_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6323,7 +6920,7 @@
 
 
 --
--- TOC entry 4466 (class 2606 OID 16793)
+-- TOC entry 4564 (class 2606 OID 16769)
 -- Name: mfa_factors mfa_factors_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6332,7 +6929,7 @@
 
 
 --
--- TOC entry 4500 (class 2606 OID 16984)
+-- TOC entry 4598 (class 2606 OID 16960)
 -- Name: one_time_tokens one_time_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6341,7 +6938,7 @@
 
 
 --
--- TOC entry 4424 (class 2606 OID 16512)
+-- TOC entry 4522 (class 2606 OID 16501)
 -- Name: refresh_tokens refresh_tokens_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6350,7 +6947,7 @@
 
 
 --
--- TOC entry 4427 (class 2606 OID 16736)
+-- TOC entry 4525 (class 2606 OID 16711)
 -- Name: refresh_tokens refresh_tokens_token_unique; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6359,7 +6956,7 @@
 
 
 --
--- TOC entry 4485 (class 2606 OID 16865)
+-- TOC entry 4583 (class 2606 OID 16841)
 -- Name: saml_providers saml_providers_entity_id_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6368,7 +6965,7 @@
 
 
 --
--- TOC entry 4487 (class 2606 OID 16863)
+-- TOC entry 4585 (class 2606 OID 16839)
 -- Name: saml_providers saml_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6377,7 +6974,7 @@
 
 
 --
--- TOC entry 4492 (class 2606 OID 16879)
+-- TOC entry 4590 (class 2606 OID 16855)
 -- Name: saml_relay_states saml_relay_states_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6386,7 +6983,7 @@
 
 
 --
--- TOC entry 4435 (class 2606 OID 16535)
+-- TOC entry 4533 (class 2606 OID 16524)
 -- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6395,7 +6992,7 @@
 
 
 --
--- TOC entry 4459 (class 2606 OID 16757)
+-- TOC entry 4557 (class 2606 OID 16732)
 -- Name: sessions sessions_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6404,7 +7001,7 @@
 
 
 --
--- TOC entry 4482 (class 2606 OID 16846)
+-- TOC entry 4580 (class 2606 OID 16822)
 -- Name: sso_domains sso_domains_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6413,7 +7010,7 @@
 
 
 --
--- TOC entry 4478 (class 2606 OID 16837)
+-- TOC entry 4576 (class 2606 OID 16813)
 -- Name: sso_providers sso_providers_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6422,7 +7019,7 @@
 
 
 --
--- TOC entry 4417 (class 2606 OID 16919)
+-- TOC entry 4515 (class 2606 OID 16895)
 -- Name: users users_phone_key; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6431,7 +7028,7 @@
 
 
 --
--- TOC entry 4419 (class 2606 OID 16499)
+-- TOC entry 4517 (class 2606 OID 16488)
 -- Name: users users_pkey; Type: CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -6440,7 +7037,7 @@
 
 
 --
--- TOC entry 4613 (class 2606 OID 17530)
+-- TOC entry 4797 (class 2606 OID 30462)
 -- Name: beta_waitlist beta_waitlist_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6449,7 +7046,7 @@
 
 
 --
--- TOC entry 4615 (class 2606 OID 17532)
+-- TOC entry 4799 (class 2606 OID 30460)
 -- Name: beta_waitlist beta_waitlist_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6458,7 +7055,7 @@
 
 
 --
--- TOC entry 4706 (class 2606 OID 18152)
+-- TOC entry 4849 (class 2606 OID 60854)
 -- Name: bot_recordings bot_recordings_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6467,7 +7064,7 @@
 
 
 --
--- TOC entry 4708 (class 2606 OID 18200)
+-- TOC entry 4851 (class 2606 OID 60856)
 -- Name: bot_recordings bot_recordings_session_id_bot_id_recording_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6476,7 +7073,7 @@
 
 
 --
--- TOC entry 4713 (class 2606 OID 18202)
+-- TOC entry 4834 (class 2606 OID 53894)
 -- Name: bot_usage_tracking bot_usage_tracking_bot_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6485,7 +7082,7 @@
 
 
 --
--- TOC entry 4715 (class 2606 OID 18154)
+-- TOC entry 4836 (class 2606 OID 53892)
 -- Name: bot_usage_tracking bot_usage_tracking_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6494,7 +7091,7 @@
 
 
 --
--- TOC entry 4722 (class 2606 OID 18156)
+-- TOC entry 4890 (class 2606 OID 64403)
 -- Name: calendar_auto_join_logs calendar_auto_join_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6503,7 +7100,7 @@
 
 
 --
--- TOC entry 4726 (class 2606 OID 18158)
+-- TOC entry 4865 (class 2606 OID 64276)
 -- Name: calendar_connections calendar_connections_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6512,7 +7109,7 @@
 
 
 --
--- TOC entry 4728 (class 2606 OID 18204)
+-- TOC entry 4867 (class 2606 OID 64278)
 -- Name: calendar_connections calendar_connections_recall_calendar_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6521,7 +7118,7 @@
 
 
 --
--- TOC entry 4730 (class 2606 OID 18206)
+-- TOC entry 4869 (class 2606 OID 64280)
 -- Name: calendar_connections calendar_connections_user_id_provider_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6530,7 +7127,7 @@
 
 
 --
--- TOC entry 4734 (class 2606 OID 18208)
+-- TOC entry 4873 (class 2606 OID 64305)
 -- Name: calendar_events calendar_events_calendar_connection_id_external_event_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6539,7 +7136,7 @@
 
 
 --
--- TOC entry 4736 (class 2606 OID 18160)
+-- TOC entry 4875 (class 2606 OID 64303)
 -- Name: calendar_events calendar_events_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6548,7 +7145,7 @@
 
 
 --
--- TOC entry 4743 (class 2606 OID 18162)
+-- TOC entry 4886 (class 2606 OID 64346)
 -- Name: calendar_preferences calendar_preferences_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6557,7 +7154,7 @@
 
 
 --
--- TOC entry 4745 (class 2606 OID 18210)
+-- TOC entry 4888 (class 2606 OID 64348)
 -- Name: calendar_preferences calendar_preferences_user_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6566,7 +7163,7 @@
 
 
 --
--- TOC entry 4747 (class 2606 OID 18164)
+-- TOC entry 4882 (class 2606 OID 64324)
 -- Name: calendar_webhooks calendar_webhooks_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6575,7 +7172,7 @@
 
 
 --
--- TOC entry 4751 (class 2606 OID 18166)
+-- TOC entry 4908 (class 2606 OID 66877)
 -- Name: collaborative_action_items collaborative_action_items_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6584,7 +7181,7 @@
 
 
 --
--- TOC entry 4757 (class 2606 OID 18168)
+-- TOC entry 4904 (class 2606 OID 66850)
 -- Name: comment_mentions comment_mentions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6593,7 +7190,7 @@
 
 
 --
--- TOC entry 4762 (class 2606 OID 18170)
+-- TOC entry 4810 (class 2606 OID 49169)
 -- Name: conversation_links conversation_links_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6602,7 +7199,7 @@
 
 
 --
--- TOC entry 4765 (class 2606 OID 18212)
+-- TOC entry 4813 (class 2606 OID 49171)
 -- Name: conversation_links conversation_links_unique; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6611,7 +7208,7 @@
 
 
 --
--- TOC entry 4864 (class 2606 OID 32218)
+-- TOC entry 4971 (class 2606 OID 76290)
 -- Name: custom_reports custom_reports_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6620,7 +7217,7 @@
 
 
 --
--- TOC entry 4620 (class 2606 OID 17534)
+-- TOC entry 4681 (class 2606 OID 17437)
 -- Name: documents documents_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6629,7 +7226,7 @@
 
 
 --
--- TOC entry 4869 (class 2606 OID 32247)
+-- TOC entry 4935 (class 2606 OID 73819)
 -- Name: email_notifications email_notifications_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6638,7 +7235,7 @@
 
 
 --
--- TOC entry 4904 (class 2606 OID 35402)
+-- TOC entry 5004 (class 2606 OID 81257)
 -- Name: embedding_queue embedding_queue_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6647,7 +7244,7 @@
 
 
 --
--- TOC entry 4906 (class 2606 OID 35419)
+-- TOC entry 5007 (class 2606 OID 81259)
 -- Name: embedding_queue embedding_queue_table_name_record_id_embedding_column_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6656,7 +7253,7 @@
 
 
 --
--- TOC entry 4627 (class 2606 OID 17536)
+-- TOC entry 4701 (class 2606 OID 17491)
 -- Name: guidance guidance_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6665,7 +7262,7 @@
 
 
 --
--- TOC entry 4900 (class 2606 OID 33916)
+-- TOC entry 5002 (class 2606 OID 80881)
 -- Name: integration_exports integration_exports_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6674,7 +7271,7 @@
 
 
 --
--- TOC entry 4892 (class 2606 OID 33892)
+-- TOC entry 4994 (class 2606 OID 80857)
 -- Name: integration_settings integration_settings_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6683,7 +7280,7 @@
 
 
 --
--- TOC entry 4894 (class 2606 OID 33894)
+-- TOC entry 4996 (class 2606 OID 80859)
 -- Name: integration_settings integration_settings_user_id_provider_organization_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6692,7 +7289,7 @@
 
 
 --
--- TOC entry 4770 (class 2606 OID 18172)
+-- TOC entry 4826 (class 2606 OID 52626)
 -- Name: meeting_metadata meeting_metadata_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6701,7 +7298,7 @@
 
 
 --
--- TOC entry 4773 (class 2606 OID 18174)
+-- TOC entry 4895 (class 2606 OID 64431)
 -- Name: meeting_notifications meeting_notifications_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6710,7 +7307,7 @@
 
 
 --
--- TOC entry 4599 (class 2606 OID 17538)
+-- TOC entry 4791 (class 2606 OID 30236)
 -- Name: monthly_usage_cache monthly_usage_cache_organization_id_user_id_month_year_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6719,7 +7316,7 @@
 
 
 --
--- TOC entry 4601 (class 2606 OID 17540)
+-- TOC entry 4793 (class 2606 OID 30234)
 -- Name: monthly_usage_cache monthly_usage_cache_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6728,7 +7325,7 @@
 
 
 --
--- TOC entry 4603 (class 2606 OID 18520)
+-- TOC entry 4795 (class 2606 OID 60797)
 -- Name: monthly_usage_cache monthly_usage_cache_unique; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6737,7 +7334,7 @@
 
 
 --
--- TOC entry 4638 (class 2606 OID 17542)
+-- TOC entry 4653 (class 2606 OID 17329)
 -- Name: organization_invitations organization_invitations_invitation_token_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6746,7 +7343,7 @@
 
 
 --
--- TOC entry 4640 (class 2606 OID 17544)
+-- TOC entry 4655 (class 2606 OID 17331)
 -- Name: organization_invitations organization_invitations_organization_id_email_status_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6755,7 +7352,7 @@
 
 
 --
--- TOC entry 4642 (class 2606 OID 17547)
+-- TOC entry 4657 (class 2606 OID 17327)
 -- Name: organization_invitations organization_invitations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6764,7 +7361,7 @@
 
 
 --
--- TOC entry 4549 (class 2606 OID 17549)
+-- TOC entry 4644 (class 2606 OID 17301)
 -- Name: organization_members organization_members_organization_id_user_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6773,7 +7370,7 @@
 
 
 --
--- TOC entry 4551 (class 2606 OID 17551)
+-- TOC entry 4646 (class 2606 OID 17299)
 -- Name: organization_members organization_members_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6782,7 +7379,7 @@
 
 
 --
--- TOC entry 4541 (class 2606 OID 17553)
+-- TOC entry 4636 (class 2606 OID 17278)
 -- Name: organizations organizations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6791,7 +7388,7 @@
 
 
 --
--- TOC entry 4543 (class 2606 OID 17555)
+-- TOC entry 4638 (class 2606 OID 17280)
 -- Name: organizations organizations_slug_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6800,7 +7397,7 @@
 
 
 --
--- TOC entry 4558 (class 2606 OID 17557)
+-- TOC entry 4721 (class 2606 OID 17573)
 -- Name: plans plans_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6809,7 +7406,7 @@
 
 
 --
--- TOC entry 4560 (class 2606 OID 17559)
+-- TOC entry 4723 (class 2606 OID 17571)
 -- Name: plans plans_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6818,7 +7415,7 @@
 
 
 --
--- TOC entry 4648 (class 2606 OID 17561)
+-- TOC entry 4774 (class 2606 OID 27379)
 -- Name: prep_checklist prep_checklist_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6827,7 +7424,7 @@
 
 
 --
--- TOC entry 4777 (class 2606 OID 18176)
+-- TOC entry 4821 (class 2606 OID 51497)
 -- Name: recall_ai_webhooks recall_ai_webhooks_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6836,7 +7433,7 @@
 
 
 --
--- TOC entry 4885 (class 2606 OID 32302)
+-- TOC entry 4969 (class 2606 OID 76232)
 -- Name: referral_audit_logs referral_audit_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6845,7 +7442,7 @@
 
 
 --
--- TOC entry 4856 (class 2606 OID 26963)
+-- TOC entry 4987 (class 2606 OID 79703)
 -- Name: referral_fraud_checks referral_fraud_checks_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6854,7 +7451,7 @@
 
 
 --
--- TOC entry 4783 (class 2606 OID 18178)
+-- TOC entry 4918 (class 2606 OID 66912)
 -- Name: report_activity report_activity_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6863,7 +7460,7 @@
 
 
 --
--- TOC entry 4786 (class 2606 OID 18180)
+-- TOC entry 4926 (class 2606 OID 66969)
 -- Name: report_bookmarks report_bookmarks_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6872,7 +7469,7 @@
 
 
 --
--- TOC entry 4788 (class 2606 OID 18214)
+-- TOC entry 4928 (class 2606 OID 66971)
 -- Name: report_bookmarks report_bookmarks_session_id_user_id_section_id_title_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6881,7 +7478,7 @@
 
 
 --
--- TOC entry 4793 (class 2606 OID 18182)
+-- TOC entry 4923 (class 2606 OID 66935)
 -- Name: report_collaborators report_collaborators_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6890,7 +7487,7 @@
 
 
 --
--- TOC entry 4800 (class 2606 OID 18184)
+-- TOC entry 4902 (class 2606 OID 66823)
 -- Name: report_comments report_comments_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6899,7 +7496,7 @@
 
 
 --
--- TOC entry 4654 (class 2606 OID 17563)
+-- TOC entry 4766 (class 2606 OID 26072)
 -- Name: session_context session_context_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6908,7 +7505,7 @@
 
 
 --
--- TOC entry 4662 (class 2606 OID 17565)
+-- TOC entry 4760 (class 2606 OID 18776)
 -- Name: session_timeline_events session_timeline_events_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6917,7 +7514,7 @@
 
 
 --
--- TOC entry 4573 (class 2606 OID 17567)
+-- TOC entry 4678 (class 2606 OID 17405)
 -- Name: sessions sessions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6926,7 +7523,7 @@
 
 
 --
--- TOC entry 4806 (class 2606 OID 18186)
+-- TOC entry 4861 (class 2606 OID 62016)
 -- Name: shared_reports shared_reports_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6935,7 +7532,7 @@
 
 
 --
--- TOC entry 4808 (class 2606 OID 18216)
+-- TOC entry 4863 (class 2606 OID 62018)
 -- Name: shared_reports shared_reports_share_token_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6944,7 +7541,7 @@
 
 
 --
--- TOC entry 4814 (class 2606 OID 18188)
+-- TOC entry 4832 (class 2606 OID 52647)
 -- Name: smart_notes smart_notes_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6953,7 +7550,7 @@
 
 
 --
--- TOC entry 4819 (class 2606 OID 18190)
+-- TOC entry 4807 (class 2606 OID 38982)
 -- Name: subscription_events subscription_events_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6962,7 +7559,7 @@
 
 
 --
--- TOC entry 4671 (class 2606 OID 17569)
+-- TOC entry 4732 (class 2606 OID 17588)
 -- Name: subscriptions subscriptions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6971,16 +7568,7 @@
 
 
 --
--- TOC entry 4673 (class 2606 OID 17571)
--- Name: subscriptions subscriptions_stripe_customer_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
---
-
-ALTER TABLE ONLY public.subscriptions
-    ADD CONSTRAINT subscriptions_stripe_customer_id_key UNIQUE (stripe_customer_id);
-
-
---
--- TOC entry 4675 (class 2606 OID 17573)
+-- TOC entry 4734 (class 2606 OID 17592)
 -- Name: subscriptions subscriptions_stripe_subscription_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6989,7 +7577,7 @@
 
 
 --
--- TOC entry 4684 (class 2606 OID 17575)
+-- TOC entry 4714 (class 2606 OID 17523)
 -- Name: summaries summaries_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -6998,7 +7586,7 @@
 
 
 --
--- TOC entry 4690 (class 2606 OID 17577)
+-- TOC entry 4754 (class 2606 OID 17677)
 -- Name: system_logs system_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7007,7 +7595,7 @@
 
 
 --
--- TOC entry 4821 (class 2606 OID 18192)
+-- TOC entry 4815 (class 2606 OID 50330)
 -- Name: system_settings system_settings_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7016,7 +7604,7 @@
 
 
 --
--- TOC entry 4596 (class 2606 OID 17579)
+-- TOC entry 4665 (class 2606 OID 17373)
 -- Name: templates templates_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7025,7 +7613,7 @@
 
 
 --
--- TOC entry 4585 (class 2606 OID 17581)
+-- TOC entry 4696 (class 2606 OID 17469)
 -- Name: transcripts transcripts_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7034,7 +7622,7 @@
 
 
 --
--- TOC entry 4587 (class 2606 OID 18522)
+-- TOC entry 4698 (class 2606 OID 47945)
 -- Name: transcripts transcripts_session_sequence_unique; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7043,7 +7631,7 @@
 
 
 --
--- TOC entry 4656 (class 2606 OID 17583)
+-- TOC entry 4768 (class 2606 OID 26074)
 -- Name: session_context unique_session_context; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7052,7 +7640,25 @@
 
 
 --
--- TOC entry 4698 (class 2606 OID 17585)
+-- TOC entry 4942 (class 2606 OID 73850)
+-- Name: user_preferences unique_user_preferences; Type: CONSTRAINT; Schema: public; Owner: postgres
+--
+
+ALTER TABLE ONLY public.user_preferences
+    ADD CONSTRAINT unique_user_preferences UNIQUE (user_id);
+
+
+--
+-- TOC entry 4955 (class 2606 OID 76191)
+-- Name: user_referrals uq_referee_referrer; Type: CONSTRAINT; Schema: public; Owner: postgres
+--
+
+ALTER TABLE ONLY public.user_referrals
+    ADD CONSTRAINT uq_referee_referrer UNIQUE (referee_id, referrer_id);
+
+
+--
+-- TOC entry 4742 (class 2606 OID 17622)
 -- Name: usage_records usage_records_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7061,7 +7667,7 @@
 
 
 --
--- TOC entry 4609 (class 2606 OID 17587)
+-- TOC entry 4786 (class 2606 OID 30203)
 -- Name: usage_tracking usage_tracking_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7070,7 +7676,7 @@
 
 
 --
--- TOC entry 4611 (class 2606 OID 17589)
+-- TOC entry 4788 (class 2606 OID 30205)
 -- Name: usage_tracking usage_tracking_session_id_minute_timestamp_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7079,7 +7685,7 @@
 
 
 --
--- TOC entry 4702 (class 2606 OID 17591)
+-- TOC entry 4746 (class 2606 OID 17659)
 -- Name: user_app_sessions user_app_sessions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7088,7 +7694,7 @@
 
 
 --
--- TOC entry 4704 (class 2606 OID 17593)
+-- TOC entry 4748 (class 2606 OID 17661)
 -- Name: user_app_sessions user_app_sessions_session_token_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7097,7 +7703,7 @@
 
 
 --
--- TOC entry 4851 (class 2606 OID 26939)
+-- TOC entry 4962 (class 2606 OID 76163)
 -- Name: user_credits user_credits_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7106,7 +7712,7 @@
 
 
 --
--- TOC entry 4876 (class 2606 OID 32277)
+-- TOC entry 4944 (class 2606 OID 73848)
 -- Name: user_preferences user_preferences_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7115,16 +7721,7 @@
 
 
 --
--- TOC entry 4878 (class 2606 OID 32279)
--- Name: user_preferences user_preferences_user_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
---
-
-ALTER TABLE ONLY public.user_preferences
-    ADD CONSTRAINT user_preferences_user_id_key UNIQUE (user_id);
-
-
---
--- TOC entry 4845 (class 2606 OID 26915)
+-- TOC entry 4957 (class 2606 OID 76141)
 -- Name: user_referrals user_referrals_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7133,7 +7730,7 @@
 
 
 --
--- TOC entry 4530 (class 2606 OID 17595)
+-- TOC entry 4625 (class 2606 OID 17258)
 -- Name: users users_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7142,7 +7739,7 @@
 
 
 --
--- TOC entry 4532 (class 2606 OID 17597)
+-- TOC entry 4627 (class 2606 OID 17260)
 -- Name: users users_google_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7151,7 +7748,7 @@
 
 
 --
--- TOC entry 4534 (class 2606 OID 17599)
+-- TOC entry 4629 (class 2606 OID 17256)
 -- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7160,7 +7757,7 @@
 
 
 --
--- TOC entry 4536 (class 2606 OID 26896)
+-- TOC entry 4631 (class 2606 OID 76122)
 -- Name: users users_referral_code_key; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7169,7 +7766,7 @@
 
 
 --
--- TOC entry 4823 (class 2606 OID 18194)
+-- TOC entry 4847 (class 2606 OID 57382)
 -- Name: webhook_dead_letter_queue webhook_dead_letter_queue_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7178,7 +7775,7 @@
 
 
 --
--- TOC entry 4833 (class 2606 OID 22106)
+-- TOC entry 4933 (class 2606 OID 72675)
 -- Name: webhook_logs webhook_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7187,7 +7784,7 @@
 
 
 --
--- TOC entry 4827 (class 2606 OID 18196)
+-- TOC entry 4845 (class 2606 OID 57372)
 -- Name: webhook_retry_queue webhook_retry_queue_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -7196,7 +7793,7 @@
 
 
 --
--- TOC entry 4516 (class 2606 OID 17267)
+-- TOC entry 4614 (class 2606 OID 17234)
 -- Name: messages messages_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -7205,7 +7802,7 @@
 
 
 --
--- TOC entry 4835 (class 2606 OID 25553)
+-- TOC entry 4946 (class 2606 OID 73879)
 -- Name: messages_2025_07_12 messages_2025_07_12_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7214,7 +7811,7 @@
 
 
 --
--- TOC entry 4837 (class 2606 OID 26882)
+-- TOC entry 4948 (class 2606 OID 75004)
 -- Name: messages_2025_07_13 messages_2025_07_13_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7223,7 +7820,7 @@
 
 
 --
--- TOC entry 4858 (class 2606 OID 28605)
+-- TOC entry 4976 (class 2606 OID 76325)
 -- Name: messages_2025_07_14 messages_2025_07_14_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7232,7 +7829,7 @@
 
 
 --
--- TOC entry 4860 (class 2606 OID 29954)
+-- TOC entry 4978 (class 2606 OID 78560)
 -- Name: messages_2025_07_15 messages_2025_07_15_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7241,7 +7838,7 @@
 
 
 --
--- TOC entry 4862 (class 2606 OID 31072)
+-- TOC entry 4980 (class 2606 OID 78571)
 -- Name: messages_2025_07_16 messages_2025_07_16_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7250,7 +7847,7 @@
 
 
 --
--- TOC entry 4887 (class 2606 OID 32426)
+-- TOC entry 4989 (class 2606 OID 80834)
 -- Name: messages_2025_07_17 messages_2025_07_17_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7259,7 +7856,7 @@
 
 
 --
--- TOC entry 4902 (class 2606 OID 33954)
+-- TOC entry 5010 (class 2606 OID 82407)
 -- Name: messages_2025_07_18 messages_2025_07_18_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7268,7 +7865,7 @@
 
 
 --
--- TOC entry 4513 (class 2606 OID 17115)
+-- TOC entry 4611 (class 2606 OID 17074)
 -- Name: subscription pk_subscription; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7277,7 +7874,7 @@
 
 
 --
--- TOC entry 4505 (class 2606 OID 17004)
+-- TOC entry 4603 (class 2606 OID 17012)
 -- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: realtime; Owner: supabase_admin
 --
 
@@ -7286,7 +7883,7 @@
 
 
 --
--- TOC entry 4438 (class 2606 OID 16552)
+-- TOC entry 4536 (class 2606 OID 16541)
 -- Name: buckets buckets_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -7295,7 +7892,7 @@
 
 
 --
--- TOC entry 4445 (class 2606 OID 16593)
+-- TOC entry 4543 (class 2606 OID 16582)
 -- Name: migrations migrations_name_key; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -7304,7 +7901,7 @@
 
 
 --
--- TOC entry 4447 (class 2606 OID 16591)
+-- TOC entry 4545 (class 2606 OID 16580)
 -- Name: migrations migrations_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -7313,7 +7910,7 @@
 
 
 --
--- TOC entry 4443 (class 2606 OID 16569)
+-- TOC entry 4541 (class 2606 OID 16558)
 -- Name: objects objects_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -7322,7 +7919,7 @@
 
 
 --
--- TOC entry 4510 (class 2606 OID 17060)
+-- TOC entry 4608 (class 2606 OID 17049)
 -- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -7331,7 +7928,7 @@
 
 
 --
--- TOC entry 4508 (class 2606 OID 17045)
+-- TOC entry 4606 (class 2606 OID 17021)
 -- Name: s3_multipart_uploads s3_multipart_uploads_pkey; Type: CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -7340,7 +7937,7 @@
 
 
 --
--- TOC entry 4518 (class 2606 OID 17278)
+-- TOC entry 4776 (class 2606 OID 33008)
 -- Name: schema_migrations schema_migrations_idempotency_key_key; Type: CONSTRAINT; Schema: supabase_migrations; Owner: postgres
 --
 
@@ -7349,7 +7946,7 @@
 
 
 --
--- TOC entry 4520 (class 2606 OID 17276)
+-- TOC entry 4778 (class 2606 OID 28930)
 -- Name: schema_migrations schema_migrations_pkey; Type: CONSTRAINT; Schema: supabase_migrations; Owner: postgres
 --
 
@@ -7358,7 +7955,16 @@
 
 
 --
--- TOC entry 4433 (class 1259 OID 16530)
+-- TOC entry 4780 (class 2606 OID 28937)
+-- Name: seed_files seed_files_pkey; Type: CONSTRAINT; Schema: supabase_migrations; Owner: postgres
+--
+
+ALTER TABLE ONLY supabase_migrations.seed_files
+    ADD CONSTRAINT seed_files_pkey PRIMARY KEY (path);
+
+
+--
+-- TOC entry 4531 (class 1259 OID 16519)
 -- Name: audit_logs_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7366,7 +7972,7 @@
 
 
 --
--- TOC entry 4407 (class 1259 OID 16746)
+-- TOC entry 4505 (class 1259 OID 16721)
 -- Name: confirmation_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7374,7 +7980,7 @@
 
 
 --
--- TOC entry 4408 (class 1259 OID 16748)
+-- TOC entry 4506 (class 1259 OID 16723)
 -- Name: email_change_token_current_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7382,7 +7988,7 @@
 
 
 --
--- TOC entry 4409 (class 1259 OID 16749)
+-- TOC entry 4507 (class 1259 OID 16724)
 -- Name: email_change_token_new_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7390,7 +7996,7 @@
 
 
 --
--- TOC entry 4462 (class 1259 OID 16827)
+-- TOC entry 4560 (class 1259 OID 16803)
 -- Name: factor_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7398,7 +8004,7 @@
 
 
 --
--- TOC entry 4494 (class 1259 OID 16935)
+-- TOC entry 4592 (class 1259 OID 16911)
 -- Name: flow_state_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7406,7 +8012,7 @@
 
 
 --
--- TOC entry 4451 (class 1259 OID 16915)
+-- TOC entry 4549 (class 1259 OID 16891)
 -- Name: identities_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7414,8 +8020,8 @@
 
 
 --
--- TOC entry 5877 (class 0 OID 0)
--- Dependencies: 4451
+-- TOC entry 6024 (class 0 OID 0)
+-- Dependencies: 4549
 -- Name: INDEX identities_email_idx; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7423,7 +8029,7 @@
 
 
 --
--- TOC entry 4456 (class 1259 OID 16743)
+-- TOC entry 4554 (class 1259 OID 16718)
 -- Name: identities_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7431,7 +8037,7 @@
 
 
 --
--- TOC entry 4497 (class 1259 OID 16932)
+-- TOC entry 4595 (class 1259 OID 16908)
 -- Name: idx_auth_code; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7439,7 +8045,7 @@
 
 
 --
--- TOC entry 4498 (class 1259 OID 16933)
+-- TOC entry 4596 (class 1259 OID 16909)
 -- Name: idx_user_id_auth_method; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7447,7 +8053,7 @@
 
 
 --
--- TOC entry 4470 (class 1259 OID 16938)
+-- TOC entry 4568 (class 1259 OID 16914)
 -- Name: mfa_challenge_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7455,7 +8061,7 @@
 
 
 --
--- TOC entry 4467 (class 1259 OID 16799)
+-- TOC entry 4565 (class 1259 OID 16775)
 -- Name: mfa_factors_user_friendly_name_unique; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7463,7 +8069,7 @@
 
 
 --
--- TOC entry 4468 (class 1259 OID 16944)
+-- TOC entry 4566 (class 1259 OID 16920)
 -- Name: mfa_factors_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7471,7 +8077,7 @@
 
 
 --
--- TOC entry 4501 (class 1259 OID 16991)
+-- TOC entry 4599 (class 1259 OID 16967)
 -- Name: one_time_tokens_relates_to_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7479,7 +8085,7 @@
 
 
 --
--- TOC entry 4502 (class 1259 OID 16990)
+-- TOC entry 4600 (class 1259 OID 16966)
 -- Name: one_time_tokens_token_hash_hash_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7487,7 +8093,7 @@
 
 
 --
--- TOC entry 4503 (class 1259 OID 16992)
+-- TOC entry 4601 (class 1259 OID 16968)
 -- Name: one_time_tokens_user_id_token_type_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7495,7 +8101,7 @@
 
 
 --
--- TOC entry 4410 (class 1259 OID 16750)
+-- TOC entry 4508 (class 1259 OID 16725)
 -- Name: reauthentication_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7503,7 +8109,7 @@
 
 
 --
--- TOC entry 4411 (class 1259 OID 16747)
+-- TOC entry 4509 (class 1259 OID 16722)
 -- Name: recovery_token_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7511,7 +8117,7 @@
 
 
 --
--- TOC entry 4420 (class 1259 OID 16513)
+-- TOC entry 4518 (class 1259 OID 16502)
 -- Name: refresh_tokens_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7519,7 +8125,7 @@
 
 
 --
--- TOC entry 4421 (class 1259 OID 16514)
+-- TOC entry 4519 (class 1259 OID 16503)
 -- Name: refresh_tokens_instance_id_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7527,7 +8133,7 @@
 
 
 --
--- TOC entry 4422 (class 1259 OID 16742)
+-- TOC entry 4520 (class 1259 OID 16717)
 -- Name: refresh_tokens_parent_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7535,7 +8141,7 @@
 
 
 --
--- TOC entry 4425 (class 1259 OID 16829)
+-- TOC entry 4523 (class 1259 OID 16805)
 -- Name: refresh_tokens_session_id_revoked_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7543,7 +8149,7 @@
 
 
 --
--- TOC entry 4428 (class 1259 OID 16934)
+-- TOC entry 4526 (class 1259 OID 16910)
 -- Name: refresh_tokens_updated_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7551,7 +8157,7 @@
 
 
 --
--- TOC entry 4488 (class 1259 OID 16871)
+-- TOC entry 4586 (class 1259 OID 16847)
 -- Name: saml_providers_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7559,7 +8165,7 @@
 
 
 --
--- TOC entry 4489 (class 1259 OID 16936)
+-- TOC entry 4587 (class 1259 OID 16912)
 -- Name: saml_relay_states_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7567,7 +8173,7 @@
 
 
 --
--- TOC entry 4490 (class 1259 OID 16886)
+-- TOC entry 4588 (class 1259 OID 16862)
 -- Name: saml_relay_states_for_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7575,7 +8181,7 @@
 
 
 --
--- TOC entry 4493 (class 1259 OID 16885)
+-- TOC entry 4591 (class 1259 OID 16861)
 -- Name: saml_relay_states_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7583,7 +8189,7 @@
 
 
 --
--- TOC entry 4457 (class 1259 OID 16937)
+-- TOC entry 4555 (class 1259 OID 16913)
 -- Name: sessions_not_after_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7591,7 +8197,7 @@
 
 
 --
--- TOC entry 4460 (class 1259 OID 16828)
+-- TOC entry 4558 (class 1259 OID 16804)
 -- Name: sessions_user_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7599,7 +8205,7 @@
 
 
 --
--- TOC entry 4480 (class 1259 OID 16853)
+-- TOC entry 4578 (class 1259 OID 16829)
 -- Name: sso_domains_domain_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7607,7 +8213,7 @@
 
 
 --
--- TOC entry 4483 (class 1259 OID 16852)
+-- TOC entry 4581 (class 1259 OID 16828)
 -- Name: sso_domains_sso_provider_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7615,7 +8221,7 @@
 
 
 --
--- TOC entry 4479 (class 1259 OID 16838)
+-- TOC entry 4577 (class 1259 OID 16814)
 -- Name: sso_providers_resource_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7623,7 +8229,7 @@
 
 
 --
--- TOC entry 4469 (class 1259 OID 16997)
+-- TOC entry 4567 (class 1259 OID 16973)
 -- Name: unique_phone_factor_per_user; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7631,7 +8237,7 @@
 
 
 --
--- TOC entry 4461 (class 1259 OID 16826)
+-- TOC entry 4559 (class 1259 OID 16802)
 -- Name: user_id_created_at_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7639,7 +8245,7 @@
 
 
 --
--- TOC entry 4412 (class 1259 OID 16906)
+-- TOC entry 4510 (class 1259 OID 16882)
 -- Name: users_email_partial_key; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7647,8 +8253,8 @@
 
 
 --
--- TOC entry 5878 (class 0 OID 0)
--- Dependencies: 4412
+-- TOC entry 6025 (class 0 OID 0)
+-- Dependencies: 4510
 -- Name: INDEX users_email_partial_key; Type: COMMENT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7656,7 +8262,7 @@
 
 
 --
--- TOC entry 4413 (class 1259 OID 16744)
+-- TOC entry 4511 (class 1259 OID 16719)
 -- Name: users_instance_id_email_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7664,7 +8270,7 @@
 
 
 --
--- TOC entry 4414 (class 1259 OID 16503)
+-- TOC entry 4512 (class 1259 OID 16492)
 -- Name: users_instance_id_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7672,7 +8278,7 @@
 
 
 --
--- TOC entry 4415 (class 1259 OID 16961)
+-- TOC entry 4513 (class 1259 OID 16937)
 -- Name: users_is_anonymous_idx; Type: INDEX; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -7680,7 +8286,7 @@
 
 
 --
--- TOC entry 4760 (class 1259 OID 18477)
+-- TOC entry 4808 (class 1259 OID 49183)
 -- Name: conversation_links_linked_idx; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7688,7 +8294,7 @@
 
 
 --
--- TOC entry 4763 (class 1259 OID 18478)
+-- TOC entry 4811 (class 1259 OID 49182)
 -- Name: conversation_links_session_idx; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7696,7 +8302,63 @@
 
 
 --
--- TOC entry 4723 (class 1259 OID 18461)
+-- TOC entry 5005 (class 1259 OID 81260)
+-- Name: embedding_queue_status_idx; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX embedding_queue_status_idx ON public.embedding_queue USING btree (status, created_at);
+
+
+--
+-- TOC entry 5008 (class 1259 OID 81261)
+-- Name: embedding_queue_user_idx; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX embedding_queue_user_idx ON public.embedding_queue USING btree (user_id);
+
+
+--
+-- TOC entry 4963 (class 1259 OID 76256)
+-- Name: idx_audit_logs_created_at; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_audit_logs_created_at ON public.referral_audit_logs USING btree (created_at DESC);
+
+
+--
+-- TOC entry 4964 (class 1259 OID 76253)
+-- Name: idx_audit_logs_event_type; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_audit_logs_event_type ON public.referral_audit_logs USING btree (event_type);
+
+
+--
+-- TOC entry 4965 (class 1259 OID 76257)
+-- Name: idx_audit_logs_referral_code; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_audit_logs_referral_code ON public.referral_audit_logs USING btree (referral_code);
+
+
+--
+-- TOC entry 4966 (class 1259 OID 76255)
+-- Name: idx_audit_logs_referrer_id; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_audit_logs_referrer_id ON public.referral_audit_logs USING btree (referrer_id);
+
+
+--
+-- TOC entry 4967 (class 1259 OID 76254)
+-- Name: idx_audit_logs_user_id; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_audit_logs_user_id ON public.referral_audit_logs USING btree (user_id);
+
+
+--
+-- TOC entry 4891 (class 1259 OID 64420)
 -- Name: idx_auto_join_logs_event; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7704,7 +8366,7 @@
 
 
 --
--- TOC entry 4724 (class 1259 OID 18462)
+-- TOC entry 4892 (class 1259 OID 64419)
 -- Name: idx_auto_join_logs_user_time; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7712,7 +8374,7 @@
 
 
 --
--- TOC entry 4616 (class 1259 OID 17600)
+-- TOC entry 4800 (class 1259 OID 30465)
 -- Name: idx_beta_waitlist_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7720,7 +8382,7 @@
 
 
 --
--- TOC entry 4617 (class 1259 OID 17601)
+-- TOC entry 4801 (class 1259 OID 30463)
 -- Name: idx_beta_waitlist_email; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7728,7 +8390,7 @@
 
 
 --
--- TOC entry 4618 (class 1259 OID 17602)
+-- TOC entry 4802 (class 1259 OID 30464)
 -- Name: idx_beta_waitlist_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7736,7 +8398,7 @@
 
 
 --
--- TOC entry 4709 (class 1259 OID 18453)
+-- TOC entry 4852 (class 1259 OID 60863)
 -- Name: idx_bot_recordings_bot_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7744,7 +8406,7 @@
 
 
 --
--- TOC entry 4710 (class 1259 OID 18454)
+-- TOC entry 4853 (class 1259 OID 60862)
 -- Name: idx_bot_recordings_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7752,7 +8414,7 @@
 
 
 --
--- TOC entry 4711 (class 1259 OID 18455)
+-- TOC entry 4854 (class 1259 OID 60864)
 -- Name: idx_bot_recordings_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7760,7 +8422,7 @@
 
 
 --
--- TOC entry 4716 (class 1259 OID 18456)
+-- TOC entry 4837 (class 1259 OID 53913)
 -- Name: idx_bot_usage_tracking_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7768,7 +8430,7 @@
 
 
 --
--- TOC entry 4717 (class 1259 OID 18457)
+-- TOC entry 4838 (class 1259 OID 53911)
 -- Name: idx_bot_usage_tracking_org_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7776,7 +8438,7 @@
 
 
 --
--- TOC entry 4718 (class 1259 OID 18458)
+-- TOC entry 4839 (class 1259 OID 53912)
 -- Name: idx_bot_usage_tracking_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7784,7 +8446,7 @@
 
 
 --
--- TOC entry 4719 (class 1259 OID 18459)
+-- TOC entry 4840 (class 1259 OID 53914)
 -- Name: idx_bot_usage_tracking_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7792,7 +8454,7 @@
 
 
 --
--- TOC entry 4720 (class 1259 OID 18460)
+-- TOC entry 4841 (class 1259 OID 53910)
 -- Name: idx_bot_usage_tracking_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7800,7 +8462,7 @@
 
 
 --
--- TOC entry 4731 (class 1259 OID 18463)
+-- TOC entry 4870 (class 1259 OID 64355)
 -- Name: idx_calendar_connections_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7808,7 +8470,7 @@
 
 
 --
--- TOC entry 4732 (class 1259 OID 18464)
+-- TOC entry 4871 (class 1259 OID 64354)
 -- Name: idx_calendar_connections_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7816,7 +8478,7 @@
 
 
 --
--- TOC entry 4737 (class 1259 OID 18465)
+-- TOC entry 4876 (class 1259 OID 64392)
 -- Name: idx_calendar_events_auto_join; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7824,7 +8486,7 @@
 
 
 --
--- TOC entry 4738 (class 1259 OID 26663)
+-- TOC entry 4877 (class 1259 OID 74990)
 -- Name: idx_calendar_events_auto_join_enabled; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7832,7 +8494,7 @@
 
 
 --
--- TOC entry 4739 (class 1259 OID 18466)
+-- TOC entry 4878 (class 1259 OID 64356)
 -- Name: idx_calendar_events_connection_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7840,7 +8502,7 @@
 
 
 --
--- TOC entry 4740 (class 1259 OID 18467)
+-- TOC entry 4879 (class 1259 OID 64358)
 -- Name: idx_calendar_events_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7848,7 +8510,7 @@
 
 
 --
--- TOC entry 4741 (class 1259 OID 18468)
+-- TOC entry 4880 (class 1259 OID 64357)
 -- Name: idx_calendar_events_start_time; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7856,7 +8518,7 @@
 
 
 --
--- TOC entry 4748 (class 1259 OID 18469)
+-- TOC entry 4883 (class 1259 OID 64359)
 -- Name: idx_calendar_webhooks_connection_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7864,7 +8526,7 @@
 
 
 --
--- TOC entry 4749 (class 1259 OID 18470)
+-- TOC entry 4884 (class 1259 OID 64360)
 -- Name: idx_calendar_webhooks_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7872,7 +8534,7 @@
 
 
 --
--- TOC entry 4752 (class 1259 OID 18471)
+-- TOC entry 4909 (class 1259 OID 66899)
 -- Name: idx_collaborative_action_items_assigned_to; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7880,7 +8542,7 @@
 
 
 --
--- TOC entry 4753 (class 1259 OID 18472)
+-- TOC entry 4910 (class 1259 OID 66901)
 -- Name: idx_collaborative_action_items_due_date; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7888,7 +8550,7 @@
 
 
 --
--- TOC entry 4754 (class 1259 OID 18473)
+-- TOC entry 4911 (class 1259 OID 66898)
 -- Name: idx_collaborative_action_items_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7896,7 +8558,7 @@
 
 
 --
--- TOC entry 4755 (class 1259 OID 18474)
+-- TOC entry 4912 (class 1259 OID 66900)
 -- Name: idx_collaborative_action_items_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7904,7 +8566,7 @@
 
 
 --
--- TOC entry 4758 (class 1259 OID 18475)
+-- TOC entry 4905 (class 1259 OID 66862)
 -- Name: idx_comment_mentions_is_read; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7912,7 +8574,7 @@
 
 
 --
--- TOC entry 4759 (class 1259 OID 18476)
+-- TOC entry 4906 (class 1259 OID 66861)
 -- Name: idx_comment_mentions_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7920,7 +8582,7 @@
 
 
 --
--- TOC entry 4846 (class 1259 OID 26948)
+-- TOC entry 4958 (class 1259 OID 76173)
 -- Name: idx_credit_expiry; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7928,31 +8590,7 @@
 
 
 --
--- TOC entry 4847 (class 1259 OID 26947)
--- Name: idx_credits_created_at; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_credits_created_at ON public.user_credits USING btree (created_at);
-
-
---
--- TOC entry 4848 (class 1259 OID 26946)
--- Name: idx_credits_type; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_credits_type ON public.user_credits USING btree (type);
-
-
---
--- TOC entry 4849 (class 1259 OID 26945)
--- Name: idx_credits_user_id; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_credits_user_id ON public.user_credits USING btree (user_id);
-
-
---
--- TOC entry 4865 (class 1259 OID 32231)
+-- TOC entry 4972 (class 1259 OID 76303)
 -- Name: idx_custom_reports_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7960,7 +8598,7 @@
 
 
 --
--- TOC entry 4866 (class 1259 OID 32229)
+-- TOC entry 4973 (class 1259 OID 76301)
 -- Name: idx_custom_reports_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7968,7 +8606,7 @@
 
 
 --
--- TOC entry 4867 (class 1259 OID 32230)
+-- TOC entry 4974 (class 1259 OID 76302)
 -- Name: idx_custom_reports_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7976,7 +8614,7 @@
 
 
 --
--- TOC entry 4621 (class 1259 OID 17603)
+-- TOC entry 4682 (class 1259 OID 17456)
 -- Name: idx_documents_file_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7984,7 +8622,7 @@
 
 
 --
--- TOC entry 4622 (class 1259 OID 17604)
+-- TOC entry 4683 (class 1259 OID 17455)
 -- Name: idx_documents_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -7992,7 +8630,7 @@
 
 
 --
--- TOC entry 4623 (class 1259 OID 17605)
+-- TOC entry 4684 (class 1259 OID 17457)
 -- Name: idx_documents_processing_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8000,7 +8638,7 @@
 
 
 --
--- TOC entry 4624 (class 1259 OID 17606)
+-- TOC entry 4685 (class 1259 OID 17453)
 -- Name: idx_documents_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8008,7 +8646,7 @@
 
 
 --
--- TOC entry 4625 (class 1259 OID 17607)
+-- TOC entry 4686 (class 1259 OID 17454)
 -- Name: idx_documents_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8016,7 +8654,7 @@
 
 
 --
--- TOC entry 4870 (class 1259 OID 32260)
+-- TOC entry 4936 (class 1259 OID 73833)
 -- Name: idx_email_notifications_email_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8024,7 +8662,7 @@
 
 
 --
--- TOC entry 4871 (class 1259 OID 32258)
+-- TOC entry 4937 (class 1259 OID 73830)
 -- Name: idx_email_notifications_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8032,71 +8670,23 @@
 
 
 --
--- TOC entry 4872 (class 1259 OID 32261)
+-- TOC entry 4938 (class 1259 OID 73832)
 -- Name: idx_email_notifications_status; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_email_notifications_status ON public.email_notifications USING btree (status);
-
-
---
--- TOC entry 4873 (class 1259 OID 32259)
--- Name: idx_email_notifications_user_id; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_email_notifications_user_id ON public.email_notifications USING btree (user_id);
-
-
---
--- TOC entry 4907 (class 1259 OID 35410)
--- Name: idx_embedding_queue_created_at; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_embedding_queue_created_at ON public.embedding_queue USING btree (created_at);
-
-
---
--- TOC entry 4908 (class 1259 OID 35408)
--- Name: idx_embedding_queue_status; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_embedding_queue_status ON public.embedding_queue USING btree (status);
-
-
---
--- TOC entry 4909 (class 1259 OID 35409)
--- Name: idx_embedding_queue_user_id; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_embedding_queue_user_id ON public.embedding_queue USING btree (user_id);
-
-
---
--- TOC entry 4852 (class 1259 OID 26971)
--- Name: idx_fraud_card_fingerprint; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_fraud_card_fingerprint ON public.referral_fraud_checks USING btree (card_fingerprint);
-
-
---
--- TOC entry 4853 (class 1259 OID 26969)
--- Name: idx_fraud_device_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_fraud_device_id ON public.referral_fraud_checks USING btree (device_id);
+CREATE INDEX idx_email_notifications_status ON public.email_notifications USING btree (status);
 
 
 --
--- TOC entry 4854 (class 1259 OID 26970)
--- Name: idx_fraud_ip_address; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4939 (class 1259 OID 73831)
+-- Name: idx_email_notifications_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_fraud_ip_address ON public.referral_fraud_checks USING btree (ip_address);
+CREATE INDEX idx_email_notifications_user_id ON public.email_notifications USING btree (user_id);
 
 
 --
--- TOC entry 4628 (class 1259 OID 17608)
+-- TOC entry 4702 (class 1259 OID 17507)
 -- Name: idx_guidance_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8104,7 +8694,7 @@
 
 
 --
--- TOC entry 4629 (class 1259 OID 17609)
+-- TOC entry 4703 (class 1259 OID 17509)
 -- Name: idx_guidance_triggered_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8112,7 +8702,7 @@
 
 
 --
--- TOC entry 4630 (class 1259 OID 17610)
+-- TOC entry 4704 (class 1259 OID 17508)
 -- Name: idx_guidance_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8120,7 +8710,7 @@
 
 
 --
--- TOC entry 4631 (class 1259 OID 17611)
+-- TOC entry 4705 (class 1259 OID 17510)
 -- Name: idx_guidance_was_displayed; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8128,7 +8718,7 @@
 
 
 --
--- TOC entry 4895 (class 1259 OID 33933)
+-- TOC entry 4997 (class 1259 OID 80898)
 -- Name: idx_integration_exports_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8136,7 +8726,7 @@
 
 
 --
--- TOC entry 4896 (class 1259 OID 33932)
+-- TOC entry 4998 (class 1259 OID 80897)
 -- Name: idx_integration_exports_provider; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8144,7 +8734,7 @@
 
 
 --
--- TOC entry 4897 (class 1259 OID 33931)
+-- TOC entry 4999 (class 1259 OID 80896)
 -- Name: idx_integration_exports_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8152,7 +8742,7 @@
 
 
 --
--- TOC entry 4898 (class 1259 OID 33930)
+-- TOC entry 5000 (class 1259 OID 80895)
 -- Name: idx_integration_exports_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8160,7 +8750,7 @@
 
 
 --
--- TOC entry 4888 (class 1259 OID 33928)
+-- TOC entry 4990 (class 1259 OID 80893)
 -- Name: idx_integration_settings_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8168,7 +8758,7 @@
 
 
 --
--- TOC entry 4889 (class 1259 OID 33929)
+-- TOC entry 4991 (class 1259 OID 80894)
 -- Name: idx_integration_settings_provider; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8176,7 +8766,7 @@
 
 
 --
--- TOC entry 4890 (class 1259 OID 33927)
+-- TOC entry 4992 (class 1259 OID 80892)
 -- Name: idx_integration_settings_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8184,7 +8774,7 @@
 
 
 --
--- TOC entry 4766 (class 1259 OID 18479)
+-- TOC entry 4822 (class 1259 OID 52633)
 -- Name: idx_meeting_metadata_platform; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8192,7 +8782,7 @@
 
 
 --
--- TOC entry 4767 (class 1259 OID 18480)
+-- TOC entry 4823 (class 1259 OID 52634)
 -- Name: idx_meeting_metadata_scheduled_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8200,7 +8790,7 @@
 
 
 --
--- TOC entry 4768 (class 1259 OID 18481)
+-- TOC entry 4824 (class 1259 OID 52632)
 -- Name: idx_meeting_metadata_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8208,7 +8798,7 @@
 
 
 --
--- TOC entry 4771 (class 1259 OID 18482)
+-- TOC entry 4893 (class 1259 OID 64447)
 -- Name: idx_meeting_notifications_user_unread; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8216,7 +8806,7 @@
 
 
 --
--- TOC entry 4597 (class 1259 OID 17612)
+-- TOC entry 4789 (class 1259 OID 30247)
 -- Name: idx_monthly_usage_cache_lookup; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8224,7 +8814,7 @@
 
 
 --
--- TOC entry 4632 (class 1259 OID 17613)
+-- TOC entry 4647 (class 1259 OID 17349)
 -- Name: idx_organization_invitations_email; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8232,7 +8822,7 @@
 
 
 --
--- TOC entry 4633 (class 1259 OID 17614)
+-- TOC entry 4648 (class 1259 OID 17352)
 -- Name: idx_organization_invitations_expires_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8240,7 +8830,7 @@
 
 
 --
--- TOC entry 4634 (class 1259 OID 17615)
+-- TOC entry 4649 (class 1259 OID 17348)
 -- Name: idx_organization_invitations_org_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8248,7 +8838,7 @@
 
 
 --
--- TOC entry 4635 (class 1259 OID 17616)
+-- TOC entry 4650 (class 1259 OID 17351)
 -- Name: idx_organization_invitations_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8256,7 +8846,7 @@
 
 
 --
--- TOC entry 4636 (class 1259 OID 17617)
+-- TOC entry 4651 (class 1259 OID 17350)
 -- Name: idx_organization_invitations_token; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8264,7 +8854,7 @@
 
 
 --
--- TOC entry 4544 (class 1259 OID 17618)
+-- TOC entry 4639 (class 1259 OID 17312)
 -- Name: idx_organization_members_org_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8272,7 +8862,7 @@
 
 
 --
--- TOC entry 4545 (class 1259 OID 17619)
+-- TOC entry 4640 (class 1259 OID 17314)
 -- Name: idx_organization_members_role; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8280,7 +8870,7 @@
 
 
 --
--- TOC entry 4546 (class 1259 OID 17620)
+-- TOC entry 4641 (class 1259 OID 17315)
 -- Name: idx_organization_members_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8288,7 +8878,7 @@
 
 
 --
--- TOC entry 4547 (class 1259 OID 17621)
+-- TOC entry 4642 (class 1259 OID 17313)
 -- Name: idx_organization_members_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8296,7 +8886,7 @@
 
 
 --
--- TOC entry 4537 (class 1259 OID 17622)
+-- TOC entry 4632 (class 1259 OID 17283)
 -- Name: idx_organizations_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8304,7 +8894,7 @@
 
 
 --
--- TOC entry 4538 (class 1259 OID 17623)
+-- TOC entry 4633 (class 1259 OID 17282)
 -- Name: idx_organizations_is_active; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8312,7 +8902,7 @@
 
 
 --
--- TOC entry 4539 (class 1259 OID 17624)
+-- TOC entry 4634 (class 1259 OID 17281)
 -- Name: idx_organizations_slug; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8320,7 +8910,7 @@
 
 
 --
--- TOC entry 4552 (class 1259 OID 18518)
+-- TOC entry 4715 (class 1259 OID 53936)
 -- Name: idx_plans_bot_minutes; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8328,7 +8918,7 @@
 
 
 --
--- TOC entry 4553 (class 1259 OID 17625)
+-- TOC entry 4716 (class 1259 OID 17576)
 -- Name: idx_plans_is_active; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8336,7 +8926,7 @@
 
 
 --
--- TOC entry 4554 (class 1259 OID 17626)
+-- TOC entry 4717 (class 1259 OID 17574)
 -- Name: idx_plans_name; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8344,7 +8934,7 @@
 
 
 --
--- TOC entry 4555 (class 1259 OID 17627)
+-- TOC entry 4718 (class 1259 OID 17577)
 -- Name: idx_plans_sort_order; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8352,7 +8942,7 @@
 
 
 --
--- TOC entry 4556 (class 1259 OID 17628)
+-- TOC entry 4719 (class 1259 OID 17575)
 -- Name: idx_plans_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8360,7 +8950,7 @@
 
 
 --
--- TOC entry 4643 (class 1259 OID 17629)
+-- TOC entry 4769 (class 1259 OID 27393)
 -- Name: idx_prep_checklist_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8368,7 +8958,7 @@
 
 
 --
--- TOC entry 4644 (class 1259 OID 17630)
+-- TOC entry 4770 (class 1259 OID 27391)
 -- Name: idx_prep_checklist_created_by; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8376,7 +8966,7 @@
 
 
 --
--- TOC entry 4645 (class 1259 OID 17631)
+-- TOC entry 4771 (class 1259 OID 27390)
 -- Name: idx_prep_checklist_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8384,7 +8974,7 @@
 
 
 --
--- TOC entry 4646 (class 1259 OID 17632)
+-- TOC entry 4772 (class 1259 OID 27392)
 -- Name: idx_prep_checklist_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8392,7 +8982,7 @@
 
 
 --
--- TOC entry 4774 (class 1259 OID 18483)
+-- TOC entry 4816 (class 1259 OID 51508)
 -- Name: idx_recall_ai_webhooks_processed; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8400,7 +8990,7 @@
 
 
 --
--- TOC entry 4775 (class 1259 OID 18484)
+-- TOC entry 4817 (class 1259 OID 51507)
 -- Name: idx_recall_ai_webhooks_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8408,71 +8998,71 @@
 
 
 --
--- TOC entry 4879 (class 1259 OID 32327)
--- Name: idx_referral_audit_logs_created_at; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4818 (class 1259 OID 51505)
+-- Name: idx_recall_webhooks_processed; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referral_audit_logs_created_at ON public.referral_audit_logs USING btree (created_at DESC);
+CREATE INDEX idx_recall_webhooks_processed ON public.recall_ai_webhooks USING btree (processed);
 
 
 --
--- TOC entry 4880 (class 1259 OID 32325)
--- Name: idx_referral_audit_logs_event_type; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4819 (class 1259 OID 51504)
+-- Name: idx_recall_webhooks_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referral_audit_logs_event_type ON public.referral_audit_logs USING btree (event_type);
+CREATE INDEX idx_recall_webhooks_session_id ON public.recall_ai_webhooks USING btree (session_id);
 
 
 --
--- TOC entry 4881 (class 1259 OID 32326)
--- Name: idx_referral_audit_logs_referral_code; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4981 (class 1259 OID 79712)
+-- Name: idx_referral_fraud_checks_card_fingerprint; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referral_audit_logs_referral_code ON public.referral_audit_logs USING btree (referral_code);
+CREATE INDEX idx_referral_fraud_checks_card_fingerprint ON public.referral_fraud_checks USING btree (card_fingerprint);
 
 
 --
--- TOC entry 4882 (class 1259 OID 32324)
--- Name: idx_referral_audit_logs_referrer_id; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4982 (class 1259 OID 79713)
+-- Name: idx_referral_fraud_checks_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referral_audit_logs_referrer_id ON public.referral_audit_logs USING btree (referrer_id);
+CREATE INDEX idx_referral_fraud_checks_created_at ON public.referral_fraud_checks USING btree (created_at);
 
 
 --
--- TOC entry 4883 (class 1259 OID 32323)
--- Name: idx_referral_audit_logs_user_id; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4983 (class 1259 OID 79710)
+-- Name: idx_referral_fraud_checks_device_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referral_audit_logs_user_id ON public.referral_audit_logs USING btree (user_id);
+CREATE INDEX idx_referral_fraud_checks_device_id ON public.referral_fraud_checks USING btree (device_id);
 
 
 --
--- TOC entry 4838 (class 1259 OID 26929)
--- Name: idx_referrals_created_at; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4984 (class 1259 OID 79711)
+-- Name: idx_referral_fraud_checks_ip_address; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referrals_created_at ON public.user_referrals USING btree (created_at);
+CREATE INDEX idx_referral_fraud_checks_ip_address ON public.referral_fraud_checks USING btree (ip_address);
 
 
 --
--- TOC entry 4839 (class 1259 OID 26927)
--- Name: idx_referrals_referrer; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4985 (class 1259 OID 79709)
+-- Name: idx_referral_fraud_checks_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referrals_referrer ON public.user_referrals USING btree (referrer_user_id);
+CREATE INDEX idx_referral_fraud_checks_user_id ON public.referral_fraud_checks USING btree (user_id);
 
 
 --
--- TOC entry 4840 (class 1259 OID 26928)
--- Name: idx_referrals_status; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4949 (class 1259 OID 76192)
+-- Name: idx_referrals_status_date; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_referrals_status ON public.user_referrals USING btree (status);
+CREATE INDEX idx_referrals_status_date ON public.user_referrals USING btree (status, created_at DESC);
 
 
 --
--- TOC entry 4778 (class 1259 OID 18485)
+-- TOC entry 4913 (class 1259 OID 66926)
 -- Name: idx_report_activity_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8480,7 +9070,7 @@
 
 
 --
--- TOC entry 4779 (class 1259 OID 18486)
+-- TOC entry 4914 (class 1259 OID 66923)
 -- Name: idx_report_activity_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8488,7 +9078,7 @@
 
 
 --
--- TOC entry 4780 (class 1259 OID 18487)
+-- TOC entry 4915 (class 1259 OID 66925)
 -- Name: idx_report_activity_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8496,7 +9086,7 @@
 
 
 --
--- TOC entry 4781 (class 1259 OID 18488)
+-- TOC entry 4916 (class 1259 OID 66924)
 -- Name: idx_report_activity_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8504,7 +9094,7 @@
 
 
 --
--- TOC entry 4784 (class 1259 OID 18489)
+-- TOC entry 4924 (class 1259 OID 66982)
 -- Name: idx_report_bookmarks_session_user; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8512,7 +9102,7 @@
 
 
 --
--- TOC entry 4789 (class 1259 OID 18490)
+-- TOC entry 4919 (class 1259 OID 66956)
 -- Name: idx_report_collaborators_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8520,7 +9110,7 @@
 
 
 --
--- TOC entry 4790 (class 1259 OID 18491)
+-- TOC entry 4920 (class 1259 OID 66958)
 -- Name: idx_report_collaborators_unique; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8528,7 +9118,7 @@
 
 
 --
--- TOC entry 4791 (class 1259 OID 18492)
+-- TOC entry 4921 (class 1259 OID 66957)
 -- Name: idx_report_collaborators_user_email; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8536,7 +9126,7 @@
 
 
 --
--- TOC entry 4794 (class 1259 OID 18493)
+-- TOC entry 4896 (class 1259 OID 66842)
 -- Name: idx_report_comments_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8544,7 +9134,7 @@
 
 
 --
--- TOC entry 4795 (class 1259 OID 18494)
+-- TOC entry 4897 (class 1259 OID 67030)
 -- Name: idx_report_comments_guest_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8552,7 +9142,7 @@
 
 
 --
--- TOC entry 4796 (class 1259 OID 18495)
+-- TOC entry 4898 (class 1259 OID 66841)
 -- Name: idx_report_comments_parent_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8560,7 +9150,7 @@
 
 
 --
--- TOC entry 4797 (class 1259 OID 18496)
+-- TOC entry 4899 (class 1259 OID 66839)
 -- Name: idx_report_comments_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8568,7 +9158,7 @@
 
 
 --
--- TOC entry 4798 (class 1259 OID 18497)
+-- TOC entry 4900 (class 1259 OID 66840)
 -- Name: idx_report_comments_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8576,7 +9166,7 @@
 
 
 --
--- TOC entry 4649 (class 1259 OID 17633)
+-- TOC entry 4761 (class 1259 OID 26092)
 -- Name: idx_session_context_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8584,7 +9174,7 @@
 
 
 --
--- TOC entry 4650 (class 1259 OID 17634)
+-- TOC entry 4762 (class 1259 OID 26093)
 -- Name: idx_session_context_processing_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8592,7 +9182,7 @@
 
 
 --
--- TOC entry 4651 (class 1259 OID 17635)
+-- TOC entry 4763 (class 1259 OID 26090)
 -- Name: idx_session_context_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8600,7 +9190,7 @@
 
 
 --
--- TOC entry 4652 (class 1259 OID 17636)
+-- TOC entry 4764 (class 1259 OID 26091)
 -- Name: idx_session_context_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8608,7 +9198,7 @@
 
 
 --
--- TOC entry 4657 (class 1259 OID 17637)
+-- TOC entry 4755 (class 1259 OID 18783)
 -- Name: idx_session_timeline_events_event_timestamp; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8616,7 +9206,7 @@
 
 
 --
--- TOC entry 4658 (class 1259 OID 17638)
+-- TOC entry 4756 (class 1259 OID 18785)
 -- Name: idx_session_timeline_events_importance; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8624,7 +9214,7 @@
 
 
 --
--- TOC entry 4659 (class 1259 OID 17639)
+-- TOC entry 4757 (class 1259 OID 18782)
 -- Name: idx_session_timeline_events_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8632,7 +9222,7 @@
 
 
 --
--- TOC entry 4660 (class 1259 OID 17640)
+-- TOC entry 4758 (class 1259 OID 18784)
 -- Name: idx_session_timeline_events_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8640,7 +9230,7 @@
 
 
 --
--- TOC entry 4561 (class 1259 OID 17641)
+-- TOC entry 4666 (class 1259 OID 17425)
 -- Name: idx_sessions_conversation_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8648,7 +9238,7 @@
 
 
 --
--- TOC entry 4562 (class 1259 OID 17642)
+-- TOC entry 4667 (class 1259 OID 17424)
 -- Name: idx_sessions_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8656,23 +9246,23 @@
 
 
 --
--- TOC entry 4563 (class 1259 OID 35426)
--- Name: idx_sessions_embedding_generated_at; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4668 (class 1259 OID 17422)
+-- Name: idx_sessions_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_sessions_embedding_generated_at ON public.sessions USING btree (embedding_generated_at);
+CREATE INDEX idx_sessions_organization_id ON public.sessions USING btree (organization_id);
 
 
 --
--- TOC entry 4564 (class 1259 OID 17643)
--- Name: idx_sessions_organization_id; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4669 (class 1259 OID 76277)
+-- Name: idx_sessions_participants; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_sessions_organization_id ON public.sessions USING btree (organization_id);
+CREATE INDEX idx_sessions_participants ON public.sessions USING gin (participants);
 
 
 --
--- TOC entry 4565 (class 1259 OID 18511)
+-- TOC entry 4670 (class 1259 OID 51503)
 -- Name: idx_sessions_recall_bot_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8680,7 +9270,7 @@
 
 
 --
--- TOC entry 4566 (class 1259 OID 18512)
+-- TOC entry 4671 (class 1259 OID 60817)
 -- Name: idx_sessions_recall_recording_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8688,7 +9278,7 @@
 
 
 --
--- TOC entry 4567 (class 1259 OID 18513)
+-- TOC entry 4672 (class 1259 OID 59650)
 -- Name: idx_sessions_recall_sdk_upload_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8696,7 +9286,7 @@
 
 
 --
--- TOC entry 4568 (class 1259 OID 17644)
+-- TOC entry 4673 (class 1259 OID 17423)
 -- Name: idx_sessions_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8704,7 +9294,7 @@
 
 
 --
--- TOC entry 4569 (class 1259 OID 18514)
+-- TOC entry 4674 (class 1259 OID 56201)
 -- Name: idx_sessions_summary_processed_index; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8712,15 +9302,7 @@
 
 
 --
--- TOC entry 4570 (class 1259 OID 35424)
--- Name: idx_sessions_title_embedding; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_sessions_title_embedding ON public.sessions USING ivfflat (title_embedding public.vector_cosine_ops) WITH (lists='100');
-
-
---
--- TOC entry 4571 (class 1259 OID 17645)
+-- TOC entry 4675 (class 1259 OID 17421)
 -- Name: idx_sessions_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8728,7 +9310,7 @@
 
 
 --
--- TOC entry 4801 (class 1259 OID 18498)
+-- TOC entry 4855 (class 1259 OID 62032)
 -- Name: idx_shared_reports_expires_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8736,7 +9318,7 @@
 
 
 --
--- TOC entry 4802 (class 1259 OID 18499)
+-- TOC entry 4856 (class 1259 OID 62031)
 -- Name: idx_shared_reports_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8744,7 +9326,15 @@
 
 
 --
--- TOC entry 4803 (class 1259 OID 18500)
+-- TOC entry 4857 (class 1259 OID 76278)
+-- Name: idx_shared_reports_share_with_participants; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_shared_reports_share_with_participants ON public.shared_reports USING btree (share_with_participants) WHERE (share_with_participants = true);
+
+
+--
+-- TOC entry 4858 (class 1259 OID 62029)
 -- Name: idx_shared_reports_token; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8752,7 +9342,7 @@
 
 
 --
--- TOC entry 4804 (class 1259 OID 18501)
+-- TOC entry 4859 (class 1259 OID 62030)
 -- Name: idx_shared_reports_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8760,7 +9350,7 @@
 
 
 --
--- TOC entry 4809 (class 1259 OID 18502)
+-- TOC entry 4827 (class 1259 OID 52664)
 -- Name: idx_smart_notes_category; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8768,7 +9358,7 @@
 
 
 --
--- TOC entry 4810 (class 1259 OID 18503)
+-- TOC entry 4828 (class 1259 OID 52666)
 -- Name: idx_smart_notes_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8776,7 +9366,7 @@
 
 
 --
--- TOC entry 4811 (class 1259 OID 18504)
+-- TOC entry 4829 (class 1259 OID 52665)
 -- Name: idx_smart_notes_importance; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8784,7 +9374,7 @@
 
 
 --
--- TOC entry 4812 (class 1259 OID 18505)
+-- TOC entry 4830 (class 1259 OID 52663)
 -- Name: idx_smart_notes_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8792,7 +9382,7 @@
 
 
 --
--- TOC entry 4815 (class 1259 OID 18506)
+-- TOC entry 4803 (class 1259 OID 39000)
 -- Name: idx_subscription_events_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8800,7 +9390,7 @@
 
 
 --
--- TOC entry 4816 (class 1259 OID 18507)
+-- TOC entry 4804 (class 1259 OID 38999)
 -- Name: idx_subscription_events_subscription_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8808,7 +9398,7 @@
 
 
 --
--- TOC entry 4817 (class 1259 OID 18508)
+-- TOC entry 4805 (class 1259 OID 38998)
 -- Name: idx_subscription_events_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8816,7 +9406,7 @@
 
 
 --
--- TOC entry 4663 (class 1259 OID 17647)
+-- TOC entry 4724 (class 1259 OID 17613)
 -- Name: idx_subscriptions_current_period; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8824,7 +9414,7 @@
 
 
 --
--- TOC entry 4664 (class 1259 OID 17648)
+-- TOC entry 4725 (class 1259 OID 17608)
 -- Name: idx_subscriptions_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8832,7 +9422,7 @@
 
 
 --
--- TOC entry 4665 (class 1259 OID 17649)
+-- TOC entry 4726 (class 1259 OID 17610)
 -- Name: idx_subscriptions_plan_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8840,7 +9430,7 @@
 
 
 --
--- TOC entry 4666 (class 1259 OID 17650)
+-- TOC entry 4727 (class 1259 OID 17612)
 -- Name: idx_subscriptions_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8848,7 +9438,7 @@
 
 
 --
--- TOC entry 4667 (class 1259 OID 17651)
+-- TOC entry 4728 (class 1259 OID 17611)
 -- Name: idx_subscriptions_stripe_customer; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8856,7 +9446,7 @@
 
 
 --
--- TOC entry 4668 (class 1259 OID 17652)
+-- TOC entry 4729 (class 1259 OID 17609)
 -- Name: idx_subscriptions_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8864,7 +9454,7 @@
 
 
 --
--- TOC entry 4669 (class 1259 OID 18701)
+-- TOC entry 4730 (class 1259 OID 39020)
 -- Name: idx_subscriptions_user_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8872,23 +9462,7 @@
 
 
 --
--- TOC entry 4676 (class 1259 OID 35425)
--- Name: idx_summaries_content_embedding; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_summaries_content_embedding ON public.summaries USING ivfflat (content_embedding public.vector_cosine_ops) WITH (lists='100');
-
-
---
--- TOC entry 4677 (class 1259 OID 35427)
--- Name: idx_summaries_embedding_generated_at; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_summaries_embedding_generated_at ON public.summaries USING btree (embedding_generated_at);
-
-
---
--- TOC entry 4678 (class 1259 OID 17653)
+-- TOC entry 4706 (class 1259 OID 17543)
 -- Name: idx_summaries_marked_done; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8896,7 +9470,7 @@
 
 
 --
--- TOC entry 4679 (class 1259 OID 17654)
+-- TOC entry 4707 (class 1259 OID 17541)
 -- Name: idx_summaries_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8904,7 +9478,7 @@
 
 
 --
--- TOC entry 4680 (class 1259 OID 17655)
+-- TOC entry 4708 (class 1259 OID 17539)
 -- Name: idx_summaries_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8912,7 +9486,7 @@
 
 
 --
--- TOC entry 4681 (class 1259 OID 17656)
+-- TOC entry 4709 (class 1259 OID 17542)
 -- Name: idx_summaries_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8920,7 +9494,7 @@
 
 
 --
--- TOC entry 4682 (class 1259 OID 17657)
+-- TOC entry 4710 (class 1259 OID 17540)
 -- Name: idx_summaries_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8928,7 +9502,7 @@
 
 
 --
--- TOC entry 4685 (class 1259 OID 17658)
+-- TOC entry 4749 (class 1259 OID 17689)
 -- Name: idx_system_logs_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8936,7 +9510,7 @@
 
 
 --
--- TOC entry 4686 (class 1259 OID 17659)
+-- TOC entry 4750 (class 1259 OID 17688)
 -- Name: idx_system_logs_level; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8944,7 +9518,7 @@
 
 
 --
--- TOC entry 4687 (class 1259 OID 17660)
+-- TOC entry 4751 (class 1259 OID 17691)
 -- Name: idx_system_logs_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8952,7 +9526,7 @@
 
 
 --
--- TOC entry 4688 (class 1259 OID 17661)
+-- TOC entry 4752 (class 1259 OID 17690)
 -- Name: idx_system_logs_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8960,7 +9534,7 @@
 
 
 --
--- TOC entry 4589 (class 1259 OID 17662)
+-- TOC entry 4658 (class 1259 OID 17386)
 -- Name: idx_templates_conversation_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8968,7 +9542,7 @@
 
 
 --
--- TOC entry 4590 (class 1259 OID 17663)
+-- TOC entry 4659 (class 1259 OID 17388)
 -- Name: idx_templates_is_organization; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8976,7 +9550,7 @@
 
 
 --
--- TOC entry 4591 (class 1259 OID 17664)
+-- TOC entry 4660 (class 1259 OID 17389)
 -- Name: idx_templates_is_public; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8984,7 +9558,7 @@
 
 
 --
--- TOC entry 4592 (class 1259 OID 17665)
+-- TOC entry 4661 (class 1259 OID 17387)
 -- Name: idx_templates_is_system; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -8992,7 +9566,7 @@
 
 
 --
--- TOC entry 4593 (class 1259 OID 17666)
+-- TOC entry 4662 (class 1259 OID 17385)
 -- Name: idx_templates_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9000,7 +9574,7 @@
 
 
 --
--- TOC entry 4594 (class 1259 OID 17667)
+-- TOC entry 4663 (class 1259 OID 17384)
 -- Name: idx_templates_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9008,31 +9582,15 @@
 
 
 --
--- TOC entry 4574 (class 1259 OID 17668)
--- Name: idx_transcripts_audio_timestamp; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_transcripts_audio_timestamp ON public.transcripts USING btree (session_id, audio_timestamp_ms);
-
-
---
--- TOC entry 4575 (class 1259 OID 17669)
+-- TOC entry 4687 (class 1259 OID 28724)
 -- Name: idx_transcripts_client_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
 CREATE INDEX idx_transcripts_client_id ON public.transcripts USING btree (client_id);
-
-
---
--- TOC entry 4576 (class 1259 OID 17670)
--- Name: idx_transcripts_client_timestamp; Type: INDEX; Schema: public; Owner: postgres
---
-
-CREATE INDEX idx_transcripts_client_timestamp ON public.transcripts USING btree (client_timestamp);
 
 
 --
--- TOC entry 4577 (class 1259 OID 17671)
+-- TOC entry 4688 (class 1259 OID 28939)
 -- Name: idx_transcripts_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9040,7 +9598,7 @@
 
 
 --
--- TOC entry 4578 (class 1259 OID 17672)
+-- TOC entry 4689 (class 1259 OID 17477)
 -- Name: idx_transcripts_is_final; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9048,7 +9606,7 @@
 
 
 --
--- TOC entry 4579 (class 1259 OID 18702)
+-- TOC entry 4690 (class 1259 OID 55047)
 -- Name: idx_transcripts_is_owner; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9056,7 +9614,7 @@
 
 
 --
--- TOC entry 4580 (class 1259 OID 17673)
+-- TOC entry 4691 (class 1259 OID 28894)
 -- Name: idx_transcripts_sequence; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9064,7 +9622,7 @@
 
 
 --
--- TOC entry 4581 (class 1259 OID 17674)
+-- TOC entry 4692 (class 1259 OID 17475)
 -- Name: idx_transcripts_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9072,7 +9630,7 @@
 
 
 --
--- TOC entry 4582 (class 1259 OID 17675)
+-- TOC entry 4693 (class 1259 OID 28938)
 -- Name: idx_transcripts_session_sequence; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9080,7 +9638,7 @@
 
 
 --
--- TOC entry 4583 (class 1259 OID 17676)
+-- TOC entry 4694 (class 1259 OID 17476)
 -- Name: idx_transcripts_start_time; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9088,7 +9646,7 @@
 
 
 --
--- TOC entry 4691 (class 1259 OID 17677)
+-- TOC entry 4735 (class 1259 OID 17647)
 -- Name: idx_usage_records_billing_period; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9096,7 +9654,7 @@
 
 
 --
--- TOC entry 4692 (class 1259 OID 17678)
+-- TOC entry 4736 (class 1259 OID 17643)
 -- Name: idx_usage_records_organization_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9104,7 +9662,7 @@
 
 
 --
--- TOC entry 4693 (class 1259 OID 17679)
+-- TOC entry 4737 (class 1259 OID 17646)
 -- Name: idx_usage_records_session_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9112,7 +9670,7 @@
 
 
 --
--- TOC entry 4694 (class 1259 OID 17680)
+-- TOC entry 4738 (class 1259 OID 17645)
 -- Name: idx_usage_records_subscription_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9120,7 +9678,7 @@
 
 
 --
--- TOC entry 4695 (class 1259 OID 17681)
+-- TOC entry 4739 (class 1259 OID 17648)
 -- Name: idx_usage_records_usage_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9128,7 +9686,7 @@
 
 
 --
--- TOC entry 4696 (class 1259 OID 17682)
+-- TOC entry 4740 (class 1259 OID 17644)
 -- Name: idx_usage_records_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9136,7 +9694,7 @@
 
 
 --
--- TOC entry 4604 (class 1259 OID 17683)
+-- TOC entry 4781 (class 1259 OID 30221)
 -- Name: idx_usage_tracking_org_month; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9144,7 +9702,7 @@
 
 
 --
--- TOC entry 4605 (class 1259 OID 17684)
+-- TOC entry 4782 (class 1259 OID 30223)
 -- Name: idx_usage_tracking_session; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9152,7 +9710,7 @@
 
 
 --
--- TOC entry 4606 (class 1259 OID 18703)
+-- TOC entry 4783 (class 1259 OID 53923)
 -- Name: idx_usage_tracking_source; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9160,7 +9718,7 @@
 
 
 --
--- TOC entry 4607 (class 1259 OID 17685)
+-- TOC entry 4784 (class 1259 OID 30222)
 -- Name: idx_usage_tracking_user_month; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9168,7 +9726,7 @@
 
 
 --
--- TOC entry 4699 (class 1259 OID 17686)
+-- TOC entry 4743 (class 1259 OID 17668)
 -- Name: idx_user_app_sessions_started_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9176,7 +9734,7 @@
 
 
 --
--- TOC entry 4700 (class 1259 OID 17687)
+-- TOC entry 4744 (class 1259 OID 17667)
 -- Name: idx_user_app_sessions_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9184,7 +9742,23 @@
 
 
 --
--- TOC entry 4874 (class 1259 OID 32285)
+-- TOC entry 4959 (class 1259 OID 76183)
+-- Name: idx_user_credits_expiry_warning; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_user_credits_expiry_warning ON public.user_credits USING btree (expires_at, expiry_warning_sent) WHERE ((expires_at IS NOT NULL) AND ((type)::text = 'referral_reward'::text));
+
+
+--
+-- TOC entry 4960 (class 1259 OID 76172)
+-- Name: idx_user_credits_user; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_user_credits_user ON public.user_credits USING btree (user_id);
+
+
+--
+-- TOC entry 4940 (class 1259 OID 73856)
 -- Name: idx_user_preferences_user_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9192,23 +9766,31 @@
 
 
 --
--- TOC entry 4841 (class 1259 OID 32342)
--- Name: idx_user_referrals_referee_id; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4950 (class 1259 OID 76170)
+-- Name: idx_user_referrals_referee; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_user_referrals_referee_id ON public.user_referrals USING btree (referee_id);
+CREATE INDEX idx_user_referrals_referee ON public.user_referrals USING btree (referee_id);
 
 
 --
--- TOC entry 4842 (class 1259 OID 32341)
--- Name: idx_user_referrals_referrer_id; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4951 (class 1259 OID 76169)
+-- Name: idx_user_referrals_referrer; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_user_referrals_referrer_id ON public.user_referrals USING btree (referrer_id);
+CREATE INDEX idx_user_referrals_referrer ON public.user_referrals USING btree (referrer_id);
 
 
 --
--- TOC entry 4521 (class 1259 OID 18516)
+-- TOC entry 4952 (class 1259 OID 76171)
+-- Name: idx_user_referrals_status; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX idx_user_referrals_status ON public.user_referrals USING btree (status);
+
+
+--
+-- TOC entry 4615 (class 1259 OID 65589)
 -- Name: idx_users_acquisition_source; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9216,7 +9798,7 @@
 
 
 --
--- TOC entry 4522 (class 1259 OID 17688)
+-- TOC entry 4616 (class 1259 OID 17263)
 -- Name: idx_users_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9224,7 +9806,7 @@
 
 
 --
--- TOC entry 4523 (class 1259 OID 17689)
+-- TOC entry 4617 (class 1259 OID 17358)
 -- Name: idx_users_current_organization; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9232,7 +9814,7 @@
 
 
 --
--- TOC entry 4524 (class 1259 OID 17690)
+-- TOC entry 4618 (class 1259 OID 17261)
 -- Name: idx_users_email; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9240,7 +9822,7 @@
 
 
 --
--- TOC entry 4525 (class 1259 OID 17691)
+-- TOC entry 4619 (class 1259 OID 17262)
 -- Name: idx_users_google_id; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9248,7 +9830,7 @@
 
 
 --
--- TOC entry 4526 (class 1259 OID 18515)
+-- TOC entry 4620 (class 1259 OID 35406)
 -- Name: idx_users_is_admin; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9256,7 +9838,7 @@
 
 
 --
--- TOC entry 4527 (class 1259 OID 26902)
+-- TOC entry 4621 (class 1259 OID 76128)
 -- Name: idx_users_referral_code; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9264,47 +9846,47 @@
 
 
 --
--- TOC entry 4528 (class 1259 OID 18517)
--- Name: idx_users_use_case; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4622 (class 1259 OID 76187)
+-- Name: idx_users_referred_by; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_users_use_case ON public.users USING btree (use_case);
+CREATE INDEX idx_users_referred_by ON public.users USING btree (referred_by_user_id);
 
 
 --
--- TOC entry 4828 (class 1259 OID 22109)
--- Name: idx_webhook_logs_created_at; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4623 (class 1259 OID 65588)
+-- Name: idx_users_use_case; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_webhook_logs_created_at ON public.webhook_logs USING btree (created_at);
+CREATE INDEX idx_users_use_case ON public.users USING btree (use_case);
 
 
 --
--- TOC entry 4829 (class 1259 OID 22110)
--- Name: idx_webhook_logs_event_id; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4929 (class 1259 OID 72678)
+-- Name: idx_webhook_logs_created_at; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_webhook_logs_event_id ON public.webhook_logs USING btree (event_id) WHERE (event_id IS NOT NULL);
+CREATE INDEX idx_webhook_logs_created_at ON public.webhook_logs USING btree (created_at);
 
 
 --
--- TOC entry 4830 (class 1259 OID 22108)
--- Name: idx_webhook_logs_processed; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4930 (class 1259 OID 72676)
+-- Name: idx_webhook_logs_event_type; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_webhook_logs_processed ON public.webhook_logs USING btree (processed);
+CREATE INDEX idx_webhook_logs_event_type ON public.webhook_logs USING btree (event_type);
 
 
 --
--- TOC entry 4831 (class 1259 OID 22107)
--- Name: idx_webhook_logs_webhook_type; Type: INDEX; Schema: public; Owner: postgres
+-- TOC entry 4931 (class 1259 OID 72677)
+-- Name: idx_webhook_logs_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE INDEX idx_webhook_logs_webhook_type ON public.webhook_logs USING btree (webhook_type);
+CREATE INDEX idx_webhook_logs_status ON public.webhook_logs USING btree (status);
 
 
 --
--- TOC entry 4824 (class 1259 OID 18509)
+-- TOC entry 4842 (class 1259 OID 57389)
 -- Name: idx_webhook_retry_queue_next_retry; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9312,7 +9894,7 @@
 
 
 --
--- TOC entry 4825 (class 1259 OID 18510)
+-- TOC entry 4843 (class 1259 OID 57388)
 -- Name: idx_webhook_retry_queue_status; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9320,7 +9902,39 @@
 
 
 --
--- TOC entry 4588 (class 1259 OID 17692)
+-- TOC entry 4676 (class 1259 OID 81242)
+-- Name: sessions_embedding_generated_at_idx; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX sessions_embedding_generated_at_idx ON public.sessions USING btree (embedding_generated_at);
+
+
+--
+-- TOC entry 4679 (class 1259 OID 81240)
+-- Name: sessions_title_embedding_idx; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX sessions_title_embedding_idx ON public.sessions USING hnsw (title_embedding public.halfvec_cosine_ops);
+
+
+--
+-- TOC entry 4711 (class 1259 OID 81241)
+-- Name: summaries_content_embedding_idx; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX summaries_content_embedding_idx ON public.summaries USING hnsw (content_embedding public.halfvec_cosine_ops);
+
+
+--
+-- TOC entry 4712 (class 1259 OID 81243)
+-- Name: summaries_embedding_generated_at_idx; Type: INDEX; Schema: public; Owner: postgres
+--
+
+CREATE INDEX summaries_embedding_generated_at_idx ON public.summaries USING btree (embedding_generated_at);
+
+
+--
+-- TOC entry 4699 (class 1259 OID 28893)
 -- Name: unique_session_sequence; Type: INDEX; Schema: public; Owner: postgres
 --
 
@@ -9328,15 +9942,15 @@
 
 
 --
--- TOC entry 4843 (class 1259 OID 26926)
+-- TOC entry 4953 (class 1259 OID 76152)
 -- Name: uq_ref_completed; Type: INDEX; Schema: public; Owner: postgres
 --
 
-CREATE UNIQUE INDEX uq_ref_completed ON public.user_referrals USING btree (referee_user_id) WHERE (status = 'completed'::public.referral_status);
+CREATE UNIQUE INDEX uq_ref_completed ON public.user_referrals USING btree (referee_id, status) WHERE (status = ANY (ARRAY['completed'::public.referral_status, 'rewarded'::public.referral_status]));
 
 
 --
--- TOC entry 4511 (class 1259 OID 17268)
+-- TOC entry 4609 (class 1259 OID 17235)
 -- Name: ix_realtime_subscription_entity; Type: INDEX; Schema: realtime; Owner: supabase_admin
 --
 
@@ -9344,7 +9958,7 @@
 
 
 --
--- TOC entry 4514 (class 1259 OID 17168)
+-- TOC entry 4612 (class 1259 OID 17138)
 -- Name: subscription_subscription_id_entity_filters_key; Type: INDEX; Schema: realtime; Owner: supabase_admin
 --
 
@@ -9352,7 +9966,7 @@
 
 
 --
--- TOC entry 4436 (class 1259 OID 16558)
+-- TOC entry 4534 (class 1259 OID 16547)
 -- Name: bname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -9360,7 +9974,7 @@
 
 
 --
--- TOC entry 4439 (class 1259 OID 16580)
+-- TOC entry 4537 (class 1259 OID 16569)
 -- Name: bucketid_objname; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -9368,7 +9982,7 @@
 
 
 --
--- TOC entry 4506 (class 1259 OID 17071)
+-- TOC entry 4604 (class 1259 OID 17063)
 -- Name: idx_multipart_uploads_list; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -9376,7 +9990,7 @@
 
 
 --
--- TOC entry 4440 (class 1259 OID 17036)
+-- TOC entry 4538 (class 1259 OID 17010)
 -- Name: idx_objects_bucket_id_name; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -9384,7 +9998,7 @@
 
 
 --
--- TOC entry 4441 (class 1259 OID 16581)
+-- TOC entry 4539 (class 1259 OID 16570)
 -- Name: name_prefix_search; Type: INDEX; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -9392,7 +10006,7 @@
 
 
 --
--- TOC entry 4910 (class 0 OID 0)
+-- TOC entry 5011 (class 0 OID 0)
 -- Name: messages_2025_07_12_pkey; Type: INDEX ATTACH; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -9400,7 +10014,7 @@
 
 
 --
--- TOC entry 4911 (class 0 OID 0)
+-- TOC entry 5012 (class 0 OID 0)
 -- Name: messages_2025_07_13_pkey; Type: INDEX ATTACH; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -9408,7 +10022,7 @@
 
 
 --
--- TOC entry 4912 (class 0 OID 0)
+-- TOC entry 5013 (class 0 OID 0)
 -- Name: messages_2025_07_14_pkey; Type: INDEX ATTACH; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -9416,7 +10030,7 @@
 
 
 --
--- TOC entry 4913 (class 0 OID 0)
+-- TOC entry 5014 (class 0 OID 0)
 -- Name: messages_2025_07_15_pkey; Type: INDEX ATTACH; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -9424,7 +10038,7 @@
 
 
 --
--- TOC entry 4914 (class 0 OID 0)
+-- TOC entry 5015 (class 0 OID 0)
 -- Name: messages_2025_07_16_pkey; Type: INDEX ATTACH; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -9432,7 +10046,7 @@
 
 
 --
--- TOC entry 4915 (class 0 OID 0)
+-- TOC entry 5016 (class 0 OID 0)
 -- Name: messages_2025_07_17_pkey; Type: INDEX ATTACH; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -9440,7 +10054,7 @@
 
 
 --
--- TOC entry 4916 (class 0 OID 0)
+-- TOC entry 5017 (class 0 OID 0)
 -- Name: messages_2025_07_18_pkey; Type: INDEX ATTACH; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -9448,15 +10062,31 @@
 
 
 --
--- TOC entry 5068 (class 2620 OID 24388)
--- Name: bot_usage_tracking calculate_bot_usage_metrics_trigger; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5140 (class 2620 OID 76267)
+-- Name: users create_user_preferences_on_signup; Type: TRIGGER; Schema: auth; Owner: supabase_auth_admin
 --
 
-CREATE TRIGGER calculate_bot_usage_metrics_trigger BEFORE INSERT OR UPDATE ON public.bot_usage_tracking FOR EACH ROW EXECUTE FUNCTION public.calculate_bot_usage_metrics();
+CREATE TRIGGER create_user_preferences_on_signup AFTER INSERT ON auth.users FOR EACH ROW EXECUTE FUNCTION public.create_default_user_preferences();
 
 
 --
--- TOC entry 5062 (class 2620 OID 24391)
+-- TOC entry 5141 (class 2620 OID 76266)
+-- Name: users on_auth_user_created; Type: TRIGGER; Schema: auth; Owner: supabase_auth_admin
+--
+
+CREATE TRIGGER on_auth_user_created AFTER INSERT ON auth.users FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();
+
+
+--
+-- TOC entry 5171 (class 2620 OID 60793)
+-- Name: bot_usage_tracking auto_calculate_bot_usage; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER auto_calculate_bot_usage BEFORE INSERT OR UPDATE ON public.bot_usage_tracking FOR EACH ROW EXECUTE FUNCTION public.calculate_bot_usage_metrics();
+
+
+--
+-- TOC entry 5161 (class 2620 OID 39019)
 -- Name: subscriptions cancel_old_subscriptions_trigger; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9464,55 +10094,55 @@
 
 
 --
--- TOC entry 5042 (class 2620 OID 32290)
--- Name: users create_user_preferences_on_signup; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5148 (class 2620 OID 65707)
+-- Name: organization_members enforce_single_owner_org; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER create_user_preferences_on_signup AFTER INSERT ON public.users FOR EACH ROW EXECUTE FUNCTION public.create_user_preferences_for_new_user();
+CREATE TRIGGER enforce_single_owner_org BEFORE INSERT OR UPDATE ON public.organization_members FOR EACH ROW EXECUTE FUNCTION public.check_single_owner_org_per_user();
 
 
 --
--- TOC entry 5043 (class 2620 OID 32362)
--- Name: users generate_user_referral_code_trigger; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5144 (class 2620 OID 76185)
+-- Name: users ensure_user_has_referral_code; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER generate_user_referral_code_trigger BEFORE INSERT ON public.users FOR EACH ROW EXECUTE FUNCTION public.generate_user_referral_code();
+CREATE TRIGGER ensure_user_has_referral_code BEFORE INSERT OR UPDATE ON public.users FOR EACH ROW WHEN ((new.referral_code IS NULL)) EXECUTE FUNCTION public.generate_user_referral_code();
 
 
 --
--- TOC entry 5063 (class 2620 OID 24390)
+-- TOC entry 5162 (class 2620 OID 38973)
 -- Name: subscriptions handle_subscription_renewal_trigger; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER handle_subscription_renewal_trigger AFTER UPDATE ON public.subscriptions FOR EACH ROW EXECUTE FUNCTION public.handle_subscription_renewal();
+CREATE TRIGGER handle_subscription_renewal_trigger AFTER UPDATE ON public.subscriptions FOR EACH ROW WHEN ((old.current_period_start IS DISTINCT FROM new.current_period_start)) EXECUTE FUNCTION public.handle_subscription_renewal();
 
 
 --
--- TOC entry 5044 (class 2620 OID 32380)
--- Name: users on_auth_user_created; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5152 (class 2620 OID 81263)
+-- Name: sessions sessions_embedding_trigger; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER on_auth_user_created BEFORE INSERT ON public.users FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();
+CREATE TRIGGER sessions_embedding_trigger AFTER INSERT OR UPDATE OF title ON public.sessions FOR EACH ROW EXECUTE FUNCTION public.queue_session_embedding();
 
 
 --
--- TOC entry 5045 (class 2620 OID 26980)
--- Name: users on_user_created_referral; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5145 (class 2620 OID 76264)
+-- Name: users set_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER on_user_created_referral BEFORE INSERT ON public.users FOR EACH ROW EXECUTE FUNCTION public.handle_new_user_referral();
+CREATE TRIGGER set_updated_at BEFORE UPDATE ON public.users FOR EACH ROW EXECUTE FUNCTION public.handle_updated_at();
 
 
 --
--- TOC entry 5050 (class 2620 OID 35431)
--- Name: sessions sessions_embedding_trigger; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5183 (class 2620 OID 72681)
+-- Name: webhook_logs set_webhook_logs_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER sessions_embedding_trigger AFTER INSERT OR UPDATE OF title ON public.sessions FOR EACH ROW EXECUTE FUNCTION public.queue_session_embedding();
+CREATE TRIGGER set_webhook_logs_updated_at BEFORE UPDATE ON public.webhook_logs FOR EACH ROW EXECUTE FUNCTION public.handle_updated_at();
 
 
 --
--- TOC entry 5066 (class 2620 OID 35432)
+-- TOC entry 5158 (class 2620 OID 81265)
 -- Name: summaries summaries_embedding_trigger; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9520,7 +10150,15 @@
 
 
 --
--- TOC entry 5064 (class 2620 OID 24389)
+-- TOC entry 5176 (class 2620 OID 76275)
+-- Name: calendar_events sync_participants_on_calendar_update; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER sync_participants_on_calendar_update AFTER INSERT OR UPDATE OF attendees, session_id ON public.calendar_events FOR EACH ROW WHEN ((new.session_id IS NOT NULL)) EXECUTE FUNCTION public.sync_session_participants();
+
+
+--
+-- TOC entry 5163 (class 2620 OID 39034)
 -- Name: subscriptions sync_subscription_limits_trigger; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9528,7 +10166,7 @@
 
 
 --
--- TOC entry 5052 (class 2620 OID 17905)
+-- TOC entry 5155 (class 2620 OID 28963)
 -- Name: transcripts transcript_sequence_trigger; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9536,7 +10174,23 @@
 
 
 --
--- TOC entry 5056 (class 2620 OID 17906)
+-- TOC entry 5179 (class 2620 OID 67003)
+-- Name: report_comments trigger_log_comment_activity; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER trigger_log_comment_activity AFTER INSERT ON public.report_comments FOR EACH ROW EXECUTE FUNCTION public.log_comment_activity();
+
+
+--
+-- TOC entry 5181 (class 2620 OID 67005)
+-- Name: collaborative_action_items trigger_log_task_activity; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER trigger_log_task_activity AFTER INSERT OR UPDATE ON public.collaborative_action_items FOR EACH ROW EXECUTE FUNCTION public.log_task_activity();
+
+
+--
+-- TOC entry 5168 (class 2620 OID 30469)
 -- Name: beta_waitlist update_beta_waitlist_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9544,23 +10198,71 @@
 
 
 --
--- TOC entry 5057 (class 2620 OID 17907)
--- Name: documents update_documents_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5174 (class 2620 OID 60867)
+-- Name: bot_recordings update_bot_recordings_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER update_documents_updated_at BEFORE UPDATE ON public.documents FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();
+CREATE TRIGGER update_bot_recordings_updated_at BEFORE UPDATE ON public.bot_recordings FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();
 
 
 --
--- TOC entry 5069 (class 2620 OID 32265)
--- Name: email_notifications update_email_notifications_updated_at_trigger; Type: TRIGGER; Schema: public; Owner: postgres
+-- TOC entry 5172 (class 2620 OID 53916)
+-- Name: bot_usage_tracking update_bot_usage_tracking_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
-CREATE TRIGGER update_email_notifications_updated_at_trigger BEFORE UPDATE ON public.email_notifications FOR EACH ROW EXECUTE FUNCTION public.update_email_notifications_updated_at();
+CREATE TRIGGER update_bot_usage_tracking_updated_at BEFORE UPDATE ON public.bot_usage_tracking FOR EACH ROW EXECUTE FUNCTION public.update_bot_usage_tracking_updated_at();
 
 
 --
--- TOC entry 5058 (class 2620 OID 17908)
+-- TOC entry 5173 (class 2620 OID 60795)
+-- Name: bot_usage_tracking update_cache_on_bot_usage; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_cache_on_bot_usage AFTER INSERT OR UPDATE ON public.bot_usage_tracking FOR EACH ROW WHEN ((new.status = 'completed'::text)) EXECUTE FUNCTION public.update_monthly_usage_cache();
+
+
+--
+-- TOC entry 5175 (class 2620 OID 64373)
+-- Name: calendar_connections update_calendar_connections_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_calendar_connections_updated_at BEFORE UPDATE ON public.calendar_connections FOR EACH ROW EXECUTE FUNCTION public.update_calendar_updated_at();
+
+
+--
+-- TOC entry 5177 (class 2620 OID 64374)
+-- Name: calendar_events update_calendar_events_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_calendar_events_updated_at BEFORE UPDATE ON public.calendar_events FOR EACH ROW EXECUTE FUNCTION public.update_calendar_updated_at();
+
+
+--
+-- TOC entry 5178 (class 2620 OID 64375)
+-- Name: calendar_preferences update_calendar_preferences_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_calendar_preferences_updated_at BEFORE UPDATE ON public.calendar_preferences FOR EACH ROW EXECUTE FUNCTION public.update_calendar_updated_at();
+
+
+--
+-- TOC entry 5182 (class 2620 OID 67007)
+-- Name: collaborative_action_items update_collaborative_action_items_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_collaborative_action_items_updated_at BEFORE UPDATE ON public.collaborative_action_items FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();
+
+
+--
+-- TOC entry 5154 (class 2620 OID 17698)
+-- Name: documents update_documents_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_documents_updated_at BEFORE UPDATE ON public.documents FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();
+
+
+--
+-- TOC entry 5157 (class 2620 OID 17700)
 -- Name: guidance update_guidance_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9568,7 +10270,7 @@
 
 
 --
--- TOC entry 5071 (class 2620 OID 33940)
+-- TOC entry 5184 (class 2620 OID 80905)
 -- Name: integration_settings update_integration_settings_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9576,7 +10278,15 @@
 
 
 --
--- TOC entry 5059 (class 2620 OID 17909)
+-- TOC entry 5169 (class 2620 OID 52674)
+-- Name: meeting_metadata update_meeting_metadata_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_meeting_metadata_updated_at BEFORE UPDATE ON public.meeting_metadata FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();
+
+
+--
+-- TOC entry 5150 (class 2620 OID 17695)
 -- Name: organization_invitations update_organization_invitations_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9584,7 +10294,7 @@
 
 
 --
--- TOC entry 5048 (class 2620 OID 17910)
+-- TOC entry 5149 (class 2620 OID 17694)
 -- Name: organization_members update_organization_members_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9592,7 +10302,7 @@
 
 
 --
--- TOC entry 5047 (class 2620 OID 17911)
+-- TOC entry 5147 (class 2620 OID 17693)
 -- Name: organizations update_organizations_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9600,7 +10310,7 @@
 
 
 --
--- TOC entry 5049 (class 2620 OID 17912)
+-- TOC entry 5160 (class 2620 OID 17703)
 -- Name: plans update_plans_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9608,7 +10318,7 @@
 
 
 --
--- TOC entry 5060 (class 2620 OID 17913)
+-- TOC entry 5166 (class 2620 OID 27394)
 -- Name: prep_checklist update_prep_checklist_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9616,7 +10326,15 @@
 
 
 --
--- TOC entry 5061 (class 2620 OID 17914)
+-- TOC entry 5180 (class 2620 OID 67006)
+-- Name: report_comments update_report_comments_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_report_comments_updated_at BEFORE UPDATE ON public.report_comments FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();
+
+
+--
+-- TOC entry 5165 (class 2620 OID 26094)
 -- Name: session_context update_session_context_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9624,7 +10342,7 @@
 
 
 --
--- TOC entry 5051 (class 2620 OID 17915)
+-- TOC entry 5153 (class 2620 OID 17697)
 -- Name: sessions update_sessions_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9632,7 +10350,15 @@
 
 
 --
--- TOC entry 5065 (class 2620 OID 17916)
+-- TOC entry 5170 (class 2620 OID 52675)
+-- Name: smart_notes update_smart_notes_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
+--
+
+CREATE TRIGGER update_smart_notes_updated_at BEFORE UPDATE ON public.smart_notes FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();
+
+
+--
+-- TOC entry 5164 (class 2620 OID 17704)
 -- Name: subscriptions update_subscriptions_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9640,7 +10366,7 @@
 
 
 --
--- TOC entry 5067 (class 2620 OID 17917)
+-- TOC entry 5159 (class 2620 OID 17701)
 -- Name: summaries update_summaries_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9648,7 +10374,7 @@
 
 
 --
--- TOC entry 5054 (class 2620 OID 17918)
+-- TOC entry 5151 (class 2620 OID 17702)
 -- Name: templates update_templates_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9656,7 +10382,7 @@
 
 
 --
--- TOC entry 5053 (class 2620 OID 17919)
+-- TOC entry 5156 (class 2620 OID 17699)
 -- Name: transcripts update_transcripts_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9664,7 +10390,7 @@
 
 
 --
--- TOC entry 5055 (class 2620 OID 17920)
+-- TOC entry 5167 (class 2620 OID 35392)
 -- Name: usage_tracking update_usage_stats_trigger; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9672,15 +10398,7 @@
 
 
 --
--- TOC entry 5070 (class 2620 OID 32292)
--- Name: user_preferences update_user_preferences_updated_at_trigger; Type: TRIGGER; Schema: public; Owner: postgres
---
-
-CREATE TRIGGER update_user_preferences_updated_at_trigger BEFORE UPDATE ON public.user_preferences FOR EACH ROW EXECUTE FUNCTION public.update_user_preferences_updated_at();
-
-
---
--- TOC entry 5046 (class 2620 OID 17921)
+-- TOC entry 5146 (class 2620 OID 17696)
 -- Name: users update_users_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
 --
 
@@ -9688,7 +10406,7 @@
 
 
 --
--- TOC entry 5041 (class 2620 OID 17120)
+-- TOC entry 5143 (class 2620 OID 17093)
 -- Name: subscription tr_check_filters; Type: TRIGGER; Schema: realtime; Owner: supabase_admin
 --
 
@@ -9696,7 +10414,7 @@
 
 
 --
--- TOC entry 5040 (class 2620 OID 17024)
+-- TOC entry 5142 (class 2620 OID 16995)
 -- Name: objects update_objects_updated_at; Type: TRIGGER; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -9704,7 +10422,7 @@
 
 
 --
--- TOC entry 4919 (class 2606 OID 16730)
+-- TOC entry 5020 (class 2606 OID 16705)
 -- Name: identities identities_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9713,7 +10431,7 @@
 
 
 --
--- TOC entry 4923 (class 2606 OID 16819)
+-- TOC entry 5024 (class 2606 OID 16795)
 -- Name: mfa_amr_claims mfa_amr_claims_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9722,7 +10440,7 @@
 
 
 --
--- TOC entry 4922 (class 2606 OID 16807)
+-- TOC entry 5023 (class 2606 OID 16783)
 -- Name: mfa_challenges mfa_challenges_auth_factor_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9731,7 +10449,7 @@
 
 
 --
--- TOC entry 4921 (class 2606 OID 16794)
+-- TOC entry 5022 (class 2606 OID 16770)
 -- Name: mfa_factors mfa_factors_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9740,7 +10458,7 @@
 
 
 --
--- TOC entry 4928 (class 2606 OID 16985)
+-- TOC entry 5029 (class 2606 OID 16961)
 -- Name: one_time_tokens one_time_tokens_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9749,7 +10467,7 @@
 
 
 --
--- TOC entry 4917 (class 2606 OID 16763)
+-- TOC entry 5018 (class 2606 OID 16738)
 -- Name: refresh_tokens refresh_tokens_session_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9758,7 +10476,7 @@
 
 
 --
--- TOC entry 4925 (class 2606 OID 16866)
+-- TOC entry 5026 (class 2606 OID 16842)
 -- Name: saml_providers saml_providers_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9767,7 +10485,7 @@
 
 
 --
--- TOC entry 4926 (class 2606 OID 16939)
+-- TOC entry 5027 (class 2606 OID 16915)
 -- Name: saml_relay_states saml_relay_states_flow_state_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9776,7 +10494,7 @@
 
 
 --
--- TOC entry 4927 (class 2606 OID 16880)
+-- TOC entry 5028 (class 2606 OID 16856)
 -- Name: saml_relay_states saml_relay_states_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9785,7 +10503,7 @@
 
 
 --
--- TOC entry 4920 (class 2606 OID 16758)
+-- TOC entry 5021 (class 2606 OID 16733)
 -- Name: sessions sessions_user_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9794,7 +10512,7 @@
 
 
 --
--- TOC entry 4924 (class 2606 OID 16847)
+-- TOC entry 5025 (class 2606 OID 16823)
 -- Name: sso_domains sso_domains_sso_provider_id_fkey; Type: FK CONSTRAINT; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -9803,7 +10521,7 @@
 
 
 --
--- TOC entry 4975 (class 2606 OID 18217)
+-- TOC entry 5090 (class 2606 OID 60857)
 -- Name: bot_recordings bot_recordings_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9812,7 +10530,7 @@
 
 
 --
--- TOC entry 4976 (class 2606 OID 18222)
+-- TOC entry 5086 (class 2606 OID 53905)
 -- Name: bot_usage_tracking bot_usage_tracking_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9821,7 +10539,7 @@
 
 
 --
--- TOC entry 4977 (class 2606 OID 18227)
+-- TOC entry 5087 (class 2606 OID 53895)
 -- Name: bot_usage_tracking bot_usage_tracking_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9830,7 +10548,7 @@
 
 
 --
--- TOC entry 4978 (class 2606 OID 18232)
+-- TOC entry 5088 (class 2606 OID 53900)
 -- Name: bot_usage_tracking bot_usage_tracking_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9839,7 +10557,7 @@
 
 
 --
--- TOC entry 4979 (class 2606 OID 18237)
+-- TOC entry 5100 (class 2606 OID 64409)
 -- Name: calendar_auto_join_logs calendar_auto_join_logs_calendar_event_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9848,7 +10566,7 @@
 
 
 --
--- TOC entry 4980 (class 2606 OID 18242)
+-- TOC entry 5101 (class 2606 OID 64414)
 -- Name: calendar_auto_join_logs calendar_auto_join_logs_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9857,7 +10575,7 @@
 
 
 --
--- TOC entry 4981 (class 2606 OID 18247)
+-- TOC entry 5102 (class 2606 OID 64404)
 -- Name: calendar_auto_join_logs calendar_auto_join_logs_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9866,7 +10584,7 @@
 
 
 --
--- TOC entry 4982 (class 2606 OID 18252)
+-- TOC entry 5093 (class 2606 OID 64286)
 -- Name: calendar_connections calendar_connections_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9875,7 +10593,7 @@
 
 
 --
--- TOC entry 4983 (class 2606 OID 18257)
+-- TOC entry 5094 (class 2606 OID 64281)
 -- Name: calendar_connections calendar_connections_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9884,7 +10602,7 @@
 
 
 --
--- TOC entry 4984 (class 2606 OID 18262)
+-- TOC entry 5095 (class 2606 OID 64386)
 -- Name: calendar_events calendar_events_auto_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9893,7 +10611,7 @@
 
 
 --
--- TOC entry 4985 (class 2606 OID 18267)
+-- TOC entry 5096 (class 2606 OID 64306)
 -- Name: calendar_events calendar_events_calendar_connection_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9902,7 +10620,7 @@
 
 
 --
--- TOC entry 4986 (class 2606 OID 18272)
+-- TOC entry 5097 (class 2606 OID 64311)
 -- Name: calendar_events calendar_events_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9911,7 +10629,7 @@
 
 
 --
--- TOC entry 4987 (class 2606 OID 18277)
+-- TOC entry 5099 (class 2606 OID 64349)
 -- Name: calendar_preferences calendar_preferences_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9920,7 +10638,7 @@
 
 
 --
--- TOC entry 4988 (class 2606 OID 18282)
+-- TOC entry 5098 (class 2606 OID 64325)
 -- Name: calendar_webhooks calendar_webhooks_calendar_connection_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9929,7 +10647,7 @@
 
 
 --
--- TOC entry 4989 (class 2606 OID 18287)
+-- TOC entry 5111 (class 2606 OID 66888)
 -- Name: collaborative_action_items collaborative_action_items_assigned_to_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9938,7 +10656,7 @@
 
 
 --
--- TOC entry 4990 (class 2606 OID 18292)
+-- TOC entry 5112 (class 2606 OID 66893)
 -- Name: collaborative_action_items collaborative_action_items_completed_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9947,7 +10665,7 @@
 
 
 --
--- TOC entry 4991 (class 2606 OID 18297)
+-- TOC entry 5113 (class 2606 OID 66883)
 -- Name: collaborative_action_items collaborative_action_items_created_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9956,7 +10674,7 @@
 
 
 --
--- TOC entry 4992 (class 2606 OID 18302)
+-- TOC entry 5114 (class 2606 OID 66878)
 -- Name: collaborative_action_items collaborative_action_items_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9965,7 +10683,7 @@
 
 
 --
--- TOC entry 4993 (class 2606 OID 18307)
+-- TOC entry 5109 (class 2606 OID 66851)
 -- Name: comment_mentions comment_mentions_comment_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9974,7 +10692,7 @@
 
 
 --
--- TOC entry 4994 (class 2606 OID 18312)
+-- TOC entry 5110 (class 2606 OID 66856)
 -- Name: comment_mentions comment_mentions_mentioned_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9983,7 +10701,7 @@
 
 
 --
--- TOC entry 4995 (class 2606 OID 18317)
+-- TOC entry 5079 (class 2606 OID 49177)
 -- Name: conversation_links conversation_links_linked_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -9992,7 +10710,7 @@
 
 
 --
--- TOC entry 4996 (class 2606 OID 18322)
+-- TOC entry 5080 (class 2606 OID 49172)
 -- Name: conversation_links conversation_links_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10001,7 +10719,7 @@
 
 
 --
--- TOC entry 5026 (class 2606 OID 32219)
+-- TOC entry 5133 (class 2606 OID 76291)
 -- Name: custom_reports custom_reports_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10010,7 +10728,7 @@
 
 
 --
--- TOC entry 5027 (class 2606 OID 32224)
+-- TOC entry 5134 (class 2606 OID 76296)
 -- Name: custom_reports custom_reports_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10019,7 +10737,7 @@
 
 
 --
--- TOC entry 4947 (class 2606 OID 17693)
+-- TOC entry 5045 (class 2606 OID 17448)
 -- Name: documents documents_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10028,7 +10746,7 @@
 
 
 --
--- TOC entry 4948 (class 2606 OID 17698)
+-- TOC entry 5046 (class 2606 OID 17438)
 -- Name: documents documents_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10037,7 +10755,7 @@
 
 
 --
--- TOC entry 4949 (class 2606 OID 17703)
+-- TOC entry 5047 (class 2606 OID 17443)
 -- Name: documents documents_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10046,7 +10764,7 @@
 
 
 --
--- TOC entry 5028 (class 2606 OID 32248)
+-- TOC entry 5123 (class 2606 OID 73820)
 -- Name: email_notifications email_notifications_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10055,25 +10773,16 @@
 
 
 --
--- TOC entry 5029 (class 2606 OID 32253)
+-- TOC entry 5124 (class 2606 OID 73825)
 -- Name: email_notifications email_notifications_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.email_notifications
-    ADD CONSTRAINT email_notifications_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE CASCADE;
+    ADD CONSTRAINT email_notifications_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;
 
 
 --
--- TOC entry 5039 (class 2606 OID 35403)
--- Name: embedding_queue embedding_queue_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
---
-
-ALTER TABLE ONLY public.embedding_queue
-    ADD CONSTRAINT embedding_queue_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;
-
-
---
--- TOC entry 4956 (class 2606 OID 17708)
+-- TOC entry 5069 (class 2606 OID 27385)
 -- Name: prep_checklist fk_prep_checklist_created_by; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10082,7 +10791,7 @@
 
 
 --
--- TOC entry 4957 (class 2606 OID 17713)
+-- TOC entry 5070 (class 2606 OID 27380)
 -- Name: prep_checklist fk_prep_checklist_session_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10091,7 +10800,7 @@
 
 
 --
--- TOC entry 4950 (class 2606 OID 17718)
+-- TOC entry 5049 (class 2606 OID 17502)
 -- Name: guidance guidance_prompt_template_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10100,7 +10809,7 @@
 
 
 --
--- TOC entry 4951 (class 2606 OID 17723)
+-- TOC entry 5050 (class 2606 OID 17492)
 -- Name: guidance guidance_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10109,7 +10818,7 @@
 
 
 --
--- TOC entry 4952 (class 2606 OID 17728)
+-- TOC entry 5051 (class 2606 OID 17497)
 -- Name: guidance guidance_triggered_by_transcript_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10118,7 +10827,7 @@
 
 
 --
--- TOC entry 5037 (class 2606 OID 33922)
+-- TOC entry 5138 (class 2606 OID 80887)
 -- Name: integration_exports integration_exports_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10127,7 +10836,7 @@
 
 
 --
--- TOC entry 5038 (class 2606 OID 33917)
+-- TOC entry 5139 (class 2606 OID 80882)
 -- Name: integration_exports integration_exports_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10136,7 +10845,7 @@
 
 
 --
--- TOC entry 5035 (class 2606 OID 33900)
+-- TOC entry 5136 (class 2606 OID 80865)
 -- Name: integration_settings integration_settings_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10145,7 +10854,7 @@
 
 
 --
--- TOC entry 5036 (class 2606 OID 33895)
+-- TOC entry 5137 (class 2606 OID 80860)
 -- Name: integration_settings integration_settings_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10154,7 +10863,7 @@
 
 
 --
--- TOC entry 4997 (class 2606 OID 18327)
+-- TOC entry 5082 (class 2606 OID 52627)
 -- Name: meeting_metadata meeting_metadata_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10163,7 +10872,7 @@
 
 
 --
--- TOC entry 4998 (class 2606 OID 18332)
+-- TOC entry 5103 (class 2606 OID 64437)
 -- Name: meeting_notifications meeting_notifications_calendar_event_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10172,7 +10881,7 @@
 
 
 --
--- TOC entry 4999 (class 2606 OID 18337)
+-- TOC entry 5104 (class 2606 OID 64442)
 -- Name: meeting_notifications meeting_notifications_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10181,7 +10890,7 @@
 
 
 --
--- TOC entry 5000 (class 2606 OID 18342)
+-- TOC entry 5105 (class 2606 OID 64432)
 -- Name: meeting_notifications meeting_notifications_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10190,7 +10899,7 @@
 
 
 --
--- TOC entry 4942 (class 2606 OID 17733)
+-- TOC entry 5074 (class 2606 OID 30237)
 -- Name: monthly_usage_cache monthly_usage_cache_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10199,7 +10908,7 @@
 
 
 --
--- TOC entry 4943 (class 2606 OID 17738)
+-- TOC entry 5075 (class 2606 OID 30242)
 -- Name: monthly_usage_cache monthly_usage_cache_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10208,7 +10917,7 @@
 
 
 --
--- TOC entry 4953 (class 2606 OID 17743)
+-- TOC entry 5037 (class 2606 OID 17343)
 -- Name: organization_invitations organization_invitations_accepted_by_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10217,7 +10926,7 @@
 
 
 --
--- TOC entry 4954 (class 2606 OID 17748)
+-- TOC entry 5038 (class 2606 OID 17338)
 -- Name: organization_invitations organization_invitations_invited_by_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10226,7 +10935,7 @@
 
 
 --
--- TOC entry 4955 (class 2606 OID 17753)
+-- TOC entry 5039 (class 2606 OID 17333)
 -- Name: organization_invitations organization_invitations_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10235,7 +10944,7 @@
 
 
 --
--- TOC entry 4934 (class 2606 OID 17758)
+-- TOC entry 5035 (class 2606 OID 17302)
 -- Name: organization_members organization_members_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10244,7 +10953,7 @@
 
 
 --
--- TOC entry 4935 (class 2606 OID 17763)
+-- TOC entry 5036 (class 2606 OID 17307)
 -- Name: organization_members organization_members_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10253,7 +10962,7 @@
 
 
 --
--- TOC entry 5001 (class 2606 OID 18347)
+-- TOC entry 5081 (class 2606 OID 51498)
 -- Name: recall_ai_webhooks recall_ai_webhooks_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10262,52 +10971,52 @@
 
 
 --
--- TOC entry 5031 (class 2606 OID 32313)
+-- TOC entry 5129 (class 2606 OID 76243)
 -- Name: referral_audit_logs referral_audit_logs_referee_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.referral_audit_logs
-    ADD CONSTRAINT referral_audit_logs_referee_id_fkey FOREIGN KEY (referee_id) REFERENCES public.users(id) ON DELETE SET NULL;
+    ADD CONSTRAINT referral_audit_logs_referee_id_fkey FOREIGN KEY (referee_id) REFERENCES public.users(id);
 
 
 --
--- TOC entry 5032 (class 2606 OID 32318)
+-- TOC entry 5130 (class 2606 OID 76248)
 -- Name: referral_audit_logs referral_audit_logs_referral_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.referral_audit_logs
-    ADD CONSTRAINT referral_audit_logs_referral_id_fkey FOREIGN KEY (referral_id) REFERENCES public.user_referrals(id) ON DELETE SET NULL;
+    ADD CONSTRAINT referral_audit_logs_referral_id_fkey FOREIGN KEY (referral_id) REFERENCES public.user_referrals(id);
 
 
 --
--- TOC entry 5033 (class 2606 OID 32308)
+-- TOC entry 5131 (class 2606 OID 76238)
 -- Name: referral_audit_logs referral_audit_logs_referrer_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.referral_audit_logs
-    ADD CONSTRAINT referral_audit_logs_referrer_id_fkey FOREIGN KEY (referrer_id) REFERENCES public.users(id) ON DELETE SET NULL;
+    ADD CONSTRAINT referral_audit_logs_referrer_id_fkey FOREIGN KEY (referrer_id) REFERENCES public.users(id);
 
 
 --
--- TOC entry 5034 (class 2606 OID 32303)
+-- TOC entry 5132 (class 2606 OID 76233)
 -- Name: referral_audit_logs referral_audit_logs_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.referral_audit_logs
-    ADD CONSTRAINT referral_audit_logs_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE SET NULL;
+    ADD CONSTRAINT referral_audit_logs_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id);
 
 
 --
--- TOC entry 5025 (class 2606 OID 26964)
+-- TOC entry 5135 (class 2606 OID 79704)
 -- Name: referral_fraud_checks referral_fraud_checks_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.referral_fraud_checks
-    ADD CONSTRAINT referral_fraud_checks_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id);
+    ADD CONSTRAINT referral_fraud_checks_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE CASCADE;
 
 
 --
--- TOC entry 5002 (class 2606 OID 18352)
+-- TOC entry 5115 (class 2606 OID 66913)
 -- Name: report_activity report_activity_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10316,7 +11025,7 @@
 
 
 --
--- TOC entry 5003 (class 2606 OID 18357)
+-- TOC entry 5116 (class 2606 OID 66918)
 -- Name: report_activity report_activity_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10325,7 +11034,7 @@
 
 
 --
--- TOC entry 5004 (class 2606 OID 18362)
+-- TOC entry 5121 (class 2606 OID 66972)
 -- Name: report_bookmarks report_bookmarks_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10334,7 +11043,7 @@
 
 
 --
--- TOC entry 5005 (class 2606 OID 18367)
+-- TOC entry 5122 (class 2606 OID 66977)
 -- Name: report_bookmarks report_bookmarks_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10343,7 +11052,7 @@
 
 
 --
--- TOC entry 5006 (class 2606 OID 18372)
+-- TOC entry 5117 (class 2606 OID 66951)
 -- Name: report_collaborators report_collaborators_invited_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10352,7 +11061,7 @@
 
 
 --
--- TOC entry 5007 (class 2606 OID 18377)
+-- TOC entry 5118 (class 2606 OID 66941)
 -- Name: report_collaborators report_collaborators_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10361,7 +11070,7 @@
 
 
 --
--- TOC entry 5008 (class 2606 OID 18382)
+-- TOC entry 5119 (class 2606 OID 66936)
 -- Name: report_collaborators report_collaborators_shared_report_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10370,7 +11079,7 @@
 
 
 --
--- TOC entry 5009 (class 2606 OID 18387)
+-- TOC entry 5120 (class 2606 OID 66946)
 -- Name: report_collaborators report_collaborators_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10379,7 +11088,7 @@
 
 
 --
--- TOC entry 5010 (class 2606 OID 18392)
+-- TOC entry 5106 (class 2606 OID 66834)
 -- Name: report_comments report_comments_parent_comment_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10388,7 +11097,7 @@
 
 
 --
--- TOC entry 5011 (class 2606 OID 18397)
+-- TOC entry 5107 (class 2606 OID 66824)
 -- Name: report_comments report_comments_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10397,7 +11106,7 @@
 
 
 --
--- TOC entry 5012 (class 2606 OID 18402)
+-- TOC entry 5108 (class 2606 OID 66829)
 -- Name: report_comments report_comments_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10406,7 +11115,7 @@
 
 
 --
--- TOC entry 4958 (class 2606 OID 17768)
+-- TOC entry 5066 (class 2606 OID 26085)
 -- Name: session_context session_context_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10415,7 +11124,7 @@
 
 
 --
--- TOC entry 4959 (class 2606 OID 17773)
+-- TOC entry 5067 (class 2606 OID 26075)
 -- Name: session_context session_context_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10424,7 +11133,7 @@
 
 
 --
--- TOC entry 4960 (class 2606 OID 17778)
+-- TOC entry 5068 (class 2606 OID 26080)
 -- Name: session_context session_context_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10433,7 +11142,7 @@
 
 
 --
--- TOC entry 4961 (class 2606 OID 17783)
+-- TOC entry 5065 (class 2606 OID 18777)
 -- Name: session_timeline_events session_timeline_events_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10442,7 +11151,7 @@
 
 
 --
--- TOC entry 4936 (class 2606 OID 17788)
+-- TOC entry 5042 (class 2606 OID 17411)
 -- Name: sessions sessions_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10451,7 +11160,7 @@
 
 
 --
--- TOC entry 4937 (class 2606 OID 17793)
+-- TOC entry 5043 (class 2606 OID 17416)
 -- Name: sessions sessions_selected_template_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10460,7 +11169,7 @@
 
 
 --
--- TOC entry 4938 (class 2606 OID 17798)
+-- TOC entry 5044 (class 2606 OID 17406)
 -- Name: sessions sessions_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10469,7 +11178,7 @@
 
 
 --
--- TOC entry 5013 (class 2606 OID 18407)
+-- TOC entry 5091 (class 2606 OID 62019)
 -- Name: shared_reports shared_reports_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10478,7 +11187,7 @@
 
 
 --
--- TOC entry 5014 (class 2606 OID 18412)
+-- TOC entry 5092 (class 2606 OID 62024)
 -- Name: shared_reports shared_reports_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10487,7 +11196,7 @@
 
 
 --
--- TOC entry 5015 (class 2606 OID 18417)
+-- TOC entry 5083 (class 2606 OID 52658)
 -- Name: smart_notes smart_notes_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10496,7 +11205,7 @@
 
 
 --
--- TOC entry 5016 (class 2606 OID 18422)
+-- TOC entry 5084 (class 2606 OID 52648)
 -- Name: smart_notes smart_notes_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10505,16 +11214,16 @@
 
 
 --
--- TOC entry 5017 (class 2606 OID 18523)
+-- TOC entry 5085 (class 2606 OID 52653)
 -- Name: smart_notes smart_notes_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.smart_notes
-    ADD CONSTRAINT smart_notes_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE CASCADE;
+    ADD CONSTRAINT smart_notes_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id);
 
 
 --
--- TOC entry 5018 (class 2606 OID 18427)
+-- TOC entry 5076 (class 2606 OID 38988)
 -- Name: subscription_events subscription_events_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10523,7 +11232,7 @@
 
 
 --
--- TOC entry 5019 (class 2606 OID 18432)
+-- TOC entry 5077 (class 2606 OID 38993)
 -- Name: subscription_events subscription_events_subscription_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10532,7 +11241,7 @@
 
 
 --
--- TOC entry 5020 (class 2606 OID 18437)
+-- TOC entry 5078 (class 2606 OID 38983)
 -- Name: subscription_events subscription_events_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10541,7 +11250,7 @@
 
 
 --
--- TOC entry 4962 (class 2606 OID 17803)
+-- TOC entry 5055 (class 2606 OID 17593)
 -- Name: subscriptions subscriptions_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10550,7 +11259,7 @@
 
 
 --
--- TOC entry 4963 (class 2606 OID 17808)
+-- TOC entry 5056 (class 2606 OID 17603)
 -- Name: subscriptions subscriptions_plan_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10559,7 +11268,7 @@
 
 
 --
--- TOC entry 4964 (class 2606 OID 17813)
+-- TOC entry 5057 (class 2606 OID 17598)
 -- Name: subscriptions subscriptions_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10568,7 +11277,7 @@
 
 
 --
--- TOC entry 4965 (class 2606 OID 17818)
+-- TOC entry 5052 (class 2606 OID 17534)
 -- Name: summaries summaries_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10577,7 +11286,7 @@
 
 
 --
--- TOC entry 4966 (class 2606 OID 17823)
+-- TOC entry 5053 (class 2606 OID 17524)
 -- Name: summaries summaries_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10586,7 +11295,7 @@
 
 
 --
--- TOC entry 4967 (class 2606 OID 17828)
+-- TOC entry 5054 (class 2606 OID 17529)
 -- Name: summaries summaries_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10595,7 +11304,7 @@
 
 
 --
--- TOC entry 4968 (class 2606 OID 17833)
+-- TOC entry 5063 (class 2606 OID 17683)
 -- Name: system_logs system_logs_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10604,7 +11313,7 @@
 
 
 --
--- TOC entry 4969 (class 2606 OID 17838)
+-- TOC entry 5064 (class 2606 OID 17678)
 -- Name: system_logs system_logs_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10613,7 +11322,7 @@
 
 
 --
--- TOC entry 4940 (class 2606 OID 17843)
+-- TOC entry 5040 (class 2606 OID 17379)
 -- Name: templates templates_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10622,7 +11331,7 @@
 
 
 --
--- TOC entry 4941 (class 2606 OID 17848)
+-- TOC entry 5041 (class 2606 OID 17374)
 -- Name: templates templates_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10631,7 +11340,7 @@
 
 
 --
--- TOC entry 4939 (class 2606 OID 17853)
+-- TOC entry 5048 (class 2606 OID 17470)
 -- Name: transcripts transcripts_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10640,7 +11349,7 @@
 
 
 --
--- TOC entry 4970 (class 2606 OID 17858)
+-- TOC entry 5058 (class 2606 OID 17623)
 -- Name: usage_records usage_records_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10649,7 +11358,7 @@
 
 
 --
--- TOC entry 4971 (class 2606 OID 17863)
+-- TOC entry 5059 (class 2606 OID 17638)
 -- Name: usage_records usage_records_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10658,7 +11367,7 @@
 
 
 --
--- TOC entry 4972 (class 2606 OID 17868)
+-- TOC entry 5060 (class 2606 OID 17633)
 -- Name: usage_records usage_records_subscription_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10667,7 +11376,7 @@
 
 
 --
--- TOC entry 4973 (class 2606 OID 17873)
+-- TOC entry 5061 (class 2606 OID 17628)
 -- Name: usage_records usage_records_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10676,7 +11385,7 @@
 
 
 --
--- TOC entry 4944 (class 2606 OID 17878)
+-- TOC entry 5071 (class 2606 OID 30206)
 -- Name: usage_tracking usage_tracking_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10685,7 +11394,7 @@
 
 
 --
--- TOC entry 4945 (class 2606 OID 17883)
+-- TOC entry 5072 (class 2606 OID 30216)
 -- Name: usage_tracking usage_tracking_session_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10694,7 +11403,7 @@
 
 
 --
--- TOC entry 4946 (class 2606 OID 17888)
+-- TOC entry 5073 (class 2606 OID 30211)
 -- Name: usage_tracking usage_tracking_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10703,7 +11412,7 @@
 
 
 --
--- TOC entry 4974 (class 2606 OID 17893)
+-- TOC entry 5062 (class 2606 OID 17662)
 -- Name: user_app_sessions user_app_sessions_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10712,7 +11421,7 @@
 
 
 --
--- TOC entry 5024 (class 2606 OID 26940)
+-- TOC entry 5128 (class 2606 OID 76164)
 -- Name: user_credits user_credits_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10721,34 +11430,34 @@
 
 
 --
--- TOC entry 5030 (class 2606 OID 32280)
+-- TOC entry 5125 (class 2606 OID 73851)
 -- Name: user_preferences user_preferences_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.user_preferences
-    ADD CONSTRAINT user_preferences_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE CASCADE;
+    ADD CONSTRAINT user_preferences_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE;
 
 
 --
--- TOC entry 5022 (class 2606 OID 32348)
+-- TOC entry 5126 (class 2606 OID 76147)
 -- Name: user_referrals user_referrals_referee_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.user_referrals
-    ADD CONSTRAINT user_referrals_referee_id_fkey FOREIGN KEY (referee_id) REFERENCES public.users(id) ON DELETE CASCADE;
+    ADD CONSTRAINT user_referrals_referee_id_fkey FOREIGN KEY (referee_id) REFERENCES public.users(id);
 
 
 --
--- TOC entry 5023 (class 2606 OID 32343)
+-- TOC entry 5127 (class 2606 OID 76142)
 -- Name: user_referrals user_referrals_referrer_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
 ALTER TABLE ONLY public.user_referrals
-    ADD CONSTRAINT user_referrals_referrer_id_fkey FOREIGN KEY (referrer_id) REFERENCES public.users(id) ON DELETE CASCADE;
+    ADD CONSTRAINT user_referrals_referrer_id_fkey FOREIGN KEY (referrer_id) REFERENCES public.users(id);
 
 
 --
--- TOC entry 4932 (class 2606 OID 17898)
+-- TOC entry 5033 (class 2606 OID 17353)
 -- Name: users users_current_organization_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10757,7 +11466,7 @@
 
 
 --
--- TOC entry 4933 (class 2606 OID 26897)
+-- TOC entry 5034 (class 2606 OID 76123)
 -- Name: users users_referred_by_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10766,7 +11475,7 @@
 
 
 --
--- TOC entry 5021 (class 2606 OID 18442)
+-- TOC entry 5089 (class 2606 OID 57383)
 -- Name: webhook_dead_letter_queue webhook_dead_letter_queue_original_webhook_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
 --
 
@@ -10775,7 +11484,7 @@
 
 
 --
--- TOC entry 4918 (class 2606 OID 16570)
+-- TOC entry 5019 (class 2606 OID 16559)
 -- Name: objects objects_bucketId_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -10784,7 +11493,7 @@
 
 
 --
--- TOC entry 4929 (class 2606 OID 17046)
+-- TOC entry 5030 (class 2606 OID 17022)
 -- Name: s3_multipart_uploads s3_multipart_uploads_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -10793,7 +11502,7 @@
 
 
 --
--- TOC entry 4930 (class 2606 OID 17066)
+-- TOC entry 5031 (class 2606 OID 17058)
 -- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_bucket_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -10802,7 +11511,7 @@
 
 
 --
--- TOC entry 4931 (class 2606 OID 17061)
+-- TOC entry 5032 (class 2606 OID 17053)
 -- Name: s3_multipart_uploads_parts s3_multipart_uploads_parts_upload_id_fkey; Type: FK CONSTRAINT; Schema: storage; Owner: supabase_storage_admin
 --
 
@@ -10811,135 +11520,135 @@
 
 
 --
--- TOC entry 5226 (class 0 OID 16523)
--- Dependencies: 238
+-- TOC entry 5336 (class 0 OID 16512)
+-- Dependencies: 301
 -- Name: audit_log_entries; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.audit_log_entries ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5240 (class 0 OID 16925)
--- Dependencies: 255
+-- TOC entry 5350 (class 0 OID 16901)
+-- Dependencies: 318
 -- Name: flow_state; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.flow_state ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5231 (class 0 OID 16723)
--- Dependencies: 246
+-- TOC entry 5341 (class 0 OID 16698)
+-- Dependencies: 309
 -- Name: identities; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.identities ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5225 (class 0 OID 16516)
--- Dependencies: 237
+-- TOC entry 5335 (class 0 OID 16505)
+-- Dependencies: 300
 -- Name: instances; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.instances ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5235 (class 0 OID 16812)
--- Dependencies: 250
+-- TOC entry 5345 (class 0 OID 16788)
+-- Dependencies: 313
 -- Name: mfa_amr_claims; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.mfa_amr_claims ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5234 (class 0 OID 16800)
--- Dependencies: 249
+-- TOC entry 5344 (class 0 OID 16776)
+-- Dependencies: 312
 -- Name: mfa_challenges; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.mfa_challenges ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5233 (class 0 OID 16787)
--- Dependencies: 248
+-- TOC entry 5343 (class 0 OID 16763)
+-- Dependencies: 311
 -- Name: mfa_factors; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.mfa_factors ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5241 (class 0 OID 16975)
--- Dependencies: 256
+-- TOC entry 5351 (class 0 OID 16951)
+-- Dependencies: 319
 -- Name: one_time_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.one_time_tokens ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5224 (class 0 OID 16505)
--- Dependencies: 236
+-- TOC entry 5334 (class 0 OID 16494)
+-- Dependencies: 299
 -- Name: refresh_tokens; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.refresh_tokens ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5238 (class 0 OID 16854)
--- Dependencies: 253
+-- TOC entry 5348 (class 0 OID 16830)
+-- Dependencies: 316
 -- Name: saml_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.saml_providers ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5239 (class 0 OID 16872)
--- Dependencies: 254
+-- TOC entry 5349 (class 0 OID 16848)
+-- Dependencies: 317
 -- Name: saml_relay_states; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.saml_relay_states ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5227 (class 0 OID 16531)
--- Dependencies: 239
+-- TOC entry 5337 (class 0 OID 16520)
+-- Dependencies: 302
 -- Name: schema_migrations; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.schema_migrations ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5232 (class 0 OID 16753)
--- Dependencies: 247
+-- TOC entry 5342 (class 0 OID 16728)
+-- Dependencies: 310
 -- Name: sessions; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.sessions ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5237 (class 0 OID 16839)
--- Dependencies: 252
+-- TOC entry 5347 (class 0 OID 16815)
+-- Dependencies: 315
 -- Name: sso_domains; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.sso_domains ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5236 (class 0 OID 16830)
--- Dependencies: 251
+-- TOC entry 5346 (class 0 OID 16806)
+-- Dependencies: 314
 -- Name: sso_providers; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.sso_providers ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5223 (class 0 OID 16493)
--- Dependencies: 234
+-- TOC entry 5333 (class 0 OID 16482)
+-- Dependencies: 297
 -- Name: users; Type: ROW SECURITY; Schema: auth; Owner: supabase_auth_admin
 --
 
 ALTER TABLE auth.users ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5363 (class 3256 OID 18600)
+-- TOC entry 5466 (class 3256 OID 66996)
 -- Name: report_activity Activity inserted by authenticated users; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -10947,7 +11656,7 @@
 
 
 --
--- TOC entry 5417 (class 3256 OID 18658)
+-- TOC entry 5491 (class 3256 OID 50332)
 -- Name: system_settings Admin upsert system settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -10959,7 +11668,17 @@
 
 
 --
--- TOC entry 5415 (class 3256 OID 18656)
+-- TOC entry 5568 (class 3256 OID 79714)
+-- Name: referral_fraud_checks Admin users can manage referral fraud checks; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Admin users can manage referral fraud checks" ON public.referral_fraud_checks TO authenticated USING ((EXISTS ( SELECT 1
+   FROM public.users
+  WHERE ((users.id = auth.uid()) AND (users.is_admin = true)))));
+
+
+--
+-- TOC entry 5405 (class 3256 OID 60816)
 -- Name: system_logs Admins can delete system logs; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -10967,7 +11686,7 @@
 
 
 --
--- TOC entry 5418 (class 3256 OID 18660)
+-- TOC entry 5399 (class 3256 OID 60814)
 -- Name: system_settings Admins can delete system settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -10975,7 +11694,7 @@
 
 
 --
--- TOC entry 5419 (class 3256 OID 18661)
+-- TOC entry 5397 (class 3256 OID 60812)
 -- Name: system_settings Admins can insert system settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -10983,7 +11702,7 @@
 
 
 --
--- TOC entry 5420 (class 3256 OID 18662)
+-- TOC entry 5398 (class 3256 OID 60813)
 -- Name: system_settings Admins can update system settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -10991,7 +11710,7 @@
 
 
 --
--- TOC entry 5416 (class 3256 OID 18657)
+-- TOC entry 5404 (class 3256 OID 60815)
 -- Name: system_logs Admins can view system logs; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -10999,7 +11718,7 @@
 
 
 --
--- TOC entry 5275 (class 3256 OID 17922)
+-- TOC entry 5440 (class 3256 OID 30467)
 -- Name: beta_waitlist Allow authenticated users to read waitlist; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11007,7 +11726,7 @@
 
 
 --
--- TOC entry 5276 (class 3256 OID 17923)
+-- TOC entry 5441 (class 3256 OID 30468)
 -- Name: beta_waitlist Allow authenticated users to update waitlist; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11015,7 +11734,7 @@
 
 
 --
--- TOC entry 5277 (class 3256 OID 17924)
+-- TOC entry 5439 (class 3256 OID 30466)
 -- Name: beta_waitlist Allow public to insert waitlist entries; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11023,7 +11742,7 @@
 
 
 --
--- TOC entry 5421 (class 3256 OID 18663)
+-- TOC entry 5396 (class 3256 OID 60811)
 -- Name: system_settings Anyone can read system settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11031,7 +11750,7 @@
 
 
 --
--- TOC entry 5355 (class 3256 OID 18593)
+-- TOC entry 5484 (class 3256 OID 33055)
 -- Name: plans Anyone can view plans; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11039,7 +11758,7 @@
 
 
 --
--- TOC entry 5356 (class 3256 OID 18594)
+-- TOC entry 5535 (class 3256 OID 36589)
 -- Name: plans Authenticated users can view plans; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11047,7 +11766,7 @@
 
 
 --
--- TOC entry 5372 (class 3256 OID 18607)
+-- TOC entry 5468 (class 3256 OID 66998)
 -- Name: report_collaborators Collaborators can view their records; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11057,7 +11776,7 @@
 
 
 --
--- TOC entry 5401 (class 3256 OID 18641)
+-- TOC entry 5534 (class 3256 OID 36588)
 -- Name: subscriptions Organization members can view subscription; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11067,7 +11786,7 @@
 
 
 --
--- TOC entry 5339 (class 3256 OID 18578)
+-- TOC entry 5481 (class 3256 OID 33052)
 -- Name: organization_invitations Owners can create invitations for their organizations; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11077,7 +11796,7 @@
 
 
 --
--- TOC entry 5340 (class 3256 OID 18579)
+-- TOC entry 5483 (class 3256 OID 33054)
 -- Name: organization_invitations Owners can delete invitations for their organizations; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11087,7 +11806,7 @@
 
 
 --
--- TOC entry 5349 (class 3256 OID 18587)
+-- TOC entry 5473 (class 3256 OID 33046)
 -- Name: organizations Owners can delete their organizations; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11097,7 +11816,7 @@
 
 
 --
--- TOC entry 5342 (class 3256 OID 18580)
+-- TOC entry 5482 (class 3256 OID 33053)
 -- Name: organization_invitations Owners can update invitations for their organizations; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11107,7 +11826,7 @@
 
 
 --
--- TOC entry 5350 (class 3256 OID 18588)
+-- TOC entry 5471 (class 3256 OID 33044)
 -- Name: organizations Owners can update their organizations; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11117,7 +11836,7 @@
 
 
 --
--- TOC entry 5422 (class 3256 OID 18664)
+-- TOC entry 5490 (class 3256 OID 50331)
 -- Name: system_settings Read system settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11125,39 +11844,47 @@
 
 
 --
--- TOC entry 5285 (class 3256 OID 18529)
--- Name: bot_recordings Service role can manage all recordings; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5558 (class 3256 OID 76195)
+-- Name: user_credits Service role can manage all credits; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Service role can manage all recordings" ON public.bot_recordings USING ((auth.role() = 'service_role'::text)) WITH CHECK ((auth.role() = 'service_role'::text));
+CREATE POLICY "Service role can manage all credits" ON public.user_credits TO service_role USING (true);
 
 
 --
--- TOC entry 5300 (class 3256 OID 18536)
--- Name: calendar_events Service role can manage calendar events; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5560 (class 3256 OID 76259)
+-- Name: referral_audit_logs Service role can manage all logs; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Service role can manage calendar events" ON public.calendar_events USING (((auth.jwt() ->> 'role'::text) = 'service_role'::text));
+CREATE POLICY "Service role can manage all logs" ON public.referral_audit_logs TO service_role USING (true);
 
 
 --
--- TOC entry 5319 (class 3256 OID 32263)
--- Name: email_notifications Service role can manage email notifications; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5409 (class 3256 OID 60866)
+-- Name: bot_recordings Service role can manage all recordings; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Service role can manage email notifications" ON public.email_notifications USING (((auth.jwt() ->> 'role'::text) = 'service_role'::text));
+CREATE POLICY "Service role can manage all recordings" ON public.bot_recordings USING ((auth.role() = 'service_role'::text)) WITH CHECK ((auth.role() = 'service_role'::text));
 
 
 --
--- TOC entry 5450 (class 3256 OID 32329)
--- Name: referral_audit_logs Service role can manage referral audit logs; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5557 (class 3256 OID 76194)
+-- Name: user_referrals Service role can manage all referrals; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Service role can manage referral audit logs" ON public.referral_audit_logs USING (((auth.jwt() ->> 'role'::text) = 'service_role'::text));
+CREATE POLICY "Service role can manage all referrals" ON public.user_referrals TO service_role USING (true);
 
 
 --
--- TOC entry 5400 (class 3256 OID 18639)
+-- TOC entry 5444 (class 3256 OID 64366)
+-- Name: calendar_events Service role can manage calendar events; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Service role can manage calendar events" ON public.calendar_events USING (((auth.jwt() ->> 'role'::text) = 'service_role'::text));
+
+
+--
+-- TOC entry 5455 (class 3256 OID 39002)
 -- Name: subscription_events Service role can manage subscription events; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11165,7 +11892,7 @@
 
 
 --
--- TOC entry 5439 (class 3256 OID 22111)
+-- TOC entry 5543 (class 3256 OID 72679)
 -- Name: webhook_logs Service role can manage webhook logs; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11173,7 +11900,7 @@
 
 
 --
--- TOC entry 5284 (class 3256 OID 18542)
+-- TOC entry 5445 (class 3256 OID 64367)
 -- Name: calendar_webhooks Service role can manage webhooks; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11181,7 +11908,7 @@
 
 
 --
--- TOC entry 5373 (class 3256 OID 18608)
+-- TOC entry 5467 (class 3256 OID 66997)
 -- Name: report_collaborators Session owners can manage collaborators; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11191,7 +11918,15 @@
 
 
 --
--- TOC entry 5433 (class 3256 OID 18681)
+-- TOC entry 5549 (class 3256 OID 73835)
+-- Name: email_notifications System can insert email notifications; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "System can insert email notifications" ON public.email_notifications FOR INSERT WITH CHECK (true);
+
+
+--
+-- TOC entry 5424 (class 3256 OID 33073)
 -- Name: usage_records System can insert usage records; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11199,7 +11934,15 @@
 
 
 --
--- TOC entry 5304 (class 3256 OID 18543)
+-- TOC entry 5550 (class 3256 OID 73836)
+-- Name: email_notifications System can update email notifications; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "System can update email notifications" ON public.email_notifications FOR UPDATE WITH CHECK (true);
+
+
+--
+-- TOC entry 5463 (class 3256 OID 66992)
 -- Name: collaborative_action_items Users can create action items with permissions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11207,11 +11950,11 @@
    FROM public.sessions
   WHERE ((sessions.id = collaborative_action_items.session_id) AND ((sessions.user_id = auth.uid()) OR (EXISTS ( SELECT 1
            FROM public.report_collaborators rc
-          WHERE ((rc.session_id = sessions.id) AND (rc.user_id = auth.uid()) AND ((rc.role)::text = ANY (ARRAY['commenter'::text, 'editor'::text])))))))))));
+          WHERE ((rc.session_id = sessions.id) AND (rc.user_id = auth.uid()) AND ((rc.role)::text = ANY ((ARRAY['commenter'::character varying, 'editor'::character varying])::text[])))))))))));
 
 
 --
--- TOC entry 5374 (class 3256 OID 18609)
+-- TOC entry 5457 (class 3256 OID 66985)
 -- Name: report_comments Users can create comments with proper permissions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11219,35 +11962,37 @@
    FROM public.sessions
   WHERE ((sessions.id = report_comments.session_id) AND ((sessions.user_id = auth.uid()) OR (EXISTS ( SELECT 1
            FROM public.report_collaborators rc
-          WHERE ((rc.session_id = sessions.id) AND (rc.user_id = auth.uid()) AND ((rc.role)::text = ANY (ARRAY['commenter'::text, 'editor'::text])))))))))));
+          WHERE ((rc.session_id = sessions.id) AND (rc.user_id = auth.uid()) AND ((rc.role)::text = ANY ((ARRAY['commenter'::character varying, 'editor'::character varying])::text[])))))))))));
 
 
 --
--- TOC entry 5351 (class 3256 OID 18589)
--- Name: organizations Users can create organizations; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5562 (class 3256 OID 76305)
+-- Name: custom_reports Users can create custom reports; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Users can create organizations" ON public.organizations FOR INSERT WITH CHECK (true);
+CREATE POLICY "Users can create custom reports" ON public.custom_reports FOR INSERT WITH CHECK (((auth.uid() = user_id) AND (EXISTS ( SELECT 1
+   FROM public.sessions
+  WHERE ((sessions.id = custom_reports.session_id) AND (sessions.user_id = auth.uid()))))));
 
 
 --
--- TOC entry 5286 (class 3256 OID 18685)
--- Name: user_app_sessions Users can create own app sessions; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5472 (class 3256 OID 33045)
+-- Name: organizations Users can create organizations; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Users can create own app sessions" ON public.user_app_sessions FOR INSERT WITH CHECK ((auth.uid() = user_id));
+CREATE POLICY "Users can create organizations" ON public.organizations FOR INSERT WITH CHECK (true);
 
 
 --
--- TOC entry 5444 (class 3256 OID 32233)
--- Name: custom_reports Users can create own custom reports; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5443 (class 3256 OID 33012)
+-- Name: user_app_sessions Users can create own app sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Users can create own custom reports" ON public.custom_reports FOR INSERT WITH CHECK ((auth.uid() = user_id));
+CREATE POLICY "Users can create own app sessions" ON public.user_app_sessions FOR INSERT WITH CHECK ((auth.uid() = user_id));
 
 
 --
--- TOC entry 5313 (class 3256 OID 18554)
+-- TOC entry 5486 (class 3256 OID 33057)
 -- Name: documents Users can create own documents; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11255,7 +12000,7 @@
 
 
 --
--- TOC entry 5402 (class 3256 OID 18642)
+-- TOC entry 5421 (class 3256 OID 33069)
 -- Name: subscriptions Users can create own subscriptions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11263,7 +12008,7 @@
 
 
 --
--- TOC entry 5423 (class 3256 OID 18665)
+-- TOC entry 5410 (class 3256 OID 33061)
 -- Name: templates Users can create own templates; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11271,15 +12016,7 @@
 
 
 --
--- TOC entry 5441 (class 3256 OID 26973)
--- Name: user_referrals Users can create referrals; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can create referrals" ON public.user_referrals FOR INSERT WITH CHECK ((auth.uid() = referee_user_id));
-
-
---
--- TOC entry 5387 (class 3256 OID 18627)
+-- TOC entry 5578 (class 3256 OID 36670)
 -- Name: sessions Users can create sessions in their current org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11289,7 +12026,7 @@
 
 
 --
--- TOC entry 5392 (class 3256 OID 18631)
+-- TOC entry 5419 (class 3256 OID 62033)
 -- Name: shared_reports Users can create shares for their sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11299,7 +12036,7 @@
 
 
 --
--- TOC entry 5412 (class 3256 OID 18650)
+-- TOC entry 5415 (class 3256 OID 36675)
 -- Name: summaries Users can create summaries for sessions in their org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11311,7 +12048,7 @@
 
 
 --
--- TOC entry 5296 (class 3256 OID 18532)
+-- TOC entry 5435 (class 3256 OID 64362)
 -- Name: calendar_connections Users can create their own calendar connections; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11319,7 +12056,7 @@
 
 
 --
--- TOC entry 5456 (class 3256 OID 33939)
+-- TOC entry 5575 (class 3256 OID 80904)
 -- Name: integration_exports Users can create their own export logs; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11327,7 +12064,7 @@
 
 
 --
--- TOC entry 5452 (class 3256 OID 33935)
+-- TOC entry 5570 (class 3256 OID 80900)
 -- Name: integration_settings Users can create their own integration settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11335,7 +12072,7 @@
 
 
 --
--- TOC entry 5302 (class 3256 OID 18538)
+-- TOC entry 5447 (class 3256 OID 64369)
 -- Name: calendar_preferences Users can create their own preferences; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11343,7 +12080,7 @@
 
 
 --
--- TOC entry 5429 (class 3256 OID 18672)
+-- TOC entry 5428 (class 3256 OID 36678)
 -- Name: transcripts Users can create transcripts for sessions in their org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11355,7 +12092,7 @@
 
 
 --
--- TOC entry 5287 (class 3256 OID 18686)
+-- TOC entry 5401 (class 3256 OID 33014)
 -- Name: user_app_sessions Users can delete own app sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11363,7 +12100,7 @@
 
 
 --
--- TOC entry 5446 (class 3256 OID 32235)
+-- TOC entry 5567 (class 3256 OID 76307)
 -- Name: custom_reports Users can delete own custom reports; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11371,7 +12108,7 @@
 
 
 --
--- TOC entry 5314 (class 3256 OID 18555)
+-- TOC entry 5488 (class 3256 OID 33059)
 -- Name: documents Users can delete own documents; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11379,7 +12116,7 @@
 
 
 --
--- TOC entry 5403 (class 3256 OID 18643)
+-- TOC entry 5423 (class 3256 OID 33071)
 -- Name: subscriptions Users can delete own subscriptions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11387,7 +12124,7 @@
 
 
 --
--- TOC entry 5424 (class 3256 OID 18666)
+-- TOC entry 5412 (class 3256 OID 33063)
 -- Name: templates Users can delete own templates; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11395,7 +12132,7 @@
 
 
 --
--- TOC entry 5297 (class 3256 OID 18533)
+-- TOC entry 5437 (class 3256 OID 64364)
 -- Name: calendar_connections Users can delete their own calendar connections; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11403,7 +12140,7 @@
 
 
 --
--- TOC entry 5375 (class 3256 OID 18611)
+-- TOC entry 5459 (class 3256 OID 66988)
 -- Name: report_comments Users can delete their own comments; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11411,7 +12148,7 @@
 
 
 --
--- TOC entry 5315 (class 3256 OID 18556)
+-- TOC entry 5565 (class 3256 OID 36653)
 -- Name: documents Users can delete their own documents; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11419,7 +12156,7 @@
 
 
 --
--- TOC entry 5454 (class 3256 OID 33937)
+-- TOC entry 5572 (class 3256 OID 80902)
 -- Name: integration_settings Users can delete their own integration settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11427,7 +12164,7 @@
 
 
 --
--- TOC entry 5303 (class 3256 OID 18539)
+-- TOC entry 5449 (class 3256 OID 64371)
 -- Name: calendar_preferences Users can delete their own preferences; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11435,7 +12172,7 @@
 
 
 --
--- TOC entry 5388 (class 3256 OID 18628)
+-- TOC entry 5580 (class 3256 OID 36672)
 -- Name: sessions Users can delete their own sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11445,7 +12182,7 @@
 
 
 --
--- TOC entry 5393 (class 3256 OID 18632)
+-- TOC entry 5427 (class 3256 OID 62036)
 -- Name: shared_reports Users can delete their own shares; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11453,15 +12190,7 @@
 
 
 --
--- TOC entry 5330 (class 3256 OID 32287)
--- Name: user_preferences Users can insert own preferences; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can insert own preferences" ON public.user_preferences FOR INSERT WITH CHECK ((auth.uid() = user_id));
-
-
---
--- TOC entry 5278 (class 3256 OID 17925)
+-- TOC entry 5432 (class 3256 OID 36698)
 -- Name: usage_tracking Users can insert own usage tracking; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11469,7 +12198,7 @@
 
 
 --
--- TOC entry 5364 (class 3256 OID 18601)
+-- TOC entry 5521 (class 3256 OID 67026)
 -- Name: report_activity Users can insert their own activity; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11477,15 +12206,15 @@
 
 
 --
--- TOC entry 5458 (class 3256 OID 35412)
--- Name: embedding_queue Users can insert their own embedding queue items; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5552 (class 3256 OID 73858)
+-- Name: user_preferences Users can insert their own preferences; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Users can insert their own embedding queue items" ON public.embedding_queue FOR INSERT WITH CHECK ((auth.uid() = user_id));
+CREATE POLICY "Users can insert their own preferences" ON public.user_preferences FOR INSERT WITH CHECK ((auth.uid() = user_id));
 
 
 --
--- TOC entry 5371 (class 3256 OID 18606)
+-- TOC entry 5469 (class 3256 OID 66999)
 -- Name: report_bookmarks Users can manage their bookmarks; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11493,7 +12222,7 @@
 
 
 --
--- TOC entry 5311 (class 3256 OID 18552)
+-- TOC entry 5461 (class 3256 OID 66990)
 -- Name: comment_mentions Users can mark mentions as read; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11501,7 +12230,7 @@
 
 
 --
--- TOC entry 5305 (class 3256 OID 18545)
+-- TOC entry 5464 (class 3256 OID 66994)
 -- Name: collaborative_action_items Users can update action items they created or are assigned to; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11511,7 +12240,7 @@
 
 
 --
--- TOC entry 5288 (class 3256 OID 18687)
+-- TOC entry 5400 (class 3256 OID 33013)
 -- Name: user_app_sessions Users can update own app sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11519,7 +12248,7 @@
 
 
 --
--- TOC entry 5445 (class 3256 OID 32234)
+-- TOC entry 5566 (class 3256 OID 76306)
 -- Name: custom_reports Users can update own custom reports; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11527,7 +12256,7 @@
 
 
 --
--- TOC entry 5316 (class 3256 OID 18557)
+-- TOC entry 5487 (class 3256 OID 33058)
 -- Name: documents Users can update own documents; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11535,15 +12264,7 @@
 
 
 --
--- TOC entry 5335 (class 3256 OID 32288)
--- Name: user_preferences Users can update own preferences; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can update own preferences" ON public.user_preferences FOR UPDATE USING ((auth.uid() = user_id));
-
-
---
--- TOC entry 5404 (class 3256 OID 18644)
+-- TOC entry 5422 (class 3256 OID 33070)
 -- Name: subscriptions Users can update own subscriptions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11551,7 +12272,7 @@
 
 
 --
--- TOC entry 5425 (class 3256 OID 18667)
+-- TOC entry 5411 (class 3256 OID 33062)
 -- Name: templates Users can update own templates; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11559,7 +12280,7 @@
 
 
 --
--- TOC entry 5279 (class 3256 OID 17926)
+-- TOC entry 5433 (class 3256 OID 36699)
 -- Name: usage_tracking Users can update own usage tracking; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11567,7 +12288,7 @@
 
 
 --
--- TOC entry 5413 (class 3256 OID 18652)
+-- TOC entry 5416 (class 3256 OID 36676)
 -- Name: summaries Users can update summaries for sessions in their org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11579,7 +12300,7 @@
 
 
 --
--- TOC entry 5298 (class 3256 OID 18534)
+-- TOC entry 5436 (class 3256 OID 64363)
 -- Name: calendar_connections Users can update their own calendar connections; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11587,7 +12308,7 @@
 
 
 --
--- TOC entry 5376 (class 3256 OID 18612)
+-- TOC entry 5458 (class 3256 OID 66987)
 -- Name: report_comments Users can update their own comments; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11595,15 +12316,7 @@
 
 
 --
--- TOC entry 5459 (class 3256 OID 35413)
--- Name: embedding_queue Users can update their own embedding queue items; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can update their own embedding queue items" ON public.embedding_queue FOR UPDATE USING ((auth.uid() = user_id));
-
-
---
--- TOC entry 5453 (class 3256 OID 33936)
+-- TOC entry 5571 (class 3256 OID 80901)
 -- Name: integration_settings Users can update their own integration settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11611,7 +12324,7 @@
 
 
 --
--- TOC entry 5337 (class 3256 OID 18576)
+-- TOC entry 5452 (class 3256 OID 64450)
 -- Name: meeting_notifications Users can update their own notifications; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11619,7 +12332,7 @@
 
 
 --
--- TOC entry 5282 (class 3256 OID 18540)
+-- TOC entry 5448 (class 3256 OID 64370)
 -- Name: calendar_preferences Users can update their own preferences; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11627,7 +12340,15 @@
 
 
 --
--- TOC entry 5389 (class 3256 OID 18629)
+-- TOC entry 5553 (class 3256 OID 73859)
+-- Name: user_preferences Users can update their own preferences; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Users can update their own preferences" ON public.user_preferences FOR UPDATE USING ((auth.uid() = user_id));
+
+
+--
+-- TOC entry 5579 (class 3256 OID 36671)
 -- Name: sessions Users can update their own sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11637,7 +12358,7 @@
 
 
 --
--- TOC entry 5394 (class 3256 OID 18633)
+-- TOC entry 5426 (class 3256 OID 62035)
 -- Name: shared_reports Users can update their own shares; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11645,7 +12366,7 @@
 
 
 --
--- TOC entry 5430 (class 3256 OID 18674)
+-- TOC entry 5430 (class 3256 OID 36679)
 -- Name: transcripts Users can update transcripts for sessions in their org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11657,7 +12378,7 @@
 
 
 --
--- TOC entry 5317 (class 3256 OID 18558)
+-- TOC entry 5564 (class 3256 OID 36652)
 -- Name: documents Users can upload documents to their organization; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11667,7 +12388,7 @@
 
 
 --
--- TOC entry 5306 (class 3256 OID 18546)
+-- TOC entry 5462 (class 3256 OID 66991)
 -- Name: collaborative_action_items Users can view action items on accessible sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11679,7 +12400,7 @@
 
 
 --
--- TOC entry 5365 (class 3256 OID 18602)
+-- TOC entry 5542 (class 3256 OID 67027)
 -- Name: report_activity Users can view activity for accessible sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11689,7 +12410,7 @@
 
 
 --
--- TOC entry 5368 (class 3256 OID 18603)
+-- TOC entry 5465 (class 3256 OID 66995)
 -- Name: report_activity Users can view activity on accessible sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11701,7 +12422,7 @@
 
 
 --
--- TOC entry 5377 (class 3256 OID 18613)
+-- TOC entry 5456 (class 3256 OID 66983)
 -- Name: report_comments Users can view comments on accessible sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11709,13 +12430,13 @@
    FROM public.sessions
   WHERE ((sessions.id = report_comments.session_id) AND ((sessions.user_id = auth.uid()) OR (EXISTS ( SELECT 1
            FROM public.report_collaborators rc
-          WHERE ((rc.session_id = sessions.id) AND (rc.user_id = auth.uid()) AND ((rc.role)::text = ANY (ARRAY['viewer'::text, 'commenter'::text, 'editor'::text]))))) OR (EXISTS ( SELECT 1
+          WHERE ((rc.session_id = sessions.id) AND (rc.user_id = auth.uid()) AND ((rc.role)::text = ANY ((ARRAY['viewer'::character varying, 'commenter'::character varying, 'editor'::character varying])::text[]))))) OR (EXISTS ( SELECT 1
            FROM public.shared_reports sr
           WHERE ((sr.session_id = sessions.id) AND ((sr.expires_at IS NULL) OR (sr.expires_at > now()))))))))));
 
 
 --
--- TOC entry 5301 (class 3256 OID 18537)
+-- TOC entry 5438 (class 3256 OID 64365)
 -- Name: calendar_events Users can view events from their calendar connections; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11725,7 +12446,7 @@
 
 
 --
--- TOC entry 5343 (class 3256 OID 18581)
+-- TOC entry 5478 (class 3256 OID 33051)
 -- Name: organization_invitations Users can view invitations sent to them; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11733,7 +12454,7 @@
 
 
 --
--- TOC entry 5347 (class 3256 OID 18585)
+-- TOC entry 5576 (class 3256 OID 36668)
 -- Name: organization_members Users can view members of their organizations; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11743,7 +12464,7 @@
 
 
 --
--- TOC entry 5289 (class 3256 OID 18688)
+-- TOC entry 5442 (class 3256 OID 33011)
 -- Name: user_app_sessions Users can view own app sessions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11751,15 +12472,7 @@
 
 
 --
--- TOC entry 5442 (class 3256 OID 26974)
--- Name: user_credits Users can view own credits; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can view own credits" ON public.user_credits FOR SELECT USING ((auth.uid() = user_id));
-
-
---
--- TOC entry 5443 (class 3256 OID 32232)
+-- TOC entry 5561 (class 3256 OID 76304)
 -- Name: custom_reports Users can view own custom reports; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11767,7 +12480,7 @@
 
 
 --
--- TOC entry 5318 (class 3256 OID 18559)
+-- TOC entry 5485 (class 3256 OID 33056)
 -- Name: documents Users can view own documents; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11775,47 +12488,15 @@
 
 
 --
--- TOC entry 5447 (class 3256 OID 32262)
--- Name: email_notifications Users can view own email notifications; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can view own email notifications" ON public.email_notifications FOR SELECT USING ((auth.uid() = user_id));
-
-
---
--- TOC entry 5280 (class 3256 OID 17927)
+-- TOC entry 5453 (class 3256 OID 36700)
 -- Name: monthly_usage_cache Users can view own monthly usage; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Users can view own monthly usage" ON public.monthly_usage_cache FOR SELECT USING ((auth.uid() = user_id));
+CREATE POLICY "Users can view own monthly usage" ON public.monthly_usage_cache FOR SELECT TO authenticated USING ((auth.uid() = user_id));
 
 
 --
--- TOC entry 5448 (class 3256 OID 32286)
--- Name: user_preferences Users can view own preferences; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can view own preferences" ON public.user_preferences FOR SELECT USING ((auth.uid() = user_id));
-
-
---
--- TOC entry 5449 (class 3256 OID 32328)
--- Name: referral_audit_logs Users can view own referral logs; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can view own referral logs" ON public.referral_audit_logs FOR SELECT USING (((auth.uid() = user_id) OR (auth.uid() = referrer_id) OR (auth.uid() = referee_id)));
-
-
---
--- TOC entry 5440 (class 3256 OID 26972)
--- Name: user_referrals Users can view own referrals; Type: POLICY; Schema: public; Owner: postgres
---
-
-CREATE POLICY "Users can view own referrals" ON public.user_referrals FOR SELECT USING (((auth.uid() = referrer_user_id) OR (auth.uid() = referee_user_id)));
-
-
---
--- TOC entry 5390 (class 3256 OID 18640)
+-- TOC entry 5454 (class 3256 OID 39001)
 -- Name: subscription_events Users can view own subscription events; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11823,7 +12504,7 @@
 
 
 --
--- TOC entry 5405 (class 3256 OID 18645)
+-- TOC entry 5420 (class 3256 OID 33068)
 -- Name: subscriptions Users can view own subscriptions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11831,7 +12512,7 @@
 
 
 --
--- TOC entry 5409 (class 3256 OID 18668)
+-- TOC entry 5489 (class 3256 OID 33060)
 -- Name: templates Users can view own templates; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11839,7 +12520,7 @@
 
 
 --
--- TOC entry 5434 (class 3256 OID 18682)
+-- TOC entry 5536 (class 3256 OID 36590)
 -- Name: usage_records Users can view own usage records; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11849,7 +12530,7 @@
 
 
 --
--- TOC entry 5281 (class 3256 OID 17928)
+-- TOC entry 5431 (class 3256 OID 36697)
 -- Name: usage_tracking Users can view own usage tracking; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11857,7 +12538,7 @@
 
 
 --
--- TOC entry 5385 (class 3256 OID 18630)
+-- TOC entry 5577 (class 3256 OID 36669)
 -- Name: sessions Users can view sessions in their current org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11867,7 +12548,7 @@
 
 
 --
--- TOC entry 5414 (class 3256 OID 18654)
+-- TOC entry 5414 (class 3256 OID 36674)
 -- Name: summaries Users can view summaries for sessions in their org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11879,7 +12560,7 @@
 
 
 --
--- TOC entry 5352 (class 3256 OID 18590)
+-- TOC entry 5581 (class 3256 OID 36673)
 -- Name: organizations Users can view their current organization; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11889,7 +12570,7 @@
 
 
 --
--- TOC entry 5312 (class 3256 OID 18553)
+-- TOC entry 5460 (class 3256 OID 66989)
 -- Name: comment_mentions Users can view their mentions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11897,7 +12578,7 @@
 
 
 --
--- TOC entry 5320 (class 3256 OID 18560)
+-- TOC entry 5563 (class 3256 OID 36651)
 -- Name: documents Users can view their organization documents; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11907,7 +12588,7 @@
 
 
 --
--- TOC entry 5295 (class 3256 OID 18531)
+-- TOC entry 5450 (class 3256 OID 64448)
 -- Name: calendar_auto_join_logs Users can view their own auto-join logs; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11915,7 +12596,7 @@
 
 
 --
--- TOC entry 5299 (class 3256 OID 18535)
+-- TOC entry 5434 (class 3256 OID 64361)
 -- Name: calendar_connections Users can view their own calendar connections; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11923,15 +12604,23 @@
 
 
 --
--- TOC entry 5457 (class 3256 OID 35411)
--- Name: embedding_queue Users can view their own embedding queue items; Type: POLICY; Schema: public; Owner: postgres
+-- TOC entry 5556 (class 3256 OID 76180)
+-- Name: user_credits Users can view their own credits; Type: POLICY; Schema: public; Owner: postgres
 --
 
-CREATE POLICY "Users can view their own embedding queue items" ON public.embedding_queue FOR SELECT USING ((auth.uid() = user_id));
+CREATE POLICY "Users can view their own credits" ON public.user_credits FOR SELECT USING ((user_id = auth.uid()));
 
 
 --
--- TOC entry 5455 (class 3256 OID 33938)
+-- TOC entry 5545 (class 3256 OID 73834)
+-- Name: email_notifications Users can view their own email notifications; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Users can view their own email notifications" ON public.email_notifications FOR SELECT USING ((auth.uid() = user_id));
+
+
+--
+-- TOC entry 5573 (class 3256 OID 80903)
 -- Name: integration_exports Users can view their own export history; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11939,7 +12628,7 @@
 
 
 --
--- TOC entry 5451 (class 3256 OID 33934)
+-- TOC entry 5569 (class 3256 OID 80899)
 -- Name: integration_settings Users can view their own integration settings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11947,7 +12636,7 @@
 
 
 --
--- TOC entry 5348 (class 3256 OID 18586)
+-- TOC entry 5574 (class 3256 OID 36667)
 -- Name: organization_members Users can view their own memberships; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11955,7 +12644,7 @@
 
 
 --
--- TOC entry 5338 (class 3256 OID 18577)
+-- TOC entry 5451 (class 3256 OID 64449)
 -- Name: meeting_notifications Users can view their own notifications; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11963,7 +12652,7 @@
 
 
 --
--- TOC entry 5283 (class 3256 OID 18541)
+-- TOC entry 5446 (class 3256 OID 64368)
 -- Name: calendar_preferences Users can view their own preferences; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11971,7 +12660,39 @@
 
 
 --
--- TOC entry 5395 (class 3256 OID 18634)
+-- TOC entry 5551 (class 3256 OID 73857)
+-- Name: user_preferences Users can view their own preferences; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Users can view their own preferences" ON public.user_preferences FOR SELECT USING ((auth.uid() = user_id));
+
+
+--
+-- TOC entry 5559 (class 3256 OID 76258)
+-- Name: referral_audit_logs Users can view their own referral logs; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Users can view their own referral logs" ON public.referral_audit_logs FOR SELECT USING (((user_id = auth.uid()) OR (referrer_id = auth.uid()) OR (referee_id = auth.uid())));
+
+
+--
+-- TOC entry 5555 (class 3256 OID 76179)
+-- Name: user_referrals Users can view their own referrals as referee; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Users can view their own referrals as referee" ON public.user_referrals FOR SELECT USING ((referee_id = auth.uid()));
+
+
+--
+-- TOC entry 5554 (class 3256 OID 76178)
+-- Name: user_referrals Users can view their own referrals as referrer; Type: POLICY; Schema: public; Owner: postgres
+--
+
+CREATE POLICY "Users can view their own referrals as referrer" ON public.user_referrals FOR SELECT USING ((referrer_id = auth.uid()));
+
+
+--
+-- TOC entry 5425 (class 3256 OID 62034)
 -- Name: shared_reports Users can view their own shares; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11979,7 +12700,7 @@
 
 
 --
--- TOC entry 5406 (class 3256 OID 18646)
+-- TOC entry 5470 (class 3256 OID 39021)
 -- Name: subscriptions Users can view their own subscriptions; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11987,7 +12708,7 @@
 
 
 --
--- TOC entry 5294 (class 3256 OID 18530)
+-- TOC entry 5408 (class 3256 OID 60865)
 -- Name: bot_recordings Users can view their session recordings; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -11997,7 +12718,7 @@
 
 
 --
--- TOC entry 5431 (class 3256 OID 18676)
+-- TOC entry 5418 (class 3256 OID 36677)
 -- Name: transcripts Users can view transcripts for sessions in their org; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12009,7 +12730,7 @@
 
 
 --
--- TOC entry 5293 (class 3256 OID 18692)
+-- TOC entry 5504 (class 3256 OID 67023)
 -- Name: users allow_authenticated_select_users; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12017,7 +12738,7 @@
 
 
 --
--- TOC entry 5391 (class 3256 OID 18693)
+-- TOC entry 5513 (class 3256 OID 67024)
 -- Name: users allow_users_update_own; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12025,7 +12746,7 @@
 
 
 --
--- TOC entry 5410 (class 3256 OID 18694)
+-- TOC entry 5413 (class 3256 OID 36578)
 -- Name: beta_waitlist beta_waitlist_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12033,63 +12754,63 @@
 
 
 --
--- TOC entry 5247 (class 0 OID 17949)
--- Dependencies: 289
+-- TOC entry 5372 (class 0 OID 60845)
+-- Dependencies: 362
 -- Name: bot_recordings; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.bot_recordings ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5248 (class 0 OID 17968)
--- Dependencies: 291
+-- TOC entry 5378 (class 0 OID 64393)
+-- Dependencies: 368
 -- Name: calendar_auto_join_logs; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.calendar_auto_join_logs ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5249 (class 0 OID 17975)
--- Dependencies: 292
+-- TOC entry 5374 (class 0 OID 64265)
+-- Dependencies: 364
 -- Name: calendar_connections; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.calendar_connections ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5250 (class 0 OID 17984)
--- Dependencies: 293
+-- TOC entry 5375 (class 0 OID 64291)
+-- Dependencies: 365
 -- Name: calendar_events; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.calendar_events ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5251 (class 0 OID 17996)
--- Dependencies: 294
+-- TOC entry 5377 (class 0 OID 64330)
+-- Dependencies: 367
 -- Name: calendar_preferences; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.calendar_preferences ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5252 (class 0 OID 18011)
--- Dependencies: 295
+-- TOC entry 5376 (class 0 OID 64316)
+-- Dependencies: 366
 -- Name: calendar_webhooks; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.calendar_webhooks ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5253 (class 0 OID 18018)
--- Dependencies: 296
+-- TOC entry 5382 (class 0 OID 66863)
+-- Dependencies: 372
 -- Name: collaborative_action_items; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.collaborative_action_items ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5307 (class 3256 OID 18547)
+-- TOC entry 5498 (class 3256 OID 67021)
 -- Name: collaborative_action_items collaborative_action_items_delete_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12097,7 +12818,7 @@
 
 
 --
--- TOC entry 5308 (class 3256 OID 18548)
+-- TOC entry 5496 (class 3256 OID 67018)
 -- Name: collaborative_action_items collaborative_action_items_insert_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12107,7 +12828,7 @@
 
 
 --
--- TOC entry 5309 (class 3256 OID 18549)
+-- TOC entry 5495 (class 3256 OID 67017)
 -- Name: collaborative_action_items collaborative_action_items_select_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12117,7 +12838,7 @@
 
 
 --
--- TOC entry 5310 (class 3256 OID 18550)
+-- TOC entry 5497 (class 3256 OID 67019)
 -- Name: collaborative_action_items collaborative_action_items_update_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12129,23 +12850,31 @@
 
 
 --
--- TOC entry 5254 (class 0 OID 18028)
--- Dependencies: 297
+-- TOC entry 5381 (class 0 OID 66843)
+-- Dependencies: 371
 -- Name: comment_mentions; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.comment_mentions ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5268 (class 0 OID 32207)
--- Dependencies: 322
+-- TOC entry 5392 (class 0 OID 76279)
+-- Dependencies: 384
 -- Name: custom_reports; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.custom_reports ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5321 (class 3256 OID 18561)
+-- TOC entry 5358 (class 0 OID 17426)
+-- Dependencies: 335
+-- Name: documents; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.documents ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5402 (class 3256 OID 36541)
 -- Name: documents documents_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12153,7 +12882,7 @@
 
 
 --
--- TOC entry 5322 (class 3256 OID 18562)
+-- TOC entry 5547 (class 3256 OID 36620)
 -- Name: documents documents_insert_own_session; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12163,7 +12892,7 @@
 
 
 --
--- TOC entry 5323 (class 3256 OID 18563)
+-- TOC entry 5509 (class 3256 OID 36540)
 -- Name: documents documents_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12171,7 +12900,7 @@
 
 
 --
--- TOC entry 5324 (class 3256 OID 18564)
+-- TOC entry 5546 (class 3256 OID 36619)
 -- Name: documents documents_select_via_session; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12180,7 +12909,7 @@
 
 
 --
--- TOC entry 5325 (class 3256 OID 18565)
+-- TOC entry 5403 (class 3256 OID 36542)
 -- Name: documents documents_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12188,7 +12917,7 @@
 
 
 --
--- TOC entry 5326 (class 3256 OID 18566)
+-- TOC entry 5548 (class 3256 OID 36621)
 -- Name: documents documents_update_own_session; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12200,23 +12929,23 @@
 
 
 --
--- TOC entry 5269 (class 0 OID 32236)
--- Dependencies: 323
+-- TOC entry 5387 (class 0 OID 73809)
+-- Dependencies: 377
 -- Name: email_notifications; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.email_notifications ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5274 (class 0 OID 35393)
--- Dependencies: 331
--- Name: embedding_queue; Type: ROW SECURITY; Schema: public; Owner: postgres
+-- TOC entry 5360 (class 0 OID 17478)
+-- Dependencies: 337
+-- Name: guidance; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
-ALTER TABLE public.embedding_queue ENABLE ROW LEVEL SECURITY;
+ALTER TABLE public.guidance ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5327 (class 3256 OID 18568)
+-- TOC entry 5502 (class 3256 OID 60798)
 -- Name: guidance guidance_delete; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12226,7 +12955,7 @@
 
 
 --
--- TOC entry 5328 (class 3256 OID 18569)
+-- TOC entry 5511 (class 3256 OID 36547)
 -- Name: guidance guidance_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12236,7 +12965,7 @@
 
 
 --
--- TOC entry 5329 (class 3256 OID 18570)
+-- TOC entry 5510 (class 3256 OID 36546)
 -- Name: guidance guidance_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12246,7 +12975,7 @@
 
 
 --
--- TOC entry 5331 (class 3256 OID 18571)
+-- TOC entry 5512 (class 3256 OID 36548)
 -- Name: guidance guidance_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12256,31 +12985,31 @@
 
 
 --
--- TOC entry 5273 (class 0 OID 33905)
--- Dependencies: 329
+-- TOC entry 5395 (class 0 OID 80870)
+-- Dependencies: 393
 -- Name: integration_exports; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.integration_exports ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5272 (class 0 OID 33880)
--- Dependencies: 328
+-- TOC entry 5394 (class 0 OID 80845)
+-- Dependencies: 392
 -- Name: integration_settings; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.integration_settings ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5255 (class 0 OID 18039)
--- Dependencies: 299
+-- TOC entry 5370 (class 0 OID 52616)
+-- Dependencies: 357
 -- Name: meeting_metadata; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.meeting_metadata ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5332 (class 3256 OID 18572)
+-- TOC entry 5532 (class 3256 OID 60802)
 -- Name: meeting_metadata meeting_metadata_delete; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12290,7 +13019,7 @@
 
 
 --
--- TOC entry 5333 (class 3256 OID 18573)
+-- TOC entry 5505 (class 3256 OID 60800)
 -- Name: meeting_metadata meeting_metadata_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12300,7 +13029,7 @@
 
 
 --
--- TOC entry 5334 (class 3256 OID 18574)
+-- TOC entry 5503 (class 3256 OID 60799)
 -- Name: meeting_metadata meeting_metadata_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12310,7 +13039,7 @@
 
 
 --
--- TOC entry 5336 (class 3256 OID 18575)
+-- TOC entry 5531 (class 3256 OID 60801)
 -- Name: meeting_metadata meeting_metadata_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12320,45 +13049,53 @@
 
 
 --
--- TOC entry 5256 (class 0 OID 18048)
--- Dependencies: 300
+-- TOC entry 5379 (class 0 OID 64421)
+-- Dependencies: 369
 -- Name: meeting_notifications; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.meeting_notifications ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5344 (class 3256 OID 18582)
+-- TOC entry 5367 (class 0 OID 30224)
+-- Dependencies: 350
+-- Name: monthly_usage_cache; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.monthly_usage_cache ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5500 (class 3256 OID 36531)
 -- Name: organization_invitations org_invitations_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
 CREATE POLICY org_invitations_insert ON public.organization_invitations FOR INSERT WITH CHECK ((EXISTS ( SELECT 1
    FROM public.organization_members om
-  WHERE ((om.organization_id = organization_invitations.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY (ARRAY['owner'::text, 'admin'::text]))))));
+  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[]))))));
 
 
 --
--- TOC entry 5345 (class 3256 OID 18583)
+-- TOC entry 5499 (class 3256 OID 36530)
 -- Name: organization_invitations org_invitations_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
 CREATE POLICY org_invitations_select ON public.organization_invitations FOR SELECT USING ((EXISTS ( SELECT 1
    FROM public.organization_members om
-  WHERE ((om.organization_id = organization_invitations.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY (ARRAY['owner'::text, 'admin'::text]))))));
+  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[]))))));
 
 
 --
--- TOC entry 5346 (class 3256 OID 18584)
+-- TOC entry 5501 (class 3256 OID 36532)
 -- Name: organization_invitations org_invitations_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
 CREATE POLICY org_invitations_update ON public.organization_invitations FOR UPDATE USING (((invited_by_user_id = auth.uid()) OR (EXISTS ( SELECT 1
    FROM public.organization_members om
-  WHERE ((om.organization_id = organization_invitations.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY (ARRAY['owner'::text, 'admin'::text])))))));
+  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[])))))));
 
 
 --
--- TOC entry 5437 (class 3256 OID 18695)
+-- TOC entry 5417 (class 3256 OID 26098)
 -- Name: organization_invitations organization_invitations_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12368,7 +13105,23 @@
 
 
 --
--- TOC entry 5353 (class 3256 OID 18591)
+-- TOC entry 5356 (class 0 OID 17284)
+-- Dependencies: 331
+-- Name: organization_members; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.organization_members ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5355 (class 0 OID 17264)
+-- Dependencies: 330
+-- Name: organizations; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.organizations ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5480 (class 3256 OID 36524)
 -- Name: organizations organizations_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12376,17 +13129,17 @@
 
 
 --
--- TOC entry 5354 (class 3256 OID 18592)
+-- TOC entry 5479 (class 3256 OID 36523)
 -- Name: organizations organizations_update_admin; Type: POLICY; Schema: public; Owner: postgres
 --
 
 CREATE POLICY organizations_update_admin ON public.organizations FOR UPDATE USING ((EXISTS ( SELECT 1
    FROM public.organization_members om
-  WHERE ((om.organization_id = organizations.id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY (ARRAY['owner'::text, 'admin'::text]))))));
+  WHERE ((om.organization_id = om.id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[]))))));
 
 
 --
--- TOC entry 5357 (class 3256 OID 18595)
+-- TOC entry 5514 (class 3256 OID 36552)
 -- Name: plans plans_select_all; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12394,15 +13147,15 @@
 
 
 --
--- TOC entry 5245 (class 0 OID 17450)
--- Dependencies: 280
+-- TOC entry 5365 (class 0 OID 27368)
+-- Dependencies: 346
 -- Name: prep_checklist; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.prep_checklist ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5358 (class 3256 OID 18596)
+-- TOC entry 5530 (class 3256 OID 36572)
 -- Name: prep_checklist prep_checklist_delete; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12412,7 +13165,7 @@
 
 
 --
--- TOC entry 5359 (class 3256 OID 18597)
+-- TOC entry 5528 (class 3256 OID 36570)
 -- Name: prep_checklist prep_checklist_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12422,7 +13175,7 @@
 
 
 --
--- TOC entry 5361 (class 3256 OID 18598)
+-- TOC entry 5527 (class 3256 OID 36569)
 -- Name: prep_checklist prep_checklist_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12432,7 +13185,7 @@
 
 
 --
--- TOC entry 5362 (class 3256 OID 18599)
+-- TOC entry 5529 (class 3256 OID 36571)
 -- Name: prep_checklist prep_checklist_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12442,23 +13195,31 @@
 
 
 --
--- TOC entry 5271 (class 0 OID 32293)
--- Dependencies: 325
+-- TOC entry 5391 (class 0 OID 76223)
+-- Dependencies: 383
 -- Name: referral_audit_logs; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.referral_audit_logs ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5257 (class 0 OID 18064)
--- Dependencies: 302
+-- TOC entry 5393 (class 0 OID 79694)
+-- Dependencies: 390
+-- Name: referral_fraud_checks; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.referral_fraud_checks ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5383 (class 0 OID 66902)
+-- Dependencies: 373
 -- Name: report_activity; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.report_activity ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5369 (class 3256 OID 18604)
+-- TOC entry 5494 (class 3256 OID 67016)
 -- Name: report_activity report_activity_insert_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12468,7 +13229,7 @@
 
 
 --
--- TOC entry 5370 (class 3256 OID 18605)
+-- TOC entry 5493 (class 3256 OID 67015)
 -- Name: report_activity report_activity_select_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12478,31 +13239,31 @@
 
 
 --
--- TOC entry 5258 (class 0 OID 18072)
--- Dependencies: 303
+-- TOC entry 5385 (class 0 OID 66959)
+-- Dependencies: 375
 -- Name: report_bookmarks; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.report_bookmarks ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5259 (class 0 OID 18080)
--- Dependencies: 304
+-- TOC entry 5384 (class 0 OID 66927)
+-- Dependencies: 374
 -- Name: report_collaborators; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.report_collaborators ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5260 (class 0 OID 18086)
--- Dependencies: 305
+-- TOC entry 5380 (class 0 OID 66811)
+-- Dependencies: 370
 -- Name: report_comments; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.report_comments ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5378 (class 3256 OID 18615)
+-- TOC entry 5492 (class 3256 OID 67014)
 -- Name: report_comments report_comments_delete_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12510,7 +13271,7 @@
 
 
 --
--- TOC entry 5379 (class 3256 OID 18616)
+-- TOC entry 5476 (class 3256 OID 67012)
 -- Name: report_comments report_comments_insert_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12520,7 +13281,7 @@
 
 
 --
--- TOC entry 5380 (class 3256 OID 18617)
+-- TOC entry 5475 (class 3256 OID 67011)
 -- Name: report_comments report_comments_select_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12530,7 +13291,7 @@
 
 
 --
--- TOC entry 5341 (class 3256 OID 18618)
+-- TOC entry 5477 (class 3256 OID 67013)
 -- Name: report_comments report_comments_update_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12538,7 +13299,15 @@
 
 
 --
--- TOC entry 5360 (class 3256 OID 18619)
+-- TOC entry 5364 (class 0 OID 26062)
+-- Dependencies: 345
+-- Name: session_context; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.session_context ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5544 (class 3256 OID 60809)
 -- Name: session_context session_context_delete; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12546,7 +13315,7 @@
 
 
 --
--- TOC entry 5366 (class 3256 OID 18620)
+-- TOC entry 5525 (class 3256 OID 36567)
 -- Name: session_context session_context_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12554,7 +13323,7 @@
 
 
 --
--- TOC entry 5367 (class 3256 OID 18621)
+-- TOC entry 5524 (class 3256 OID 36566)
 -- Name: session_context session_context_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12562,7 +13331,7 @@
 
 
 --
--- TOC entry 5381 (class 3256 OID 18622)
+-- TOC entry 5526 (class 3256 OID 36568)
 -- Name: session_context session_context_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12570,7 +13339,15 @@
 
 
 --
--- TOC entry 5382 (class 3256 OID 18623)
+-- TOC entry 5363 (class 0 OID 18768)
+-- Dependencies: 344
+-- Name: session_timeline_events; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.session_timeline_events ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5537 (class 3256 OID 60804)
 -- Name: session_timeline_events session_timeline_events_delete; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12580,7 +13357,7 @@
 
 
 --
--- TOC entry 5383 (class 3256 OID 18624)
+-- TOC entry 5523 (class 3256 OID 36565)
 -- Name: session_timeline_events session_timeline_events_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12590,7 +13367,7 @@
 
 
 --
--- TOC entry 5384 (class 3256 OID 18625)
+-- TOC entry 5522 (class 3256 OID 36564)
 -- Name: session_timeline_events session_timeline_events_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12600,7 +13377,7 @@
 
 
 --
--- TOC entry 5386 (class 3256 OID 18626)
+-- TOC entry 5533 (class 3256 OID 60803)
 -- Name: session_timeline_events session_timeline_events_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12610,23 +13387,31 @@
 
 
 --
--- TOC entry 5261 (class 0 OID 18098)
--- Dependencies: 306
+-- TOC entry 5357 (class 0 OID 17390)
+-- Dependencies: 334
+-- Name: sessions; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.sessions ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5373 (class 0 OID 62006)
+-- Dependencies: 363
 -- Name: shared_reports; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.shared_reports ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5262 (class 0 OID 18107)
--- Dependencies: 307
+-- TOC entry 5371 (class 0 OID 52635)
+-- Dependencies: 358
 -- Name: smart_notes; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.smart_notes ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5396 (class 3256 OID 18635)
+-- TOC entry 5541 (class 3256 OID 60808)
 -- Name: smart_notes smart_notes_delete; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12634,7 +13419,7 @@
 
 
 --
--- TOC entry 5397 (class 3256 OID 18636)
+-- TOC entry 5539 (class 3256 OID 60806)
 -- Name: smart_notes smart_notes_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12642,7 +13427,7 @@
 
 
 --
--- TOC entry 5398 (class 3256 OID 18637)
+-- TOC entry 5538 (class 3256 OID 60805)
 -- Name: smart_notes smart_notes_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12650,7 +13435,7 @@
 
 
 --
--- TOC entry 5399 (class 3256 OID 18638)
+-- TOC entry 5540 (class 3256 OID 60807)
 -- Name: smart_notes smart_notes_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12658,15 +13443,15 @@
 
 
 --
--- TOC entry 5263 (class 0 OID 18118)
--- Dependencies: 308
+-- TOC entry 5368 (class 0 OID 38974)
+-- Dependencies: 353
 -- Name: subscription_events; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.subscription_events ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5407 (class 3256 OID 18647)
+-- TOC entry 5516 (class 3256 OID 36555)
 -- Name: subscriptions subscriptions_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12674,7 +13459,7 @@
 
 
 --
--- TOC entry 5408 (class 3256 OID 18648)
+-- TOC entry 5515 (class 3256 OID 36554)
 -- Name: subscriptions subscriptions_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12682,33 +13467,41 @@
 
 
 --
--- TOC entry 5411 (class 3256 OID 18649)
+-- TOC entry 5517 (class 3256 OID 36556)
 -- Name: subscriptions subscriptions_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
 CREATE POLICY subscriptions_update ON public.subscriptions FOR UPDATE USING (((user_id = auth.uid()) OR ((organization_id IS NOT NULL) AND (EXISTS ( SELECT 1
    FROM public.organization_members om
-  WHERE ((om.organization_id = subscriptions.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY (ARRAY['owner'::text, 'admin'::text]))))))));
+  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[]))))))));
 
 
 --
--- TOC entry 5246 (class 0 OID 17496)
--- Dependencies: 285
+-- TOC entry 5361 (class 0 OID 17511)
+-- Dependencies: 338
+-- Name: summaries; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.summaries ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5362 (class 0 OID 17669)
+-- Dependencies: 343
 -- Name: system_logs; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.system_logs ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5264 (class 0 OID 18125)
--- Dependencies: 309
+-- TOC entry 5369 (class 0 OID 50323)
+-- Dependencies: 355
 -- Name: system_settings; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.system_settings ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5426 (class 3256 OID 18669)
+-- TOC entry 5507 (class 3256 OID 36538)
 -- Name: templates templates_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12716,7 +13509,7 @@
 
 
 --
--- TOC entry 5427 (class 3256 OID 18670)
+-- TOC entry 5506 (class 3256 OID 36537)
 -- Name: templates templates_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12724,17 +13517,25 @@
 
 
 --
--- TOC entry 5428 (class 3256 OID 18671)
+-- TOC entry 5508 (class 3256 OID 36539)
 -- Name: templates templates_update; Type: POLICY; Schema: public; Owner: postgres
 --
 
 CREATE POLICY templates_update ON public.templates FOR UPDATE USING (((user_id = auth.uid()) OR ((organization_id IS NOT NULL) AND (EXISTS ( SELECT 1
    FROM public.organization_members om
-  WHERE ((om.organization_id = templates.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY (ARRAY['owner'::text, 'admin'::text]))))))));
+  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()) AND ((om.status)::text = 'active'::text) AND ((om.role)::text = ANY ((ARRAY['owner'::character varying, 'admin'::character varying])::text[]))))))));
 
 
 --
--- TOC entry 5432 (class 3256 OID 18678)
+-- TOC entry 5359 (class 0 OID 17458)
+-- Dependencies: 336
+-- Name: transcripts; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.transcripts ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5474 (class 3256 OID 48054)
 -- Name: transcripts transcripts_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12750,7 +13551,7 @@
 
 
 --
--- TOC entry 5435 (class 3256 OID 18683)
+-- TOC entry 5519 (class 3256 OID 36558)
 -- Name: usage_records usage_records_insert; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12758,7 +13559,7 @@
 
 
 --
--- TOC entry 5436 (class 3256 OID 18684)
+-- TOC entry 5518 (class 3256 OID 36557)
 -- Name: usage_records usage_records_select; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12766,7 +13567,15 @@
 
 
 --
--- TOC entry 5290 (class 3256 OID 18689)
+-- TOC entry 5366 (class 0 OID 30195)
+-- Dependencies: 349
+-- Name: usage_tracking; Type: ROW SECURITY; Schema: public; Owner: postgres
+--
+
+ALTER TABLE public.usage_tracking ENABLE ROW LEVEL SECURITY;
+
+--
+-- TOC entry 5406 (class 3256 OID 36560)
 -- Name: user_app_sessions user_app_sessions_insert_own; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12774,7 +13583,7 @@
 
 
 --
--- TOC entry 5438 (class 3256 OID 18696)
+-- TOC entry 5429 (class 3256 OID 26108)
 -- Name: user_app_sessions user_app_sessions_policy; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12782,7 +13591,7 @@
 
 
 --
--- TOC entry 5291 (class 3256 OID 18690)
+-- TOC entry 5520 (class 3256 OID 36559)
 -- Name: user_app_sessions user_app_sessions_select_own; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12790,7 +13599,7 @@
 
 
 --
--- TOC entry 5292 (class 3256 OID 18691)
+-- TOC entry 5407 (class 3256 OID 36561)
 -- Name: user_app_sessions user_app_sessions_update_own; Type: POLICY; Schema: public; Owner: postgres
 --
 
@@ -12798,87 +13607,87 @@
 
 
 --
--- TOC entry 5267 (class 0 OID 26930)
--- Dependencies: 316
+-- TOC entry 5390 (class 0 OID 76153)
+-- Dependencies: 382
 -- Name: user_credits; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.user_credits ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5270 (class 0 OID 32266)
--- Dependencies: 324
+-- TOC entry 5388 (class 0 OID 73837)
+-- Dependencies: 378
 -- Name: user_preferences; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.user_preferences ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5266 (class 0 OID 26903)
--- Dependencies: 315
+-- TOC entry 5389 (class 0 OID 76129)
+-- Dependencies: 381
 -- Name: user_referrals; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.user_referrals ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5265 (class 0 OID 22096)
--- Dependencies: 312
+-- TOC entry 5386 (class 0 OID 72666)
+-- Dependencies: 376
 -- Name: webhook_logs; Type: ROW SECURITY; Schema: public; Owner: postgres
 --
 
 ALTER TABLE public.webhook_logs ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5244 (class 0 OID 17253)
--- Dependencies: 265
+-- TOC entry 5354 (class 0 OID 17220)
+-- Dependencies: 328
 -- Name: messages; Type: ROW SECURITY; Schema: realtime; Owner: supabase_realtime_admin
 --
 
 ALTER TABLE realtime.messages ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5228 (class 0 OID 16544)
--- Dependencies: 240
+-- TOC entry 5338 (class 0 OID 16533)
+-- Dependencies: 303
 -- Name: buckets; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
 --
 
 ALTER TABLE storage.buckets ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5230 (class 0 OID 16586)
--- Dependencies: 242
+-- TOC entry 5340 (class 0 OID 16575)
+-- Dependencies: 305
 -- Name: migrations; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
 --
 
 ALTER TABLE storage.migrations ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5229 (class 0 OID 16559)
--- Dependencies: 241
+-- TOC entry 5339 (class 0 OID 16548)
+-- Dependencies: 304
 -- Name: objects; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
 --
 
 ALTER TABLE storage.objects ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5242 (class 0 OID 17037)
--- Dependencies: 258
+-- TOC entry 5352 (class 0 OID 17013)
+-- Dependencies: 321
 -- Name: s3_multipart_uploads; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
 --
 
 ALTER TABLE storage.s3_multipart_uploads ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5243 (class 0 OID 17051)
--- Dependencies: 259
+-- TOC entry 5353 (class 0 OID 17027)
+-- Dependencies: 322
 -- Name: s3_multipart_uploads_parts; Type: ROW SECURITY; Schema: storage; Owner: supabase_storage_admin
 --
 
 ALTER TABLE storage.s3_multipart_uploads_parts ENABLE ROW LEVEL SECURITY;
 
 --
--- TOC entry 5460 (class 6104 OID 16426)
+-- TOC entry 5582 (class 6104 OID 16420)
 -- Name: supabase_realtime; Type: PUBLICATION; Schema: -; Owner: postgres
 --
 
@@ -12888,7 +13697,7 @@
 ALTER PUBLICATION supabase_realtime OWNER TO postgres;
 
 --
--- TOC entry 5461 (class 6104 OID 22088)
+-- TOC entry 5583 (class 6104 OID 52735)
 -- Name: supabase_realtime_messages_publication; Type: PUBLICATION; Schema: -; Owner: supabase_admin
 --
 
@@ -12898,7 +13707,7 @@
 ALTER PUBLICATION supabase_realtime_messages_publication OWNER TO supabase_admin;
 
 --
--- TOC entry 5462 (class 6106 OID 22089)
+-- TOC entry 5584 (class 6106 OID 52736)
 -- Name: supabase_realtime_messages_publication messages; Type: PUBLICATION TABLE; Schema: realtime; Owner: supabase_admin
 --
 
@@ -12906,8 +13715,8 @@
 
 
 --
--- TOC entry 5468 (class 0 OID 0)
--- Dependencies: 19
+-- TOC entry 5590 (class 0 OID 0)
+-- Dependencies: 37
 -- Name: SCHEMA auth; Type: ACL; Schema: -; Owner: supabase_admin
 --
 
@@ -12920,8 +13729,8 @@
 
 
 --
--- TOC entry 5469 (class 0 OID 0)
--- Dependencies: 15
+-- TOC entry 5591 (class 0 OID 0)
+-- Dependencies: 23
 -- Name: SCHEMA extensions; Type: ACL; Schema: -; Owner: postgres
 --
 
@@ -12932,8 +13741,8 @@
 
 
 --
--- TOC entry 5470 (class 0 OID 0)
--- Dependencies: 13
+-- TOC entry 5592 (class 0 OID 0)
+-- Dependencies: 86
 -- Name: SCHEMA public; Type: ACL; Schema: -; Owner: pg_database_owner
 --
 
@@ -12944,8 +13753,8 @@
 
 
 --
--- TOC entry 5471 (class 0 OID 0)
--- Dependencies: 20
+-- TOC entry 5593 (class 0 OID 0)
+-- Dependencies: 41
 -- Name: SCHEMA realtime; Type: ACL; Schema: -; Owner: supabase_admin
 --
 
@@ -12957,8 +13766,8 @@
 
 
 --
--- TOC entry 5472 (class 0 OID 0)
--- Dependencies: 18
+-- TOC entry 5594 (class 0 OID 0)
+-- Dependencies: 36
 -- Name: SCHEMA storage; Type: ACL; Schema: -; Owner: supabase_admin
 --
 
@@ -12971,8 +13780,8 @@
 
 
 --
--- TOC entry 5473 (class 0 OID 0)
--- Dependencies: 14
+-- TOC entry 5595 (class 0 OID 0)
+-- Dependencies: 32
 -- Name: SCHEMA vault; Type: ACL; Schema: -; Owner: supabase_admin
 --
 
@@ -12981,8 +13790,8 @@
 
 
 --
--- TOC entry 5480 (class 0 OID 0)
--- Dependencies: 514
+-- TOC entry 5602 (class 0 OID 0)
+-- Dependencies: 505
 -- Name: FUNCTION halfvec_in(cstring, oid, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -12993,8 +13802,8 @@
 
 
 --
--- TOC entry 5481 (class 0 OID 0)
--- Dependencies: 515
+-- TOC entry 5603 (class 0 OID 0)
+-- Dependencies: 506
 -- Name: FUNCTION halfvec_out(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13005,8 +13814,8 @@
 
 
 --
--- TOC entry 5482 (class 0 OID 0)
--- Dependencies: 517
+-- TOC entry 5604 (class 0 OID 0)
+-- Dependencies: 514
 -- Name: FUNCTION halfvec_recv(internal, oid, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13017,8 +13826,8 @@
 
 
 --
--- TOC entry 5483 (class 0 OID 0)
--- Dependencies: 518
+-- TOC entry 5605 (class 0 OID 0)
+-- Dependencies: 515
 -- Name: FUNCTION halfvec_send(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13029,8 +13838,8 @@
 
 
 --
--- TOC entry 5484 (class 0 OID 0)
--- Dependencies: 516
+-- TOC entry 5606 (class 0 OID 0)
+-- Dependencies: 511
 -- Name: FUNCTION halfvec_typmod_in(cstring[]); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13041,8 +13850,8 @@
 
 
 --
--- TOC entry 5486 (class 0 OID 0)
--- Dependencies: 555
+-- TOC entry 5607 (class 0 OID 0)
+-- Dependencies: 565
 -- Name: FUNCTION sparsevec_in(cstring, oid, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13053,8 +13862,8 @@
 
 
 --
--- TOC entry 5487 (class 0 OID 0)
--- Dependencies: 556
+-- TOC entry 5608 (class 0 OID 0)
+-- Dependencies: 568
 -- Name: FUNCTION sparsevec_out(public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13065,8 +13874,8 @@
 
 
 --
--- TOC entry 5488 (class 0 OID 0)
--- Dependencies: 558
+-- TOC entry 5609 (class 0 OID 0)
+-- Dependencies: 570
 -- Name: FUNCTION sparsevec_recv(internal, oid, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13077,8 +13886,8 @@
 
 
 --
--- TOC entry 5489 (class 0 OID 0)
--- Dependencies: 559
+-- TOC entry 5610 (class 0 OID 0)
+-- Dependencies: 573
 -- Name: FUNCTION sparsevec_send(public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13089,8 +13898,8 @@
 
 
 --
--- TOC entry 5490 (class 0 OID 0)
--- Dependencies: 557
+-- TOC entry 5611 (class 0 OID 0)
+-- Dependencies: 569
 -- Name: FUNCTION sparsevec_typmod_in(cstring[]); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13101,8 +13910,8 @@
 
 
 --
--- TOC entry 5491 (class 0 OID 0)
--- Dependencies: 470
+-- TOC entry 5612 (class 0 OID 0)
+-- Dependencies: 401
 -- Name: FUNCTION vector_in(cstring, oid, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13113,8 +13922,8 @@
 
 
 --
--- TOC entry 5492 (class 0 OID 0)
--- Dependencies: 471
+-- TOC entry 5613 (class 0 OID 0)
+-- Dependencies: 403
 -- Name: FUNCTION vector_out(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13125,8 +13934,8 @@
 
 
 --
--- TOC entry 5493 (class 0 OID 0)
--- Dependencies: 473
+-- TOC entry 5614 (class 0 OID 0)
+-- Dependencies: 405
 -- Name: FUNCTION vector_recv(internal, oid, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13137,8 +13946,8 @@
 
 
 --
--- TOC entry 5494 (class 0 OID 0)
--- Dependencies: 474
+-- TOC entry 5615 (class 0 OID 0)
+-- Dependencies: 406
 -- Name: FUNCTION vector_send(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13149,8 +13958,8 @@
 
 
 --
--- TOC entry 5495 (class 0 OID 0)
--- Dependencies: 472
+-- TOC entry 5616 (class 0 OID 0)
+-- Dependencies: 404
 -- Name: FUNCTION vector_typmod_in(cstring[]); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13161,8 +13970,8 @@
 
 
 --
--- TOC entry 5496 (class 0 OID 0)
--- Dependencies: 549
+-- TOC entry 5617 (class 0 OID 0)
+-- Dependencies: 559
 -- Name: FUNCTION array_to_halfvec(real[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13173,8 +13982,8 @@
 
 
 --
--- TOC entry 5497 (class 0 OID 0)
--- Dependencies: 581
+-- TOC entry 5618 (class 0 OID 0)
+-- Dependencies: 637
 -- Name: FUNCTION array_to_sparsevec(real[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13185,8 +13994,8 @@
 
 
 --
--- TOC entry 5498 (class 0 OID 0)
--- Dependencies: 503
+-- TOC entry 5619 (class 0 OID 0)
+-- Dependencies: 476
 -- Name: FUNCTION array_to_vector(real[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13197,8 +14006,8 @@
 
 
 --
--- TOC entry 5499 (class 0 OID 0)
--- Dependencies: 550
+-- TOC entry 5620 (class 0 OID 0)
+-- Dependencies: 560
 -- Name: FUNCTION array_to_halfvec(double precision[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13209,8 +14018,8 @@
 
 
 --
--- TOC entry 5500 (class 0 OID 0)
--- Dependencies: 582
+-- TOC entry 5621 (class 0 OID 0)
+-- Dependencies: 638
 -- Name: FUNCTION array_to_sparsevec(double precision[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13221,8 +14030,8 @@
 
 
 --
--- TOC entry 5501 (class 0 OID 0)
--- Dependencies: 504
+-- TOC entry 5622 (class 0 OID 0)
+-- Dependencies: 477
 -- Name: FUNCTION array_to_vector(double precision[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13233,8 +14042,8 @@
 
 
 --
--- TOC entry 5502 (class 0 OID 0)
--- Dependencies: 548
+-- TOC entry 5623 (class 0 OID 0)
+-- Dependencies: 558
 -- Name: FUNCTION array_to_halfvec(integer[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13245,8 +14054,8 @@
 
 
 --
--- TOC entry 5503 (class 0 OID 0)
--- Dependencies: 580
+-- TOC entry 5624 (class 0 OID 0)
+-- Dependencies: 636
 -- Name: FUNCTION array_to_sparsevec(integer[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13257,8 +14066,8 @@
 
 
 --
--- TOC entry 5504 (class 0 OID 0)
--- Dependencies: 502
+-- TOC entry 5625 (class 0 OID 0)
+-- Dependencies: 472
 -- Name: FUNCTION array_to_vector(integer[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13269,8 +14078,8 @@
 
 
 --
--- TOC entry 5505 (class 0 OID 0)
--- Dependencies: 551
+-- TOC entry 5626 (class 0 OID 0)
+-- Dependencies: 561
 -- Name: FUNCTION array_to_halfvec(numeric[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13281,8 +14090,8 @@
 
 
 --
--- TOC entry 5506 (class 0 OID 0)
--- Dependencies: 583
+-- TOC entry 5627 (class 0 OID 0)
+-- Dependencies: 639
 -- Name: FUNCTION array_to_sparsevec(numeric[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13293,8 +14102,8 @@
 
 
 --
--- TOC entry 5507 (class 0 OID 0)
--- Dependencies: 505
+-- TOC entry 5628 (class 0 OID 0)
+-- Dependencies: 478
 -- Name: FUNCTION array_to_vector(numeric[], integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13305,8 +14114,8 @@
 
 
 --
--- TOC entry 5508 (class 0 OID 0)
--- Dependencies: 552
+-- TOC entry 5629 (class 0 OID 0)
+-- Dependencies: 562
 -- Name: FUNCTION halfvec_to_float4(public.halfvec, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13317,8 +14126,8 @@
 
 
 --
--- TOC entry 5509 (class 0 OID 0)
--- Dependencies: 545
+-- TOC entry 5630 (class 0 OID 0)
+-- Dependencies: 555
 -- Name: FUNCTION halfvec(public.halfvec, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13329,8 +14138,8 @@
 
 
 --
--- TOC entry 5510 (class 0 OID 0)
--- Dependencies: 578
+-- TOC entry 5631 (class 0 OID 0)
+-- Dependencies: 631
 -- Name: FUNCTION halfvec_to_sparsevec(public.halfvec, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13341,8 +14150,8 @@
 
 
 --
--- TOC entry 5511 (class 0 OID 0)
--- Dependencies: 546
+-- TOC entry 5632 (class 0 OID 0)
+-- Dependencies: 556
 -- Name: FUNCTION halfvec_to_vector(public.halfvec, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13353,8 +14162,8 @@
 
 
 --
--- TOC entry 5512 (class 0 OID 0)
--- Dependencies: 579
+-- TOC entry 5633 (class 0 OID 0)
+-- Dependencies: 632
 -- Name: FUNCTION sparsevec_to_halfvec(public.sparsevec, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13365,8 +14174,8 @@
 
 
 --
--- TOC entry 5513 (class 0 OID 0)
--- Dependencies: 575
+-- TOC entry 5634 (class 0 OID 0)
+-- Dependencies: 598
 -- Name: FUNCTION sparsevec(public.sparsevec, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13377,8 +14186,8 @@
 
 
 --
--- TOC entry 5514 (class 0 OID 0)
--- Dependencies: 577
+-- TOC entry 5635 (class 0 OID 0)
+-- Dependencies: 622
 -- Name: FUNCTION sparsevec_to_vector(public.sparsevec, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13389,8 +14198,8 @@
 
 
 --
--- TOC entry 5515 (class 0 OID 0)
--- Dependencies: 506
+-- TOC entry 5636 (class 0 OID 0)
+-- Dependencies: 479
 -- Name: FUNCTION vector_to_float4(public.vector, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13401,8 +14210,8 @@
 
 
 --
--- TOC entry 5516 (class 0 OID 0)
--- Dependencies: 547
+-- TOC entry 5637 (class 0 OID 0)
+-- Dependencies: 557
 -- Name: FUNCTION vector_to_halfvec(public.vector, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13413,8 +14222,8 @@
 
 
 --
--- TOC entry 5517 (class 0 OID 0)
--- Dependencies: 576
+-- TOC entry 5638 (class 0 OID 0)
+-- Dependencies: 617
 -- Name: FUNCTION vector_to_sparsevec(public.vector, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13425,8 +14234,8 @@
 
 
 --
--- TOC entry 5518 (class 0 OID 0)
--- Dependencies: 501
+-- TOC entry 5639 (class 0 OID 0)
+-- Dependencies: 469
 -- Name: FUNCTION vector(public.vector, integer, boolean); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -13437,8 +14246,8 @@
 
 
 --
--- TOC entry 5520 (class 0 OID 0)
--- Dependencies: 395
+-- TOC entry 5641 (class 0 OID 0)
+-- Dependencies: 464
 -- Name: FUNCTION email(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -13446,8 +14255,8 @@
 
 
 --
--- TOC entry 5521 (class 0 OID 0)
--- Dependencies: 414
+-- TOC entry 5642 (class 0 OID 0)
+-- Dependencies: 624
 -- Name: FUNCTION jwt(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -13456,8 +14265,8 @@
 
 
 --
--- TOC entry 5523 (class 0 OID 0)
--- Dependencies: 394
+-- TOC entry 5644 (class 0 OID 0)
+-- Dependencies: 463
 -- Name: FUNCTION role(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -13465,8 +14274,8 @@
 
 
 --
--- TOC entry 5525 (class 0 OID 0)
--- Dependencies: 393
+-- TOC entry 5646 (class 0 OID 0)
+-- Dependencies: 462
 -- Name: FUNCTION uid(); Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -13474,8 +14283,8 @@
 
 
 --
--- TOC entry 5526 (class 0 OID 0)
--- Dependencies: 389
+-- TOC entry 5647 (class 0 OID 0)
+-- Dependencies: 612
 -- Name: FUNCTION armor(bytea); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13485,8 +14294,8 @@
 
 
 --
--- TOC entry 5527 (class 0 OID 0)
--- Dependencies: 390
+-- TOC entry 5648 (class 0 OID 0)
+-- Dependencies: 613
 -- Name: FUNCTION armor(bytea, text[], text[]); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13496,8 +14305,8 @@
 
 
 --
--- TOC entry 5528 (class 0 OID 0)
--- Dependencies: 361
+-- TOC entry 5649 (class 0 OID 0)
+-- Dependencies: 494
 -- Name: FUNCTION crypt(text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13507,8 +14316,8 @@
 
 
 --
--- TOC entry 5529 (class 0 OID 0)
--- Dependencies: 391
+-- TOC entry 5650 (class 0 OID 0)
+-- Dependencies: 614
 -- Name: FUNCTION dearmor(text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13518,8 +14327,8 @@
 
 
 --
--- TOC entry 5530 (class 0 OID 0)
--- Dependencies: 365
+-- TOC entry 5651 (class 0 OID 0)
+-- Dependencies: 498
 -- Name: FUNCTION decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13529,8 +14338,8 @@
 
 
 --
--- TOC entry 5531 (class 0 OID 0)
--- Dependencies: 367
+-- TOC entry 5652 (class 0 OID 0)
+-- Dependencies: 481
 -- Name: FUNCTION decrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13540,8 +14349,8 @@
 
 
 --
--- TOC entry 5532 (class 0 OID 0)
--- Dependencies: 358
+-- TOC entry 5653 (class 0 OID 0)
+-- Dependencies: 491
 -- Name: FUNCTION digest(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13551,8 +14360,8 @@
 
 
 --
--- TOC entry 5533 (class 0 OID 0)
--- Dependencies: 357
+-- TOC entry 5654 (class 0 OID 0)
+-- Dependencies: 490
 -- Name: FUNCTION digest(text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13562,8 +14371,8 @@
 
 
 --
--- TOC entry 5534 (class 0 OID 0)
--- Dependencies: 364
+-- TOC entry 5655 (class 0 OID 0)
+-- Dependencies: 497
 -- Name: FUNCTION encrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13573,8 +14382,8 @@
 
 
 --
--- TOC entry 5535 (class 0 OID 0)
--- Dependencies: 366
+-- TOC entry 5656 (class 0 OID 0)
+-- Dependencies: 499
 -- Name: FUNCTION encrypt_iv(bytea, bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13584,8 +14393,8 @@
 
 
 --
--- TOC entry 5536 (class 0 OID 0)
--- Dependencies: 368
+-- TOC entry 5657 (class 0 OID 0)
+-- Dependencies: 452
 -- Name: FUNCTION gen_random_bytes(integer); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13595,8 +14404,8 @@
 
 
 --
--- TOC entry 5537 (class 0 OID 0)
--- Dependencies: 369
+-- TOC entry 5658 (class 0 OID 0)
+-- Dependencies: 453
 -- Name: FUNCTION gen_random_uuid(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13606,8 +14415,8 @@
 
 
 --
--- TOC entry 5538 (class 0 OID 0)
--- Dependencies: 362
+-- TOC entry 5659 (class 0 OID 0)
+-- Dependencies: 495
 -- Name: FUNCTION gen_salt(text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13617,8 +14426,8 @@
 
 
 --
--- TOC entry 5539 (class 0 OID 0)
--- Dependencies: 363
+-- TOC entry 5660 (class 0 OID 0)
+-- Dependencies: 496
 -- Name: FUNCTION gen_salt(text, integer); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13628,8 +14437,8 @@
 
 
 --
--- TOC entry 5541 (class 0 OID 0)
--- Dependencies: 396
+-- TOC entry 5662 (class 0 OID 0)
+-- Dependencies: 623
 -- Name: FUNCTION grant_pg_cron_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -13639,8 +14448,8 @@
 
 
 --
--- TOC entry 5543 (class 0 OID 0)
--- Dependencies: 400
+-- TOC entry 5664 (class 0 OID 0)
+-- Dependencies: 543
 -- Name: FUNCTION grant_pg_graphql_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -13648,8 +14457,8 @@
 
 
 --
--- TOC entry 5545 (class 0 OID 0)
--- Dependencies: 397
+-- TOC entry 5666 (class 0 OID 0)
+-- Dependencies: 529
 -- Name: FUNCTION grant_pg_net_access(); Type: ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -13659,8 +14468,8 @@
 
 
 --
--- TOC entry 5546 (class 0 OID 0)
--- Dependencies: 360
+-- TOC entry 5667 (class 0 OID 0)
+-- Dependencies: 493
 -- Name: FUNCTION hmac(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13670,8 +14479,8 @@
 
 
 --
--- TOC entry 5547 (class 0 OID 0)
--- Dependencies: 359
+-- TOC entry 5668 (class 0 OID 0)
+-- Dependencies: 492
 -- Name: FUNCTION hmac(text, text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13681,19 +14490,19 @@
 
 
 --
--- TOC entry 5548 (class 0 OID 0)
--- Dependencies: 345
--- Name: FUNCTION pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone); Type: ACL; Schema: extensions; Owner: postgres
+-- TOC entry 5669 (class 0 OID 0)
+-- Dependencies: 620
+-- Name: FUNCTION pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT blk_read_time double precision, OUT blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision); Type: ACL; Schema: extensions; Owner: postgres
 --
 
-REVOKE ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) FROM postgres;
-GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) TO postgres WITH GRANT OPTION;
-GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone) TO dashboard_user;
+REVOKE ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT blk_read_time double precision, OUT blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision) FROM postgres;
+GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT blk_read_time double precision, OUT blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision) TO postgres WITH GRANT OPTION;
+GRANT ALL ON FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT blk_read_time double precision, OUT blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision) TO dashboard_user;
 
 
 --
--- TOC entry 5549 (class 0 OID 0)
--- Dependencies: 344
+-- TOC entry 5670 (class 0 OID 0)
+-- Dependencies: 619
 -- Name: FUNCTION pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13703,19 +14512,19 @@
 
 
 --
--- TOC entry 5550 (class 0 OID 0)
--- Dependencies: 346
--- Name: FUNCTION pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean); Type: ACL; Schema: extensions; Owner: postgres
+-- TOC entry 5671 (class 0 OID 0)
+-- Dependencies: 618
+-- Name: FUNCTION pg_stat_statements_reset(userid oid, dbid oid, queryid bigint); Type: ACL; Schema: extensions; Owner: postgres
 --
 
-REVOKE ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) FROM postgres;
-GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) TO postgres WITH GRANT OPTION;
-GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint, minmax_only boolean) TO dashboard_user;
+REVOKE ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint) FROM postgres;
+GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint) TO postgres WITH GRANT OPTION;
+GRANT ALL ON FUNCTION extensions.pg_stat_statements_reset(userid oid, dbid oid, queryid bigint) TO dashboard_user;
 
 
 --
--- TOC entry 5551 (class 0 OID 0)
--- Dependencies: 392
+-- TOC entry 5672 (class 0 OID 0)
+-- Dependencies: 615
 -- Name: FUNCTION pgp_armor_headers(text, OUT key text, OUT value text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13725,8 +14534,8 @@
 
 
 --
--- TOC entry 5552 (class 0 OID 0)
--- Dependencies: 388
+-- TOC entry 5673 (class 0 OID 0)
+-- Dependencies: 611
 -- Name: FUNCTION pgp_key_id(bytea); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13736,8 +14545,8 @@
 
 
 --
--- TOC entry 5553 (class 0 OID 0)
--- Dependencies: 382
+-- TOC entry 5674 (class 0 OID 0)
+-- Dependencies: 605
 -- Name: FUNCTION pgp_pub_decrypt(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13747,8 +14556,8 @@
 
 
 --
--- TOC entry 5554 (class 0 OID 0)
--- Dependencies: 384
+-- TOC entry 5675 (class 0 OID 0)
+-- Dependencies: 607
 -- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13758,8 +14567,8 @@
 
 
 --
--- TOC entry 5555 (class 0 OID 0)
--- Dependencies: 386
+-- TOC entry 5676 (class 0 OID 0)
+-- Dependencies: 609
 -- Name: FUNCTION pgp_pub_decrypt(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13769,8 +14578,8 @@
 
 
 --
--- TOC entry 5556 (class 0 OID 0)
--- Dependencies: 383
+-- TOC entry 5677 (class 0 OID 0)
+-- Dependencies: 606
 -- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13780,8 +14589,8 @@
 
 
 --
--- TOC entry 5557 (class 0 OID 0)
--- Dependencies: 385
+-- TOC entry 5678 (class 0 OID 0)
+-- Dependencies: 608
 -- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13791,8 +14600,8 @@
 
 
 --
--- TOC entry 5558 (class 0 OID 0)
--- Dependencies: 387
+-- TOC entry 5679 (class 0 OID 0)
+-- Dependencies: 610
 -- Name: FUNCTION pgp_pub_decrypt_bytea(bytea, bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13802,8 +14611,8 @@
 
 
 --
--- TOC entry 5559 (class 0 OID 0)
--- Dependencies: 378
+-- TOC entry 5680 (class 0 OID 0)
+-- Dependencies: 601
 -- Name: FUNCTION pgp_pub_encrypt(text, bytea); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13813,8 +14622,8 @@
 
 
 --
--- TOC entry 5560 (class 0 OID 0)
--- Dependencies: 380
+-- TOC entry 5681 (class 0 OID 0)
+-- Dependencies: 603
 -- Name: FUNCTION pgp_pub_encrypt(text, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13824,8 +14633,8 @@
 
 
 --
--- TOC entry 5561 (class 0 OID 0)
--- Dependencies: 379
+-- TOC entry 5682 (class 0 OID 0)
+-- Dependencies: 602
 -- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13835,8 +14644,8 @@
 
 
 --
--- TOC entry 5562 (class 0 OID 0)
--- Dependencies: 381
+-- TOC entry 5683 (class 0 OID 0)
+-- Dependencies: 604
 -- Name: FUNCTION pgp_pub_encrypt_bytea(bytea, bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13846,8 +14655,8 @@
 
 
 --
--- TOC entry 5563 (class 0 OID 0)
--- Dependencies: 374
+-- TOC entry 5684 (class 0 OID 0)
+-- Dependencies: 482
 -- Name: FUNCTION pgp_sym_decrypt(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13857,8 +14666,8 @@
 
 
 --
--- TOC entry 5564 (class 0 OID 0)
--- Dependencies: 376
+-- TOC entry 5685 (class 0 OID 0)
+-- Dependencies: 484
 -- Name: FUNCTION pgp_sym_decrypt(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13868,8 +14677,8 @@
 
 
 --
--- TOC entry 5565 (class 0 OID 0)
--- Dependencies: 375
+-- TOC entry 5686 (class 0 OID 0)
+-- Dependencies: 483
 -- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13879,8 +14688,8 @@
 
 
 --
--- TOC entry 5566 (class 0 OID 0)
--- Dependencies: 377
+-- TOC entry 5687 (class 0 OID 0)
+-- Dependencies: 516
 -- Name: FUNCTION pgp_sym_decrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13890,8 +14699,8 @@
 
 
 --
--- TOC entry 5567 (class 0 OID 0)
--- Dependencies: 370
+-- TOC entry 5688 (class 0 OID 0)
+-- Dependencies: 454
 -- Name: FUNCTION pgp_sym_encrypt(text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13901,8 +14710,8 @@
 
 
 --
--- TOC entry 5568 (class 0 OID 0)
--- Dependencies: 372
+-- TOC entry 5689 (class 0 OID 0)
+-- Dependencies: 450
 -- Name: FUNCTION pgp_sym_encrypt(text, text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13912,8 +14721,8 @@
 
 
 --
--- TOC entry 5569 (class 0 OID 0)
--- Dependencies: 371
+-- TOC entry 5690 (class 0 OID 0)
+-- Dependencies: 449
 -- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13923,8 +14732,8 @@
 
 
 --
--- TOC entry 5570 (class 0 OID 0)
--- Dependencies: 373
+-- TOC entry 5691 (class 0 OID 0)
+-- Dependencies: 451
 -- Name: FUNCTION pgp_sym_encrypt_bytea(bytea, text, text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13934,8 +14743,8 @@
 
 
 --
--- TOC entry 5571 (class 0 OID 0)
--- Dependencies: 398
+-- TOC entry 5692 (class 0 OID 0)
+-- Dependencies: 541
 -- Name: FUNCTION pgrst_ddl_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -13943,8 +14752,8 @@
 
 
 --
--- TOC entry 5572 (class 0 OID 0)
--- Dependencies: 399
+-- TOC entry 5693 (class 0 OID 0)
+-- Dependencies: 523
 -- Name: FUNCTION pgrst_drop_watch(); Type: ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -13952,8 +14761,8 @@
 
 
 --
--- TOC entry 5574 (class 0 OID 0)
--- Dependencies: 401
+-- TOC entry 5695 (class 0 OID 0)
+-- Dependencies: 621
 -- Name: FUNCTION set_graphql_placeholder(); Type: ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -13961,8 +14770,8 @@
 
 
 --
--- TOC entry 5575 (class 0 OID 0)
--- Dependencies: 352
+-- TOC entry 5696 (class 0 OID 0)
+-- Dependencies: 470
 -- Name: FUNCTION uuid_generate_v1(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13972,8 +14781,8 @@
 
 
 --
--- TOC entry 5576 (class 0 OID 0)
--- Dependencies: 353
+-- TOC entry 5697 (class 0 OID 0)
+-- Dependencies: 458
 -- Name: FUNCTION uuid_generate_v1mc(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13983,8 +14792,8 @@
 
 
 --
--- TOC entry 5577 (class 0 OID 0)
--- Dependencies: 354
+-- TOC entry 5698 (class 0 OID 0)
+-- Dependencies: 488
 -- Name: FUNCTION uuid_generate_v3(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -13994,8 +14803,8 @@
 
 
 --
--- TOC entry 5578 (class 0 OID 0)
--- Dependencies: 355
+-- TOC entry 5699 (class 0 OID 0)
+-- Dependencies: 420
 -- Name: FUNCTION uuid_generate_v4(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -14005,8 +14814,8 @@
 
 
 --
--- TOC entry 5579 (class 0 OID 0)
--- Dependencies: 356
+-- TOC entry 5700 (class 0 OID 0)
+-- Dependencies: 489
 -- Name: FUNCTION uuid_generate_v5(namespace uuid, name text); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -14016,8 +14825,8 @@
 
 
 --
--- TOC entry 5580 (class 0 OID 0)
--- Dependencies: 347
+-- TOC entry 5701 (class 0 OID 0)
+-- Dependencies: 459
 -- Name: FUNCTION uuid_nil(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -14027,8 +14836,8 @@
 
 
 --
--- TOC entry 5581 (class 0 OID 0)
--- Dependencies: 348
+-- TOC entry 5702 (class 0 OID 0)
+-- Dependencies: 460
 -- Name: FUNCTION uuid_ns_dns(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -14038,8 +14847,8 @@
 
 
 --
--- TOC entry 5582 (class 0 OID 0)
--- Dependencies: 350
+-- TOC entry 5703 (class 0 OID 0)
+-- Dependencies: 467
 -- Name: FUNCTION uuid_ns_oid(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -14049,8 +14858,8 @@
 
 
 --
--- TOC entry 5583 (class 0 OID 0)
--- Dependencies: 349
+-- TOC entry 5704 (class 0 OID 0)
+-- Dependencies: 466
 -- Name: FUNCTION uuid_ns_url(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -14060,8 +14869,8 @@
 
 
 --
--- TOC entry 5584 (class 0 OID 0)
--- Dependencies: 351
+-- TOC entry 5705 (class 0 OID 0)
+-- Dependencies: 468
 -- Name: FUNCTION uuid_ns_x500(); Type: ACL; Schema: extensions; Owner: postgres
 --
 
@@ -14071,8 +14880,8 @@
 
 
 --
--- TOC entry 5585 (class 0 OID 0)
--- Dependencies: 413
+-- TOC entry 5706 (class 0 OID 0)
+-- Dependencies: 526
 -- Name: FUNCTION graphql("operationName" text, query text, variables jsonb, extensions jsonb); Type: ACL; Schema: graphql_public; Owner: supabase_admin
 --
 
@@ -14083,8 +14892,8 @@
 
 
 --
--- TOC entry 5586 (class 0 OID 0)
--- Dependencies: 343
+-- TOC entry 5707 (class 0 OID 0)
+-- Dependencies: 399
 -- Name: FUNCTION get_auth(p_usename text); Type: ACL; Schema: pgbouncer; Owner: supabase_admin
 --
 
@@ -14094,8 +14903,8 @@
 
 
 --
--- TOC entry 5587 (class 0 OID 0)
--- Dependencies: 446
+-- TOC entry 5708 (class 0 OID 0)
+-- Dependencies: 448
 -- Name: FUNCTION auto_complete_orphaned_recordings(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14105,8 +14914,8 @@
 
 
 --
--- TOC entry 5588 (class 0 OID 0)
--- Dependencies: 526
+-- TOC entry 5709 (class 0 OID 0)
+-- Dependencies: 530
 -- Name: FUNCTION binary_quantize(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14117,8 +14926,8 @@
 
 
 --
--- TOC entry 5589 (class 0 OID 0)
--- Dependencies: 482
+-- TOC entry 5710 (class 0 OID 0)
+-- Dependencies: 417
 -- Name: FUNCTION binary_quantize(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14129,8 +14938,8 @@
 
 
 --
--- TOC entry 5590 (class 0 OID 0)
--- Dependencies: 454
+-- TOC entry 5711 (class 0 OID 0)
+-- Dependencies: 397
 -- Name: FUNCTION calculate_bot_usage_metrics(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14140,41 +14949,41 @@
 
 
 --
--- TOC entry 5591 (class 0 OID 0)
--- Dependencies: 457
--- Name: FUNCTION cancel_old_subscriptions(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5712 (class 0 OID 0)
+-- Dependencies: 400
+-- Name: FUNCTION can_access_session(p_session_id uuid, p_user_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.cancel_old_subscriptions() TO anon;
-GRANT ALL ON FUNCTION public.cancel_old_subscriptions() TO authenticated;
-GRANT ALL ON FUNCTION public.cancel_old_subscriptions() TO service_role;
+GRANT ALL ON FUNCTION public.can_access_session(p_session_id uuid, p_user_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.can_access_session(p_session_id uuid, p_user_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.can_access_session(p_session_id uuid, p_user_id uuid) TO service_role;
 
 
 --
--- TOC entry 5593 (class 0 OID 0)
--- Dependencies: 451
--- Name: FUNCTION check_and_enforce_bot_limits(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5713 (class 0 OID 0)
+-- Dependencies: 647
+-- Name: FUNCTION cancel_old_subscriptions(); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.check_and_enforce_bot_limits() TO anon;
-GRANT ALL ON FUNCTION public.check_and_enforce_bot_limits() TO authenticated;
-GRANT ALL ON FUNCTION public.check_and_enforce_bot_limits() TO service_role;
+GRANT ALL ON FUNCTION public.cancel_old_subscriptions() TO anon;
+GRANT ALL ON FUNCTION public.cancel_old_subscriptions() TO authenticated;
+GRANT ALL ON FUNCTION public.cancel_old_subscriptions() TO service_role;
 
 
 --
--- TOC entry 5594 (class 0 OID 0)
--- Dependencies: 459
--- Name: FUNCTION check_referral_limits(p_referrer_id uuid, p_ip_address inet, p_device_id text); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5715 (class 0 OID 0)
+-- Dependencies: 510
+-- Name: FUNCTION check_single_owner_org_per_user(); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.check_referral_limits(p_referrer_id uuid, p_ip_address inet, p_device_id text) TO anon;
-GRANT ALL ON FUNCTION public.check_referral_limits(p_referrer_id uuid, p_ip_address inet, p_device_id text) TO authenticated;
-GRANT ALL ON FUNCTION public.check_referral_limits(p_referrer_id uuid, p_ip_address inet, p_device_id text) TO service_role;
+GRANT ALL ON FUNCTION public.check_single_owner_org_per_user() TO anon;
+GRANT ALL ON FUNCTION public.check_single_owner_org_per_user() TO authenticated;
+GRANT ALL ON FUNCTION public.check_single_owner_org_per_user() TO service_role;
 
 
 --
--- TOC entry 5595 (class 0 OID 0)
--- Dependencies: 437
+-- TOC entry 5716 (class 0 OID 0)
+-- Dependencies: 520
 -- Name: FUNCTION check_usage_limit(p_user_id uuid, p_organization_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14184,8 +14993,8 @@
 
 
 --
--- TOC entry 5596 (class 0 OID 0)
--- Dependencies: 453
+-- TOC entry 5717 (class 0 OID 0)
+-- Dependencies: 486
 -- Name: FUNCTION check_usage_limit_v2(p_user_id uuid, p_organization_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14195,19 +15004,19 @@
 
 
 --
--- TOC entry 5597 (class 0 OID 0)
--- Dependencies: 450
--- Name: FUNCTION check_webhook_health(hours_back integer); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5718 (class 0 OID 0)
+-- Dependencies: 552
+-- Name: FUNCTION cleanup_old_usage_data(months_to_keep integer); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.check_webhook_health(hours_back integer) TO anon;
-GRANT ALL ON FUNCTION public.check_webhook_health(hours_back integer) TO authenticated;
-GRANT ALL ON FUNCTION public.check_webhook_health(hours_back integer) TO service_role;
+GRANT ALL ON FUNCTION public.cleanup_old_usage_data(months_to_keep integer) TO anon;
+GRANT ALL ON FUNCTION public.cleanup_old_usage_data(months_to_keep integer) TO authenticated;
+GRANT ALL ON FUNCTION public.cleanup_old_usage_data(months_to_keep integer) TO service_role;
 
 
 --
--- TOC entry 5599 (class 0 OID 0)
--- Dependencies: 464
+-- TOC entry 5719 (class 0 OID 0)
+-- Dependencies: 532
 -- Name: FUNCTION complete_referral(p_referee_id uuid, p_payment_intent_id text); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14217,7 +15026,7 @@
 
 
 --
--- TOC entry 5600 (class 0 OID 0)
+-- TOC entry 5720 (class 0 OID 0)
 -- Dependencies: 521
 -- Name: FUNCTION cosine_distance(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
@@ -14229,8 +15038,8 @@
 
 
 --
--- TOC entry 5601 (class 0 OID 0)
--- Dependencies: 562
+-- TOC entry 5721 (class 0 OID 0)
+-- Dependencies: 576
 -- Name: FUNCTION cosine_distance(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14241,8 +15050,8 @@
 
 
 --
--- TOC entry 5602 (class 0 OID 0)
--- Dependencies: 477
+-- TOC entry 5722 (class 0 OID 0)
+-- Dependencies: 409
 -- Name: FUNCTION cosine_distance(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14253,30 +15062,30 @@
 
 
 --
--- TOC entry 5603 (class 0 OID 0)
--- Dependencies: 449
--- Name: FUNCTION create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5724 (class 0 OID 0)
+-- Dependencies: 596
+-- Name: FUNCTION create_default_user_preferences(); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) TO anon;
-GRANT ALL ON FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) TO authenticated;
-GRANT ALL ON FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) TO service_role;
+GRANT ALL ON FUNCTION public.create_default_user_preferences() TO anon;
+GRANT ALL ON FUNCTION public.create_default_user_preferences() TO authenticated;
+GRANT ALL ON FUNCTION public.create_default_user_preferences() TO service_role;
 
 
 --
--- TOC entry 5604 (class 0 OID 0)
--- Dependencies: 462
--- Name: FUNCTION create_user_preferences_for_new_user(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5725 (class 0 OID 0)
+-- Dependencies: 508
+-- Name: FUNCTION create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.create_user_preferences_for_new_user() TO anon;
-GRANT ALL ON FUNCTION public.create_user_preferences_for_new_user() TO authenticated;
-GRANT ALL ON FUNCTION public.create_user_preferences_for_new_user() TO service_role;
+GRANT ALL ON FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) TO anon;
+GRANT ALL ON FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) TO authenticated;
+GRANT ALL ON FUNCTION public.create_meeting_notification(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_type text, p_title text, p_message text, p_action_url text) TO service_role;
 
 
 --
--- TOC entry 5606 (class 0 OID 0)
--- Dependencies: 465
+-- TOC entry 5726 (class 0 OID 0)
+-- Dependencies: 455
 -- Name: FUNCTION generate_referral_code(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14286,8 +15095,8 @@
 
 
 --
--- TOC entry 5608 (class 0 OID 0)
--- Dependencies: 466
+-- TOC entry 5727 (class 0 OID 0)
+-- Dependencies: 487
 -- Name: FUNCTION generate_user_referral_code(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14297,8 +15106,8 @@
 
 
 --
--- TOC entry 5609 (class 0 OID 0)
--- Dependencies: 438
+-- TOC entry 5728 (class 0 OID 0)
+-- Dependencies: 648
 -- Name: FUNCTION get_next_transcript_sequence(session_uuid uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14308,8 +15117,30 @@
 
 
 --
--- TOC entry 5610 (class 0 OID 0)
--- Dependencies: 458
+-- TOC entry 5729 (class 0 OID 0)
+-- Dependencies: 629
+-- Name: FUNCTION get_session_participants(p_session_id uuid); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.get_session_participants(p_session_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.get_session_participants(p_session_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.get_session_participants(p_session_id uuid) TO service_role;
+
+
+--
+-- TOC entry 5730 (class 0 OID 0)
+-- Dependencies: 402
+-- Name: FUNCTION get_unread_mentions_count(p_user_id uuid); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.get_unread_mentions_count(p_user_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.get_unread_mentions_count(p_user_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.get_unread_mentions_count(p_user_id uuid) TO service_role;
+
+
+--
+-- TOC entry 5731 (class 0 OID 0)
+-- Dependencies: 512
 -- Name: FUNCTION get_upcoming_meetings(p_user_id uuid, p_days_ahead integer); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14319,8 +15150,8 @@
 
 
 --
--- TOC entry 5611 (class 0 OID 0)
--- Dependencies: 439
+-- TOC entry 5732 (class 0 OID 0)
+-- Dependencies: 473
 -- Name: FUNCTION get_usage_details(p_user_id uuid, p_organization_id uuid, p_start_date date, p_end_date date); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14330,8 +15161,8 @@
 
 
 --
--- TOC entry 5612 (class 0 OID 0)
--- Dependencies: 445
+-- TOC entry 5733 (class 0 OID 0)
+-- Dependencies: 566
 -- Name: FUNCTION get_user_billing_period(p_user_id uuid, p_organization_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14341,8 +15172,8 @@
 
 
 --
--- TOC entry 5613 (class 0 OID 0)
--- Dependencies: 542
+-- TOC entry 5734 (class 0 OID 0)
+-- Dependencies: 549
 -- Name: FUNCTION halfvec_accum(double precision[], public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14353,8 +15184,8 @@
 
 
 --
--- TOC entry 5614 (class 0 OID 0)
--- Dependencies: 528
+-- TOC entry 5735 (class 0 OID 0)
+-- Dependencies: 533
 -- Name: FUNCTION halfvec_add(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14365,8 +15196,8 @@
 
 
 --
--- TOC entry 5615 (class 0 OID 0)
--- Dependencies: 543
+-- TOC entry 5736 (class 0 OID 0)
+-- Dependencies: 550
 -- Name: FUNCTION halfvec_avg(double precision[]); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14377,8 +15208,8 @@
 
 
 --
--- TOC entry 5616 (class 0 OID 0)
--- Dependencies: 538
+-- TOC entry 5737 (class 0 OID 0)
+-- Dependencies: 545
 -- Name: FUNCTION halfvec_cmp(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14389,8 +15220,8 @@
 
 
 --
--- TOC entry 5617 (class 0 OID 0)
--- Dependencies: 544
+-- TOC entry 5738 (class 0 OID 0)
+-- Dependencies: 554
 -- Name: FUNCTION halfvec_combine(double precision[], double precision[]); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14401,8 +15232,8 @@
 
 
 --
--- TOC entry 5618 (class 0 OID 0)
--- Dependencies: 531
+-- TOC entry 5739 (class 0 OID 0)
+-- Dependencies: 536
 -- Name: FUNCTION halfvec_concat(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14413,8 +15244,8 @@
 
 
 --
--- TOC entry 5619 (class 0 OID 0)
--- Dependencies: 534
+-- TOC entry 5740 (class 0 OID 0)
+-- Dependencies: 539
 -- Name: FUNCTION halfvec_eq(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14425,8 +15256,8 @@
 
 
 --
--- TOC entry 5620 (class 0 OID 0)
--- Dependencies: 536
+-- TOC entry 5741 (class 0 OID 0)
+-- Dependencies: 542
 -- Name: FUNCTION halfvec_ge(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14437,8 +15268,8 @@
 
 
 --
--- TOC entry 5621 (class 0 OID 0)
--- Dependencies: 537
+-- TOC entry 5742 (class 0 OID 0)
+-- Dependencies: 544
 -- Name: FUNCTION halfvec_gt(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14449,8 +15280,8 @@
 
 
 --
--- TOC entry 5622 (class 0 OID 0)
--- Dependencies: 539
+-- TOC entry 5743 (class 0 OID 0)
+-- Dependencies: 546
 -- Name: FUNCTION halfvec_l2_squared_distance(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14461,8 +15292,8 @@
 
 
 --
--- TOC entry 5623 (class 0 OID 0)
--- Dependencies: 533
+-- TOC entry 5744 (class 0 OID 0)
+-- Dependencies: 538
 -- Name: FUNCTION halfvec_le(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14473,8 +15304,8 @@
 
 
 --
--- TOC entry 5624 (class 0 OID 0)
--- Dependencies: 532
+-- TOC entry 5745 (class 0 OID 0)
+-- Dependencies: 537
 -- Name: FUNCTION halfvec_lt(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14485,8 +15316,8 @@
 
 
 --
--- TOC entry 5625 (class 0 OID 0)
--- Dependencies: 530
+-- TOC entry 5746 (class 0 OID 0)
+-- Dependencies: 535
 -- Name: FUNCTION halfvec_mul(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14497,8 +15328,8 @@
 
 
 --
--- TOC entry 5626 (class 0 OID 0)
--- Dependencies: 535
+-- TOC entry 5747 (class 0 OID 0)
+-- Dependencies: 540
 -- Name: FUNCTION halfvec_ne(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14509,8 +15340,8 @@
 
 
 --
--- TOC entry 5627 (class 0 OID 0)
--- Dependencies: 540
+-- TOC entry 5748 (class 0 OID 0)
+-- Dependencies: 547
 -- Name: FUNCTION halfvec_negative_inner_product(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14521,8 +15352,8 @@
 
 
 --
--- TOC entry 5628 (class 0 OID 0)
--- Dependencies: 541
+-- TOC entry 5749 (class 0 OID 0)
+-- Dependencies: 548
 -- Name: FUNCTION halfvec_spherical_distance(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14533,8 +15364,8 @@
 
 
 --
--- TOC entry 5629 (class 0 OID 0)
--- Dependencies: 529
+-- TOC entry 5750 (class 0 OID 0)
+-- Dependencies: 534
 -- Name: FUNCTION halfvec_sub(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14545,8 +15376,8 @@
 
 
 --
--- TOC entry 5630 (class 0 OID 0)
--- Dependencies: 553
+-- TOC entry 5751 (class 0 OID 0)
+-- Dependencies: 563
 -- Name: FUNCTION hamming_distance(bit, bit); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14557,8 +15388,8 @@
 
 
 --
--- TOC entry 5632 (class 0 OID 0)
--- Dependencies: 469
+-- TOC entry 5753 (class 0 OID 0)
+-- Dependencies: 595
 -- Name: FUNCTION handle_new_user(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14568,30 +15399,30 @@
 
 
 --
--- TOC entry 5633 (class 0 OID 0)
--- Dependencies: 460
--- Name: FUNCTION handle_new_user_referral(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5754 (class 0 OID 0)
+-- Dependencies: 588
+-- Name: FUNCTION handle_subscription_renewal(); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.handle_new_user_referral() TO anon;
-GRANT ALL ON FUNCTION public.handle_new_user_referral() TO authenticated;
-GRANT ALL ON FUNCTION public.handle_new_user_referral() TO service_role;
+GRANT ALL ON FUNCTION public.handle_subscription_renewal() TO anon;
+GRANT ALL ON FUNCTION public.handle_subscription_renewal() TO authenticated;
+GRANT ALL ON FUNCTION public.handle_subscription_renewal() TO service_role;
 
 
 --
--- TOC entry 5634 (class 0 OID 0)
--- Dependencies: 456
--- Name: FUNCTION handle_subscription_renewal(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5755 (class 0 OID 0)
+-- Dependencies: 567
+-- Name: FUNCTION handle_updated_at(); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.handle_subscription_renewal() TO anon;
-GRANT ALL ON FUNCTION public.handle_subscription_renewal() TO authenticated;
-GRANT ALL ON FUNCTION public.handle_subscription_renewal() TO service_role;
+GRANT ALL ON FUNCTION public.handle_updated_at() TO anon;
+GRANT ALL ON FUNCTION public.handle_updated_at() TO authenticated;
+GRANT ALL ON FUNCTION public.handle_updated_at() TO service_role;
 
 
 --
--- TOC entry 5635 (class 0 OID 0)
--- Dependencies: 512
+-- TOC entry 5756 (class 0 OID 0)
+-- Dependencies: 503
 -- Name: FUNCTION hnsw_bit_support(internal); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14602,8 +15433,8 @@
 
 
 --
--- TOC entry 5636 (class 0 OID 0)
--- Dependencies: 511
+-- TOC entry 5757 (class 0 OID 0)
+-- Dependencies: 502
 -- Name: FUNCTION hnsw_halfvec_support(internal); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14614,8 +15445,8 @@
 
 
 --
--- TOC entry 5637 (class 0 OID 0)
--- Dependencies: 513
+-- TOC entry 5758 (class 0 OID 0)
+-- Dependencies: 504
 -- Name: FUNCTION hnsw_sparsevec_support(internal); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14626,8 +15457,8 @@
 
 
 --
--- TOC entry 5638 (class 0 OID 0)
--- Dependencies: 508
+-- TOC entry 5759 (class 0 OID 0)
+-- Dependencies: 485
 -- Name: FUNCTION hnswhandler(internal); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14638,19 +15469,19 @@
 
 
 --
--- TOC entry 5639 (class 0 OID 0)
--- Dependencies: 588
--- Name: FUNCTION hybrid_search_sessions(query_embedding public.vector, query_text text, match_threshold double precision, match_count integer, target_user_id uuid); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5760 (class 0 OID 0)
+-- Dependencies: 642
+-- Name: FUNCTION hybrid_search_sessions(query_embedding public.halfvec, query_text text, match_threshold double precision, match_count integer, target_user_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.hybrid_search_sessions(query_embedding public.vector, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) TO anon;
-GRANT ALL ON FUNCTION public.hybrid_search_sessions(query_embedding public.vector, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) TO authenticated;
-GRANT ALL ON FUNCTION public.hybrid_search_sessions(query_embedding public.vector, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) TO service_role;
+GRANT ALL ON FUNCTION public.hybrid_search_sessions(query_embedding public.halfvec, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.hybrid_search_sessions(query_embedding public.halfvec, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.hybrid_search_sessions(query_embedding public.halfvec, query_text text, match_threshold double precision, match_count integer, target_user_id uuid) TO service_role;
 
 
 --
--- TOC entry 5640 (class 0 OID 0)
--- Dependencies: 520
+-- TOC entry 5761 (class 0 OID 0)
+-- Dependencies: 519
 -- Name: FUNCTION inner_product(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14661,8 +15492,8 @@
 
 
 --
--- TOC entry 5641 (class 0 OID 0)
--- Dependencies: 561
+-- TOC entry 5762 (class 0 OID 0)
+-- Dependencies: 575
 -- Name: FUNCTION inner_product(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14673,8 +15504,8 @@
 
 
 --
--- TOC entry 5642 (class 0 OID 0)
--- Dependencies: 476
+-- TOC entry 5763 (class 0 OID 0)
+-- Dependencies: 408
 -- Name: FUNCTION inner_product(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14685,8 +15516,8 @@
 
 
 --
--- TOC entry 5643 (class 0 OID 0)
--- Dependencies: 440
+-- TOC entry 5764 (class 0 OID 0)
+-- Dependencies: 663
 -- Name: FUNCTION is_active_org_member(p_user_id uuid, p_org_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14696,8 +15527,8 @@
 
 
 --
--- TOC entry 5644 (class 0 OID 0)
--- Dependencies: 444
+-- TOC entry 5765 (class 0 OID 0)
+-- Dependencies: 416
 -- Name: FUNCTION is_admin(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14707,8 +15538,19 @@
 
 
 --
--- TOC entry 5645 (class 0 OID 0)
--- Dependencies: 510
+-- TOC entry 5766 (class 0 OID 0)
+-- Dependencies: 513
+-- Name: FUNCTION is_valid_referral_code(code text); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.is_valid_referral_code(code text) TO anon;
+GRANT ALL ON FUNCTION public.is_valid_referral_code(code text) TO authenticated;
+GRANT ALL ON FUNCTION public.is_valid_referral_code(code text) TO service_role;
+
+
+--
+-- TOC entry 5767 (class 0 OID 0)
+-- Dependencies: 501
 -- Name: FUNCTION ivfflat_bit_support(internal); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14719,8 +15561,8 @@
 
 
 --
--- TOC entry 5646 (class 0 OID 0)
--- Dependencies: 509
+-- TOC entry 5768 (class 0 OID 0)
+-- Dependencies: 500
 -- Name: FUNCTION ivfflat_halfvec_support(internal); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14731,8 +15573,8 @@
 
 
 --
--- TOC entry 5647 (class 0 OID 0)
--- Dependencies: 507
+-- TOC entry 5769 (class 0 OID 0)
+-- Dependencies: 480
 -- Name: FUNCTION ivfflathandler(internal); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14743,8 +15585,8 @@
 
 
 --
--- TOC entry 5648 (class 0 OID 0)
--- Dependencies: 554
+-- TOC entry 5770 (class 0 OID 0)
+-- Dependencies: 564
 -- Name: FUNCTION jaccard_distance(bit, bit); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14755,7 +15597,7 @@
 
 
 --
--- TOC entry 5649 (class 0 OID 0)
+-- TOC entry 5771 (class 0 OID 0)
 -- Dependencies: 522
 -- Name: FUNCTION l1_distance(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
@@ -14767,8 +15609,8 @@
 
 
 --
--- TOC entry 5650 (class 0 OID 0)
--- Dependencies: 563
+-- TOC entry 5772 (class 0 OID 0)
+-- Dependencies: 577
 -- Name: FUNCTION l1_distance(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14779,8 +15621,8 @@
 
 
 --
--- TOC entry 5651 (class 0 OID 0)
--- Dependencies: 478
+-- TOC entry 5773 (class 0 OID 0)
+-- Dependencies: 410
 -- Name: FUNCTION l1_distance(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14791,8 +15633,8 @@
 
 
 --
--- TOC entry 5652 (class 0 OID 0)
--- Dependencies: 519
+-- TOC entry 5774 (class 0 OID 0)
+-- Dependencies: 517
 -- Name: FUNCTION l2_distance(public.halfvec, public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14803,8 +15645,8 @@
 
 
 --
--- TOC entry 5653 (class 0 OID 0)
--- Dependencies: 560
+-- TOC entry 5775 (class 0 OID 0)
+-- Dependencies: 574
 -- Name: FUNCTION l2_distance(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14815,8 +15657,8 @@
 
 
 --
--- TOC entry 5654 (class 0 OID 0)
--- Dependencies: 475
+-- TOC entry 5776 (class 0 OID 0)
+-- Dependencies: 407
 -- Name: FUNCTION l2_distance(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14827,8 +15669,8 @@
 
 
 --
--- TOC entry 5655 (class 0 OID 0)
--- Dependencies: 524
+-- TOC entry 5777 (class 0 OID 0)
+-- Dependencies: 525
 -- Name: FUNCTION l2_norm(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14839,8 +15681,8 @@
 
 
 --
--- TOC entry 5656 (class 0 OID 0)
--- Dependencies: 564
+-- TOC entry 5778 (class 0 OID 0)
+-- Dependencies: 578
 -- Name: FUNCTION l2_norm(public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14851,8 +15693,8 @@
 
 
 --
--- TOC entry 5657 (class 0 OID 0)
--- Dependencies: 525
+-- TOC entry 5779 (class 0 OID 0)
+-- Dependencies: 528
 -- Name: FUNCTION l2_normalize(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14863,8 +15705,8 @@
 
 
 --
--- TOC entry 5658 (class 0 OID 0)
--- Dependencies: 565
+-- TOC entry 5780 (class 0 OID 0)
+-- Dependencies: 579
 -- Name: FUNCTION l2_normalize(public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14875,8 +15717,8 @@
 
 
 --
--- TOC entry 5659 (class 0 OID 0)
--- Dependencies: 481
+-- TOC entry 5781 (class 0 OID 0)
+-- Dependencies: 414
 -- Name: FUNCTION l2_normalize(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14887,8 +15729,8 @@
 
 
 --
--- TOC entry 5660 (class 0 OID 0)
--- Dependencies: 448
+-- TOC entry 5782 (class 0 OID 0)
+-- Dependencies: 507
 -- Name: FUNCTION log_auto_join_activity(p_user_id uuid, p_event_id uuid, p_session_id uuid, p_bot_id text, p_action text, p_status text, p_error_message text, p_metadata jsonb); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14898,8 +15740,19 @@
 
 
 --
--- TOC entry 5662 (class 0 OID 0)
--- Dependencies: 467
+-- TOC entry 5783 (class 0 OID 0)
+-- Dependencies: 475
+-- Name: FUNCTION log_comment_activity(); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.log_comment_activity() TO anon;
+GRANT ALL ON FUNCTION public.log_comment_activity() TO authenticated;
+GRANT ALL ON FUNCTION public.log_comment_activity() TO service_role;
+
+
+--
+-- TOC entry 5784 (class 0 OID 0)
+-- Dependencies: 551
 -- Name: FUNCTION log_referral_event(p_event_type public.referral_event_type, p_user_id uuid, p_referrer_id uuid, p_referee_id uuid, p_referral_id uuid, p_referral_code character varying, p_ip_address inet, p_user_agent text, p_device_id character varying, p_event_data jsonb, p_error_message text); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14909,41 +15762,52 @@
 
 
 --
--- TOC entry 5663 (class 0 OID 0)
--- Dependencies: 586
--- Name: FUNCTION match_sessions_by_title(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5785 (class 0 OID 0)
+-- Dependencies: 461
+-- Name: FUNCTION log_task_activity(); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.match_sessions_by_title(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) TO anon;
-GRANT ALL ON FUNCTION public.match_sessions_by_title(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) TO authenticated;
-GRANT ALL ON FUNCTION public.match_sessions_by_title(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) TO service_role;
+GRANT ALL ON FUNCTION public.log_task_activity() TO anon;
+GRANT ALL ON FUNCTION public.log_task_activity() TO authenticated;
+GRANT ALL ON FUNCTION public.log_task_activity() TO service_role;
 
 
 --
--- TOC entry 5664 (class 0 OID 0)
--- Dependencies: 587
--- Name: FUNCTION match_summaries_by_content(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5786 (class 0 OID 0)
+-- Dependencies: 640
+-- Name: FUNCTION match_sessions_by_title(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.match_summaries_by_content(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) TO anon;
-GRANT ALL ON FUNCTION public.match_summaries_by_content(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) TO authenticated;
-GRANT ALL ON FUNCTION public.match_summaries_by_content(query_embedding public.vector, match_threshold double precision, match_count integer, target_user_id uuid) TO service_role;
+GRANT ALL ON FUNCTION public.match_sessions_by_title(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.match_sessions_by_title(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.match_sessions_by_title(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) TO service_role;
 
 
 --
--- TOC entry 5666 (class 0 OID 0)
--- Dependencies: 468
--- Name: FUNCTION process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet, p_user_agent text, p_device_id character varying); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5787 (class 0 OID 0)
+-- Dependencies: 651
+-- Name: FUNCTION match_summaries_by_content(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet, p_user_agent text, p_device_id character varying) TO anon;
-GRANT ALL ON FUNCTION public.process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet, p_user_agent text, p_device_id character varying) TO authenticated;
-GRANT ALL ON FUNCTION public.process_referral_code(p_referral_code character varying, p_referee_email character varying, p_ip_address inet, p_user_agent text, p_device_id character varying) TO service_role;
+GRANT ALL ON FUNCTION public.match_summaries_by_content(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.match_summaries_by_content(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.match_summaries_by_content(query_embedding public.halfvec, match_threshold double precision, match_count integer, target_user_id uuid) TO service_role;
 
 
 --
--- TOC entry 5667 (class 0 OID 0)
--- Dependencies: 584
+-- TOC entry 5788 (class 0 OID 0)
+-- Dependencies: 553
+-- Name: FUNCTION process_referral_code(p_user_id uuid, p_referral_code text, p_device_id text, p_ip_address inet); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.process_referral_code(p_user_id uuid, p_referral_code text, p_device_id text, p_ip_address inet) TO anon;
+GRANT ALL ON FUNCTION public.process_referral_code(p_user_id uuid, p_referral_code text, p_device_id text, p_ip_address inet) TO authenticated;
+GRANT ALL ON FUNCTION public.process_referral_code(p_user_id uuid, p_referral_code text, p_device_id text, p_ip_address inet) TO service_role;
+
+
+--
+-- TOC entry 5789 (class 0 OID 0)
+-- Dependencies: 650
 -- Name: FUNCTION queue_session_embedding(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14953,8 +15817,8 @@
 
 
 --
--- TOC entry 5668 (class 0 OID 0)
--- Dependencies: 585
+-- TOC entry 5790 (class 0 OID 0)
+-- Dependencies: 641
 -- Name: FUNCTION queue_summary_embedding(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14964,8 +15828,8 @@
 
 
 --
--- TOC entry 5669 (class 0 OID 0)
--- Dependencies: 441
+-- TOC entry 5791 (class 0 OID 0)
+-- Dependencies: 662
 -- Name: FUNCTION set_transcript_sequence_number(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14975,8 +15839,8 @@
 
 
 --
--- TOC entry 5670 (class 0 OID 0)
--- Dependencies: 447
+-- TOC entry 5792 (class 0 OID 0)
+-- Dependencies: 509
 -- Name: FUNCTION should_auto_join_meeting(p_event_id uuid, p_user_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -14986,8 +15850,8 @@
 
 
 --
--- TOC entry 5671 (class 0 OID 0)
--- Dependencies: 572
+-- TOC entry 5793 (class 0 OID 0)
+-- Dependencies: 586
 -- Name: FUNCTION sparsevec_cmp(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -14998,8 +15862,8 @@
 
 
 --
--- TOC entry 5672 (class 0 OID 0)
--- Dependencies: 568
+-- TOC entry 5794 (class 0 OID 0)
+-- Dependencies: 582
 -- Name: FUNCTION sparsevec_eq(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15010,8 +15874,8 @@
 
 
 --
--- TOC entry 5673 (class 0 OID 0)
--- Dependencies: 570
+-- TOC entry 5795 (class 0 OID 0)
+-- Dependencies: 584
 -- Name: FUNCTION sparsevec_ge(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15022,8 +15886,8 @@
 
 
 --
--- TOC entry 5674 (class 0 OID 0)
--- Dependencies: 571
+-- TOC entry 5796 (class 0 OID 0)
+-- Dependencies: 585
 -- Name: FUNCTION sparsevec_gt(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15034,8 +15898,8 @@
 
 
 --
--- TOC entry 5675 (class 0 OID 0)
--- Dependencies: 573
+-- TOC entry 5797 (class 0 OID 0)
+-- Dependencies: 587
 -- Name: FUNCTION sparsevec_l2_squared_distance(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15046,8 +15910,8 @@
 
 
 --
--- TOC entry 5676 (class 0 OID 0)
--- Dependencies: 567
+-- TOC entry 5798 (class 0 OID 0)
+-- Dependencies: 581
 -- Name: FUNCTION sparsevec_le(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15058,8 +15922,8 @@
 
 
 --
--- TOC entry 5677 (class 0 OID 0)
--- Dependencies: 566
+-- TOC entry 5799 (class 0 OID 0)
+-- Dependencies: 580
 -- Name: FUNCTION sparsevec_lt(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15070,8 +15934,8 @@
 
 
 --
--- TOC entry 5678 (class 0 OID 0)
--- Dependencies: 569
+-- TOC entry 5800 (class 0 OID 0)
+-- Dependencies: 583
 -- Name: FUNCTION sparsevec_ne(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15082,8 +15946,8 @@
 
 
 --
--- TOC entry 5679 (class 0 OID 0)
--- Dependencies: 574
+-- TOC entry 5801 (class 0 OID 0)
+-- Dependencies: 597
 -- Name: FUNCTION sparsevec_negative_inner_product(public.sparsevec, public.sparsevec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15094,19 +15958,8 @@
 
 
 --
--- TOC entry 5680 (class 0 OID 0)
--- Dependencies: 452
--- Name: FUNCTION start_bot_grace_period(p_bot_id text); Type: ACL; Schema: public; Owner: postgres
---
-
-GRANT ALL ON FUNCTION public.start_bot_grace_period(p_bot_id text) TO anon;
-GRANT ALL ON FUNCTION public.start_bot_grace_period(p_bot_id text) TO authenticated;
-GRANT ALL ON FUNCTION public.start_bot_grace_period(p_bot_id text) TO service_role;
-
-
---
--- TOC entry 5681 (class 0 OID 0)
--- Dependencies: 527
+-- TOC entry 5802 (class 0 OID 0)
+-- Dependencies: 531
 -- Name: FUNCTION subvector(public.halfvec, integer, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15117,8 +15970,8 @@
 
 
 --
--- TOC entry 5682 (class 0 OID 0)
--- Dependencies: 483
+-- TOC entry 5803 (class 0 OID 0)
+-- Dependencies: 418
 -- Name: FUNCTION subvector(public.vector, integer, integer); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15129,8 +15982,19 @@
 
 
 --
--- TOC entry 5683 (class 0 OID 0)
--- Dependencies: 455
+-- TOC entry 5804 (class 0 OID 0)
+-- Dependencies: 616
+-- Name: FUNCTION sync_session_participants(); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.sync_session_participants() TO anon;
+GRANT ALL ON FUNCTION public.sync_session_participants() TO authenticated;
+GRANT ALL ON FUNCTION public.sync_session_participants() TO service_role;
+
+
+--
+-- TOC entry 5805 (class 0 OID 0)
+-- Dependencies: 474
 -- Name: FUNCTION sync_subscription_limits(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -15140,19 +16004,74 @@
 
 
 --
--- TOC entry 5684 (class 0 OID 0)
--- Dependencies: 461
--- Name: FUNCTION update_email_notifications_updated_at(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5806 (class 0 OID 0)
+-- Dependencies: 471
+-- Name: FUNCTION test_user_access(test_user_id uuid); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.update_email_notifications_updated_at() TO anon;
-GRANT ALL ON FUNCTION public.update_email_notifications_updated_at() TO authenticated;
-GRANT ALL ON FUNCTION public.update_email_notifications_updated_at() TO service_role;
+GRANT ALL ON FUNCTION public.test_user_access(test_user_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.test_user_access(test_user_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.test_user_access(test_user_id uuid) TO service_role;
 
 
 --
--- TOC entry 5685 (class 0 OID 0)
--- Dependencies: 442
+-- TOC entry 5807 (class 0 OID 0)
+-- Dependencies: 412
+-- Name: FUNCTION test_users_rls(test_user_id uuid); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.test_users_rls(test_user_id uuid) TO anon;
+GRANT ALL ON FUNCTION public.test_users_rls(test_user_id uuid) TO authenticated;
+GRANT ALL ON FUNCTION public.test_users_rls(test_user_id uuid) TO service_role;
+
+
+--
+-- TOC entry 5808 (class 0 OID 0)
+-- Dependencies: 447
+-- Name: FUNCTION test_users_rls_policies(); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.test_users_rls_policies() TO anon;
+GRANT ALL ON FUNCTION public.test_users_rls_policies() TO authenticated;
+GRANT ALL ON FUNCTION public.test_users_rls_policies() TO service_role;
+
+
+--
+-- TOC entry 5809 (class 0 OID 0)
+-- Dependencies: 518
+-- Name: FUNCTION track_minute_usage(p_user_id uuid, p_organization_id uuid, p_session_id uuid, p_minutes_to_add integer); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.track_minute_usage(p_user_id uuid, p_organization_id uuid, p_session_id uuid, p_minutes_to_add integer) TO anon;
+GRANT ALL ON FUNCTION public.track_minute_usage(p_user_id uuid, p_organization_id uuid, p_session_id uuid, p_minutes_to_add integer) TO authenticated;
+GRANT ALL ON FUNCTION public.track_minute_usage(p_user_id uuid, p_organization_id uuid, p_session_id uuid, p_minutes_to_add integer) TO service_role;
+
+
+--
+-- TOC entry 5810 (class 0 OID 0)
+-- Dependencies: 396
+-- Name: FUNCTION update_bot_usage_tracking_updated_at(); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.update_bot_usage_tracking_updated_at() TO anon;
+GRANT ALL ON FUNCTION public.update_bot_usage_tracking_updated_at() TO authenticated;
+GRANT ALL ON FUNCTION public.update_bot_usage_tracking_updated_at() TO service_role;
+
+
+--
+-- TOC entry 5811 (class 0 OID 0)
+-- Dependencies: 398
+-- Name: FUNCTION update_calendar_updated_at(); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.update_calendar_updated_at() TO anon;
+GRANT ALL ON FUNCTION public.update_calendar_updated_at() TO authenticated;
+GRANT ALL ON FUNCTION public.update_calendar_updated_at() TO service_role;
+
+
+--
+-- TOC entry 5812 (class 0 OID 0)
+-- Dependencies: 446
 -- Name: FUNCTION update_member_usage(); Type: ACL; Schema: public; Owner: postgres
 --
 
@@ -15162,30 +16081,41 @@
 
 
 --
--- TOC entry 5686 (class 0 OID 0)
--- Dependencies: 443
--- Name: FUNCTION update_updated_at_column(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5813 (class 0 OID 0)
+-- Dependencies: 415
+-- Name: FUNCTION update_monthly_usage_cache(); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.update_updated_at_column() TO anon;
-GRANT ALL ON FUNCTION public.update_updated_at_column() TO authenticated;
-GRANT ALL ON FUNCTION public.update_updated_at_column() TO service_role;
+GRANT ALL ON FUNCTION public.update_monthly_usage_cache() TO anon;
+GRANT ALL ON FUNCTION public.update_monthly_usage_cache() TO authenticated;
+GRANT ALL ON FUNCTION public.update_monthly_usage_cache() TO service_role;
 
 
 --
--- TOC entry 5687 (class 0 OID 0)
--- Dependencies: 463
--- Name: FUNCTION update_user_preferences_updated_at(); Type: ACL; Schema: public; Owner: postgres
+-- TOC entry 5814 (class 0 OID 0)
+-- Dependencies: 456
+-- Name: FUNCTION update_session_stats(p_session_id uuid, p_words_to_add integer, p_duration_to_add numeric); Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON FUNCTION public.update_user_preferences_updated_at() TO anon;
-GRANT ALL ON FUNCTION public.update_user_preferences_updated_at() TO authenticated;
-GRANT ALL ON FUNCTION public.update_user_preferences_updated_at() TO service_role;
+GRANT ALL ON FUNCTION public.update_session_stats(p_session_id uuid, p_words_to_add integer, p_duration_to_add numeric) TO anon;
+GRANT ALL ON FUNCTION public.update_session_stats(p_session_id uuid, p_words_to_add integer, p_duration_to_add numeric) TO authenticated;
+GRANT ALL ON FUNCTION public.update_session_stats(p_session_id uuid, p_words_to_add integer, p_duration_to_add numeric) TO service_role;
 
 
 --
--- TOC entry 5688 (class 0 OID 0)
--- Dependencies: 498
+-- TOC entry 5815 (class 0 OID 0)
+-- Dependencies: 661
+-- Name: FUNCTION update_updated_at_column(); Type: ACL; Schema: public; Owner: postgres
+--
+
+GRANT ALL ON FUNCTION public.update_updated_at_column() TO anon;
+GRANT ALL ON FUNCTION public.update_updated_at_column() TO authenticated;
+GRANT ALL ON FUNCTION public.update_updated_at_column() TO service_role;
+
+
+--
+-- TOC entry 5816 (class 0 OID 0)
+-- Dependencies: 444
 -- Name: FUNCTION vector_accum(double precision[], public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15196,8 +16126,8 @@
 
 
 --
--- TOC entry 5689 (class 0 OID 0)
--- Dependencies: 484
+-- TOC entry 5817 (class 0 OID 0)
+-- Dependencies: 419
 -- Name: FUNCTION vector_add(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15208,8 +16138,8 @@
 
 
 --
--- TOC entry 5690 (class 0 OID 0)
--- Dependencies: 499
+-- TOC entry 5818 (class 0 OID 0)
+-- Dependencies: 457
 -- Name: FUNCTION vector_avg(double precision[]); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15220,8 +16150,8 @@
 
 
 --
--- TOC entry 5691 (class 0 OID 0)
--- Dependencies: 494
+-- TOC entry 5819 (class 0 OID 0)
+-- Dependencies: 430
 -- Name: FUNCTION vector_cmp(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15232,8 +16162,8 @@
 
 
 --
--- TOC entry 5692 (class 0 OID 0)
--- Dependencies: 500
+-- TOC entry 5820 (class 0 OID 0)
+-- Dependencies: 465
 -- Name: FUNCTION vector_combine(double precision[], double precision[]); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15244,8 +16174,8 @@
 
 
 --
--- TOC entry 5693 (class 0 OID 0)
--- Dependencies: 487
+-- TOC entry 5821 (class 0 OID 0)
+-- Dependencies: 423
 -- Name: FUNCTION vector_concat(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15256,8 +16186,8 @@
 
 
 --
--- TOC entry 5694 (class 0 OID 0)
--- Dependencies: 523
+-- TOC entry 5822 (class 0 OID 0)
+-- Dependencies: 524
 -- Name: FUNCTION vector_dims(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15268,8 +16198,8 @@
 
 
 --
--- TOC entry 5695 (class 0 OID 0)
--- Dependencies: 479
+-- TOC entry 5823 (class 0 OID 0)
+-- Dependencies: 411
 -- Name: FUNCTION vector_dims(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15280,8 +16210,8 @@
 
 
 --
--- TOC entry 5696 (class 0 OID 0)
--- Dependencies: 490
+-- TOC entry 5824 (class 0 OID 0)
+-- Dependencies: 426
 -- Name: FUNCTION vector_eq(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15292,8 +16222,8 @@
 
 
 --
--- TOC entry 5697 (class 0 OID 0)
--- Dependencies: 492
+-- TOC entry 5825 (class 0 OID 0)
+-- Dependencies: 428
 -- Name: FUNCTION vector_ge(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15304,8 +16234,8 @@
 
 
 --
--- TOC entry 5698 (class 0 OID 0)
--- Dependencies: 493
+-- TOC entry 5826 (class 0 OID 0)
+-- Dependencies: 429
 -- Name: FUNCTION vector_gt(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15316,8 +16246,8 @@
 
 
 --
--- TOC entry 5699 (class 0 OID 0)
--- Dependencies: 495
+-- TOC entry 5827 (class 0 OID 0)
+-- Dependencies: 431
 -- Name: FUNCTION vector_l2_squared_distance(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15328,8 +16258,8 @@
 
 
 --
--- TOC entry 5700 (class 0 OID 0)
--- Dependencies: 489
+-- TOC entry 5828 (class 0 OID 0)
+-- Dependencies: 425
 -- Name: FUNCTION vector_le(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15340,8 +16270,8 @@
 
 
 --
--- TOC entry 5701 (class 0 OID 0)
--- Dependencies: 488
+-- TOC entry 5829 (class 0 OID 0)
+-- Dependencies: 424
 -- Name: FUNCTION vector_lt(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15352,8 +16282,8 @@
 
 
 --
--- TOC entry 5702 (class 0 OID 0)
--- Dependencies: 486
+-- TOC entry 5830 (class 0 OID 0)
+-- Dependencies: 422
 -- Name: FUNCTION vector_mul(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15364,8 +16294,8 @@
 
 
 --
--- TOC entry 5703 (class 0 OID 0)
--- Dependencies: 491
+-- TOC entry 5831 (class 0 OID 0)
+-- Dependencies: 427
 -- Name: FUNCTION vector_ne(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15376,8 +16306,8 @@
 
 
 --
--- TOC entry 5704 (class 0 OID 0)
--- Dependencies: 496
+-- TOC entry 5832 (class 0 OID 0)
+-- Dependencies: 436
 -- Name: FUNCTION vector_negative_inner_product(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15388,8 +16318,8 @@
 
 
 --
--- TOC entry 5705 (class 0 OID 0)
--- Dependencies: 480
+-- TOC entry 5833 (class 0 OID 0)
+-- Dependencies: 413
 -- Name: FUNCTION vector_norm(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15400,8 +16330,8 @@
 
 
 --
--- TOC entry 5706 (class 0 OID 0)
--- Dependencies: 497
+-- TOC entry 5834 (class 0 OID 0)
+-- Dependencies: 443
 -- Name: FUNCTION vector_spherical_distance(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15412,8 +16342,8 @@
 
 
 --
--- TOC entry 5707 (class 0 OID 0)
--- Dependencies: 485
+-- TOC entry 5835 (class 0 OID 0)
+-- Dependencies: 421
 -- Name: FUNCTION vector_sub(public.vector, public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15424,8 +16354,8 @@
 
 
 --
--- TOC entry 5708 (class 0 OID 0)
--- Dependencies: 430
+-- TOC entry 5836 (class 0 OID 0)
+-- Dependencies: 656
 -- Name: FUNCTION apply_rls(wal jsonb, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15438,8 +16368,8 @@
 
 
 --
--- TOC entry 5709 (class 0 OID 0)
--- Dependencies: 436
+-- TOC entry 5837 (class 0 OID 0)
+-- Dependencies: 654
 -- Name: FUNCTION broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15448,8 +16378,8 @@
 
 
 --
--- TOC entry 5710 (class 0 OID 0)
--- Dependencies: 432
+-- TOC entry 5838 (class 0 OID 0)
+-- Dependencies: 652
 -- Name: FUNCTION build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[]); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15462,8 +16392,8 @@
 
 
 --
--- TOC entry 5711 (class 0 OID 0)
--- Dependencies: 428
+-- TOC entry 5839 (class 0 OID 0)
+-- Dependencies: 658
 -- Name: FUNCTION "cast"(val text, type_ regtype); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15476,8 +16406,8 @@
 
 
 --
--- TOC entry 5712 (class 0 OID 0)
--- Dependencies: 427
+-- TOC entry 5840 (class 0 OID 0)
+-- Dependencies: 653
 -- Name: FUNCTION check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15490,8 +16420,8 @@
 
 
 --
--- TOC entry 5713 (class 0 OID 0)
--- Dependencies: 431
+-- TOC entry 5841 (class 0 OID 0)
+-- Dependencies: 649
 -- Name: FUNCTION is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[]); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15504,8 +16434,8 @@
 
 
 --
--- TOC entry 5714 (class 0 OID 0)
--- Dependencies: 433
+-- TOC entry 5842 (class 0 OID 0)
+-- Dependencies: 655
 -- Name: FUNCTION list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15518,8 +16448,8 @@
 
 
 --
--- TOC entry 5715 (class 0 OID 0)
--- Dependencies: 426
+-- TOC entry 5843 (class 0 OID 0)
+-- Dependencies: 643
 -- Name: FUNCTION quote_wal2json(entity regclass); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15532,8 +16462,8 @@
 
 
 --
--- TOC entry 5716 (class 0 OID 0)
--- Dependencies: 435
+-- TOC entry 5844 (class 0 OID 0)
+-- Dependencies: 660
 -- Name: FUNCTION send(payload jsonb, event text, topic text, private boolean); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15542,8 +16472,8 @@
 
 
 --
--- TOC entry 5717 (class 0 OID 0)
--- Dependencies: 425
+-- TOC entry 5845 (class 0 OID 0)
+-- Dependencies: 657
 -- Name: FUNCTION subscription_check_filters(); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15556,8 +16486,8 @@
 
 
 --
--- TOC entry 5718 (class 0 OID 0)
--- Dependencies: 429
+-- TOC entry 5846 (class 0 OID 0)
+-- Dependencies: 644
 -- Name: FUNCTION to_regrole(role_name text); Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -15569,9 +16499,9 @@
 GRANT ALL ON FUNCTION realtime.to_regrole(role_name text) TO supabase_realtime_admin;
 
 
---
--- TOC entry 5719 (class 0 OID 0)
--- Dependencies: 434
+--
+-- TOC entry 5847 (class 0 OID 0)
+-- Dependencies: 659
 -- Name: FUNCTION topic(); Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
 --
 
@@ -15580,8 +16510,8 @@
 
 
 --
--- TOC entry 5720 (class 0 OID 0)
--- Dependencies: 403
+-- TOC entry 5848 (class 0 OID 0)
+-- Dependencies: 592
 -- Name: FUNCTION _crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea, nonce bytea); Type: ACL; Schema: vault; Owner: supabase_admin
 --
 
@@ -15590,8 +16520,8 @@
 
 
 --
--- TOC entry 5721 (class 0 OID 0)
--- Dependencies: 405
+-- TOC entry 5849 (class 0 OID 0)
+-- Dependencies: 599
 -- Name: FUNCTION create_secret(new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
 --
 
@@ -15600,8 +16530,8 @@
 
 
 --
--- TOC entry 5722 (class 0 OID 0)
--- Dependencies: 406
+-- TOC entry 5850 (class 0 OID 0)
+-- Dependencies: 600
 -- Name: FUNCTION update_secret(secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid); Type: ACL; Schema: vault; Owner: supabase_admin
 --
 
@@ -15610,8 +16540,8 @@
 
 
 --
--- TOC entry 5723 (class 0 OID 0)
--- Dependencies: 1529
+-- TOC entry 5851 (class 0 OID 0)
+-- Dependencies: 1608
 -- Name: FUNCTION avg(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15622,8 +16552,8 @@
 
 
 --
--- TOC entry 5724 (class 0 OID 0)
--- Dependencies: 1527
+-- TOC entry 5852 (class 0 OID 0)
+-- Dependencies: 1606
 -- Name: FUNCTION avg(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15634,8 +16564,8 @@
 
 
 --
--- TOC entry 5725 (class 0 OID 0)
--- Dependencies: 1530
+-- TOC entry 5853 (class 0 OID 0)
+-- Dependencies: 1609
 -- Name: FUNCTION sum(public.halfvec); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15646,8 +16576,8 @@
 
 
 --
--- TOC entry 5726 (class 0 OID 0)
--- Dependencies: 1528
+-- TOC entry 5854 (class 0 OID 0)
+-- Dependencies: 1607
 -- Name: FUNCTION sum(public.vector); Type: ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -15658,107 +16588,107 @@
 
 
 --
--- TOC entry 5728 (class 0 OID 0)
--- Dependencies: 238
+-- TOC entry 5856 (class 0 OID 0)
+-- Dependencies: 301
 -- Name: TABLE audit_log_entries; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT ALL ON TABLE auth.audit_log_entries TO dashboard_user;
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.audit_log_entries TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.audit_log_entries TO dashboard_user;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.audit_log_entries TO postgres;
 GRANT SELECT ON TABLE auth.audit_log_entries TO postgres WITH GRANT OPTION;
 
 
 --
--- TOC entry 5730 (class 0 OID 0)
--- Dependencies: 255
+-- TOC entry 5858 (class 0 OID 0)
+-- Dependencies: 318
 -- Name: TABLE flow_state; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.flow_state TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.flow_state TO postgres;
 GRANT SELECT ON TABLE auth.flow_state TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.flow_state TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.flow_state TO dashboard_user;
 
 
 --
--- TOC entry 5733 (class 0 OID 0)
--- Dependencies: 246
+-- TOC entry 5861 (class 0 OID 0)
+-- Dependencies: 309
 -- Name: TABLE identities; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.identities TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.identities TO postgres;
 GRANT SELECT ON TABLE auth.identities TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.identities TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.identities TO dashboard_user;
 
 
 --
--- TOC entry 5735 (class 0 OID 0)
--- Dependencies: 237
+-- TOC entry 5863 (class 0 OID 0)
+-- Dependencies: 300
 -- Name: TABLE instances; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT ALL ON TABLE auth.instances TO dashboard_user;
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.instances TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.instances TO dashboard_user;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.instances TO postgres;
 GRANT SELECT ON TABLE auth.instances TO postgres WITH GRANT OPTION;
 
 
 --
--- TOC entry 5737 (class 0 OID 0)
--- Dependencies: 250
+-- TOC entry 5865 (class 0 OID 0)
+-- Dependencies: 313
 -- Name: TABLE mfa_amr_claims; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_amr_claims TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_amr_claims TO postgres;
 GRANT SELECT ON TABLE auth.mfa_amr_claims TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.mfa_amr_claims TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_amr_claims TO dashboard_user;
 
 
 --
--- TOC entry 5739 (class 0 OID 0)
--- Dependencies: 249
+-- TOC entry 5867 (class 0 OID 0)
+-- Dependencies: 312
 -- Name: TABLE mfa_challenges; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_challenges TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_challenges TO postgres;
 GRANT SELECT ON TABLE auth.mfa_challenges TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.mfa_challenges TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_challenges TO dashboard_user;
 
 
 --
--- TOC entry 5741 (class 0 OID 0)
--- Dependencies: 248
+-- TOC entry 5869 (class 0 OID 0)
+-- Dependencies: 311
 -- Name: TABLE mfa_factors; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.mfa_factors TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_factors TO postgres;
 GRANT SELECT ON TABLE auth.mfa_factors TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.mfa_factors TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.mfa_factors TO dashboard_user;
 
 
 --
--- TOC entry 5742 (class 0 OID 0)
--- Dependencies: 256
+-- TOC entry 5870 (class 0 OID 0)
+-- Dependencies: 319
 -- Name: TABLE one_time_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.one_time_tokens TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.one_time_tokens TO postgres;
 GRANT SELECT ON TABLE auth.one_time_tokens TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.one_time_tokens TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.one_time_tokens TO dashboard_user;
 
 
 --
--- TOC entry 5744 (class 0 OID 0)
--- Dependencies: 236
+-- TOC entry 5872 (class 0 OID 0)
+-- Dependencies: 299
 -- Name: TABLE refresh_tokens; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT ALL ON TABLE auth.refresh_tokens TO dashboard_user;
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.refresh_tokens TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.refresh_tokens TO dashboard_user;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.refresh_tokens TO postgres;
 GRANT SELECT ON TABLE auth.refresh_tokens TO postgres WITH GRANT OPTION;
 
 
 --
--- TOC entry 5746 (class 0 OID 0)
--- Dependencies: 235
+-- TOC entry 5874 (class 0 OID 0)
+-- Dependencies: 298
 -- Name: SEQUENCE refresh_tokens_id_seq; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -15767,30 +16697,30 @@
 
 
 --
--- TOC entry 5748 (class 0 OID 0)
--- Dependencies: 253
+-- TOC entry 5876 (class 0 OID 0)
+-- Dependencies: 316
 -- Name: TABLE saml_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.saml_providers TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.saml_providers TO postgres;
 GRANT SELECT ON TABLE auth.saml_providers TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.saml_providers TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.saml_providers TO dashboard_user;
 
 
 --
--- TOC entry 5750 (class 0 OID 0)
--- Dependencies: 254
+-- TOC entry 5878 (class 0 OID 0)
+-- Dependencies: 317
 -- Name: TABLE saml_relay_states; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.saml_relay_states TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.saml_relay_states TO postgres;
 GRANT SELECT ON TABLE auth.saml_relay_states TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.saml_relay_states TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.saml_relay_states TO dashboard_user;
 
 
 --
--- TOC entry 5752 (class 0 OID 0)
--- Dependencies: 239
+-- TOC entry 5880 (class 0 OID 0)
+-- Dependencies: 302
 -- Name: TABLE schema_migrations; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -15798,823 +16728,823 @@
 
 
 --
--- TOC entry 5755 (class 0 OID 0)
--- Dependencies: 247
+-- TOC entry 5883 (class 0 OID 0)
+-- Dependencies: 310
 -- Name: TABLE sessions; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sessions TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sessions TO postgres;
 GRANT SELECT ON TABLE auth.sessions TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.sessions TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sessions TO dashboard_user;
 
 
 --
--- TOC entry 5757 (class 0 OID 0)
--- Dependencies: 252
+-- TOC entry 5885 (class 0 OID 0)
+-- Dependencies: 315
 -- Name: TABLE sso_domains; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sso_domains TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sso_domains TO postgres;
 GRANT SELECT ON TABLE auth.sso_domains TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.sso_domains TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sso_domains TO dashboard_user;
 
 
 --
--- TOC entry 5760 (class 0 OID 0)
--- Dependencies: 251
+-- TOC entry 5888 (class 0 OID 0)
+-- Dependencies: 314
 -- Name: TABLE sso_providers; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.sso_providers TO postgres;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sso_providers TO postgres;
 GRANT SELECT ON TABLE auth.sso_providers TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE auth.sso_providers TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.sso_providers TO dashboard_user;
 
 
 --
--- TOC entry 5763 (class 0 OID 0)
--- Dependencies: 234
+-- TOC entry 5891 (class 0 OID 0)
+-- Dependencies: 297
 -- Name: TABLE users; Type: ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-GRANT ALL ON TABLE auth.users TO dashboard_user;
-GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,MAINTAIN,UPDATE ON TABLE auth.users TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.users TO dashboard_user;
+GRANT INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE auth.users TO postgres;
 GRANT SELECT ON TABLE auth.users TO postgres WITH GRANT OPTION;
 
 
 --
--- TOC entry 5764 (class 0 OID 0)
--- Dependencies: 233
+-- TOC entry 5892 (class 0 OID 0)
+-- Dependencies: 296
 -- Name: TABLE pg_stat_statements; Type: ACL; Schema: extensions; Owner: postgres
 --
 
-REVOKE ALL ON TABLE extensions.pg_stat_statements FROM postgres;
-GRANT ALL ON TABLE extensions.pg_stat_statements TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE extensions.pg_stat_statements TO dashboard_user;
+REVOKE SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE extensions.pg_stat_statements FROM postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE extensions.pg_stat_statements TO postgres WITH GRANT OPTION;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE extensions.pg_stat_statements TO dashboard_user;
 
 
 --
--- TOC entry 5765 (class 0 OID 0)
--- Dependencies: 232
+-- TOC entry 5893 (class 0 OID 0)
+-- Dependencies: 295
 -- Name: TABLE pg_stat_statements_info; Type: ACL; Schema: extensions; Owner: postgres
 --
 
-REVOKE ALL ON TABLE extensions.pg_stat_statements_info FROM postgres;
-GRANT ALL ON TABLE extensions.pg_stat_statements_info TO postgres WITH GRANT OPTION;
-GRANT ALL ON TABLE extensions.pg_stat_statements_info TO dashboard_user;
+REVOKE SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE extensions.pg_stat_statements_info FROM postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE extensions.pg_stat_statements_info TO postgres WITH GRANT OPTION;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE extensions.pg_stat_statements_info TO dashboard_user;
 
 
 --
--- TOC entry 5766 (class 0 OID 0)
--- Dependencies: 270
+-- TOC entry 5895 (class 0 OID 0)
+-- Dependencies: 339
 -- Name: TABLE plans; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.plans TO anon;
-GRANT ALL ON TABLE public.plans TO authenticated;
-GRANT ALL ON TABLE public.plans TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.plans TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.plans TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.plans TO service_role;
 
 
 --
--- TOC entry 5767 (class 0 OID 0)
--- Dependencies: 283
+-- TOC entry 5896 (class 0 OID 0)
+-- Dependencies: 340
 -- Name: TABLE subscriptions; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.subscriptions TO anon;
-GRANT ALL ON TABLE public.subscriptions TO authenticated;
-GRANT ALL ON TABLE public.subscriptions TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.subscriptions TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.subscriptions TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.subscriptions TO service_role;
 
 
 --
--- TOC entry 5768 (class 0 OID 0)
--- Dependencies: 326
+-- TOC entry 5897 (class 0 OID 0)
+-- Dependencies: 386
 -- Name: TABLE active_user_subscriptions; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.active_user_subscriptions TO anon;
-GRANT ALL ON TABLE public.active_user_subscriptions TO authenticated;
-GRANT ALL ON TABLE public.active_user_subscriptions TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.active_user_subscriptions TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.active_user_subscriptions TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.active_user_subscriptions TO service_role;
 
 
 --
--- TOC entry 5769 (class 0 OID 0)
--- Dependencies: 276
+-- TOC entry 5898 (class 0 OID 0)
+-- Dependencies: 352
 -- Name: TABLE beta_waitlist; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.beta_waitlist TO anon;
-GRANT ALL ON TABLE public.beta_waitlist TO authenticated;
-GRANT ALL ON TABLE public.beta_waitlist TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.beta_waitlist TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.beta_waitlist TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.beta_waitlist TO service_role;
 
 
 --
--- TOC entry 5770 (class 0 OID 0)
--- Dependencies: 289
+-- TOC entry 5899 (class 0 OID 0)
+-- Dependencies: 362
 -- Name: TABLE bot_recordings; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.bot_recordings TO anon;
-GRANT ALL ON TABLE public.bot_recordings TO authenticated;
-GRANT ALL ON TABLE public.bot_recordings TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.bot_recordings TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.bot_recordings TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.bot_recordings TO service_role;
 
 
 --
--- TOC entry 5771 (class 0 OID 0)
--- Dependencies: 290
+-- TOC entry 5900 (class 0 OID 0)
+-- Dependencies: 359
 -- Name: TABLE bot_usage_tracking; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.bot_usage_tracking TO anon;
-GRANT ALL ON TABLE public.bot_usage_tracking TO authenticated;
-GRANT ALL ON TABLE public.bot_usage_tracking TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.bot_usage_tracking TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.bot_usage_tracking TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.bot_usage_tracking TO service_role;
 
 
 --
--- TOC entry 5772 (class 0 OID 0)
--- Dependencies: 291
+-- TOC entry 5901 (class 0 OID 0)
+-- Dependencies: 368
 -- Name: TABLE calendar_auto_join_logs; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.calendar_auto_join_logs TO anon;
-GRANT ALL ON TABLE public.calendar_auto_join_logs TO authenticated;
-GRANT ALL ON TABLE public.calendar_auto_join_logs TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_auto_join_logs TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_auto_join_logs TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_auto_join_logs TO service_role;
 
 
 --
--- TOC entry 5773 (class 0 OID 0)
--- Dependencies: 292
+-- TOC entry 5902 (class 0 OID 0)
+-- Dependencies: 364
 -- Name: TABLE calendar_connections; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.calendar_connections TO anon;
-GRANT ALL ON TABLE public.calendar_connections TO authenticated;
-GRANT ALL ON TABLE public.calendar_connections TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_connections TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_connections TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_connections TO service_role;
 
 
 --
--- TOC entry 5775 (class 0 OID 0)
--- Dependencies: 293
+-- TOC entry 5904 (class 0 OID 0)
+-- Dependencies: 365
 -- Name: TABLE calendar_events; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.calendar_events TO anon;
-GRANT ALL ON TABLE public.calendar_events TO authenticated;
-GRANT ALL ON TABLE public.calendar_events TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_events TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_events TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_events TO service_role;
 
 
 --
--- TOC entry 5776 (class 0 OID 0)
--- Dependencies: 294
+-- TOC entry 5905 (class 0 OID 0)
+-- Dependencies: 367
 -- Name: TABLE calendar_preferences; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.calendar_preferences TO anon;
-GRANT ALL ON TABLE public.calendar_preferences TO authenticated;
-GRANT ALL ON TABLE public.calendar_preferences TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_preferences TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_preferences TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_preferences TO service_role;
 
 
 --
--- TOC entry 5777 (class 0 OID 0)
--- Dependencies: 295
+-- TOC entry 5906 (class 0 OID 0)
+-- Dependencies: 366
 -- Name: TABLE calendar_webhooks; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.calendar_webhooks TO anon;
-GRANT ALL ON TABLE public.calendar_webhooks TO authenticated;
-GRANT ALL ON TABLE public.calendar_webhooks TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_webhooks TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_webhooks TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.calendar_webhooks TO service_role;
 
 
 --
--- TOC entry 5778 (class 0 OID 0)
--- Dependencies: 296
+-- TOC entry 5907 (class 0 OID 0)
+-- Dependencies: 372
 -- Name: TABLE collaborative_action_items; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.collaborative_action_items TO anon;
-GRANT ALL ON TABLE public.collaborative_action_items TO authenticated;
-GRANT ALL ON TABLE public.collaborative_action_items TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.collaborative_action_items TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.collaborative_action_items TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.collaborative_action_items TO service_role;
 
 
 --
--- TOC entry 5779 (class 0 OID 0)
--- Dependencies: 297
+-- TOC entry 5908 (class 0 OID 0)
+-- Dependencies: 371
 -- Name: TABLE comment_mentions; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.comment_mentions TO anon;
-GRANT ALL ON TABLE public.comment_mentions TO authenticated;
-GRANT ALL ON TABLE public.comment_mentions TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.comment_mentions TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.comment_mentions TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.comment_mentions TO service_role;
 
 
 --
--- TOC entry 5780 (class 0 OID 0)
--- Dependencies: 298
+-- TOC entry 5909 (class 0 OID 0)
+-- Dependencies: 354
 -- Name: TABLE conversation_links; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.conversation_links TO anon;
-GRANT ALL ON TABLE public.conversation_links TO authenticated;
-GRANT ALL ON TABLE public.conversation_links TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.conversation_links TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.conversation_links TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.conversation_links TO service_role;
 
 
 --
--- TOC entry 5782 (class 0 OID 0)
--- Dependencies: 322
+-- TOC entry 5920 (class 0 OID 0)
+-- Dependencies: 384
 -- Name: TABLE custom_reports; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.custom_reports TO anon;
-GRANT ALL ON TABLE public.custom_reports TO authenticated;
-GRANT ALL ON TABLE public.custom_reports TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.custom_reports TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.custom_reports TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.custom_reports TO service_role;
 
 
 --
--- TOC entry 5783 (class 0 OID 0)
--- Dependencies: 277
+-- TOC entry 5921 (class 0 OID 0)
+-- Dependencies: 335
 -- Name: TABLE documents; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.documents TO anon;
-GRANT ALL ON TABLE public.documents TO authenticated;
-GRANT ALL ON TABLE public.documents TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.documents TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.documents TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.documents TO service_role;
 
 
 --
--- TOC entry 5785 (class 0 OID 0)
--- Dependencies: 323
+-- TOC entry 5922 (class 0 OID 0)
+-- Dependencies: 377
 -- Name: TABLE email_notifications; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.email_notifications TO anon;
-GRANT ALL ON TABLE public.email_notifications TO authenticated;
-GRANT ALL ON TABLE public.email_notifications TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.email_notifications TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.email_notifications TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.email_notifications TO service_role;
 
 
 --
--- TOC entry 5786 (class 0 OID 0)
--- Dependencies: 331
+-- TOC entry 5923 (class 0 OID 0)
+-- Dependencies: 394
 -- Name: TABLE embedding_queue; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.embedding_queue TO anon;
-GRANT ALL ON TABLE public.embedding_queue TO authenticated;
-GRANT ALL ON TABLE public.embedding_queue TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.embedding_queue TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.embedding_queue TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.embedding_queue TO service_role;
 
 
 --
--- TOC entry 5787 (class 0 OID 0)
--- Dependencies: 278
+-- TOC entry 5924 (class 0 OID 0)
+-- Dependencies: 337
 -- Name: TABLE guidance; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.guidance TO anon;
-GRANT ALL ON TABLE public.guidance TO authenticated;
-GRANT ALL ON TABLE public.guidance TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.guidance TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.guidance TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.guidance TO service_role;
 
 
 --
--- TOC entry 5794 (class 0 OID 0)
--- Dependencies: 329
+-- TOC entry 5931 (class 0 OID 0)
+-- Dependencies: 393
 -- Name: TABLE integration_exports; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.integration_exports TO anon;
-GRANT ALL ON TABLE public.integration_exports TO authenticated;
-GRANT ALL ON TABLE public.integration_exports TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.integration_exports TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.integration_exports TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.integration_exports TO service_role;
 
 
 --
--- TOC entry 5799 (class 0 OID 0)
--- Dependencies: 328
+-- TOC entry 5936 (class 0 OID 0)
+-- Dependencies: 392
 -- Name: TABLE integration_settings; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.integration_settings TO anon;
-GRANT ALL ON TABLE public.integration_settings TO authenticated;
-GRANT ALL ON TABLE public.integration_settings TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.integration_settings TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.integration_settings TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.integration_settings TO service_role;
 
 
 --
--- TOC entry 5800 (class 0 OID 0)
--- Dependencies: 299
+-- TOC entry 5938 (class 0 OID 0)
+-- Dependencies: 357
 -- Name: TABLE meeting_metadata; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.meeting_metadata TO anon;
-GRANT ALL ON TABLE public.meeting_metadata TO authenticated;
-GRANT ALL ON TABLE public.meeting_metadata TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.meeting_metadata TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.meeting_metadata TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.meeting_metadata TO service_role;
 
 
 --
--- TOC entry 5801 (class 0 OID 0)
--- Dependencies: 300
+-- TOC entry 5939 (class 0 OID 0)
+-- Dependencies: 369
 -- Name: TABLE meeting_notifications; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.meeting_notifications TO anon;
-GRANT ALL ON TABLE public.meeting_notifications TO authenticated;
-GRANT ALL ON TABLE public.meeting_notifications TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.meeting_notifications TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.meeting_notifications TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.meeting_notifications TO service_role;
 
 
 --
--- TOC entry 5802 (class 0 OID 0)
--- Dependencies: 274
+-- TOC entry 5940 (class 0 OID 0)
+-- Dependencies: 350
 -- Name: TABLE monthly_usage_cache; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.monthly_usage_cache TO anon;
-GRANT ALL ON TABLE public.monthly_usage_cache TO authenticated;
-GRANT ALL ON TABLE public.monthly_usage_cache TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.monthly_usage_cache TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.monthly_usage_cache TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.monthly_usage_cache TO service_role;
 
 
 --
--- TOC entry 5803 (class 0 OID 0)
--- Dependencies: 279
+-- TOC entry 5941 (class 0 OID 0)
+-- Dependencies: 332
 -- Name: TABLE organization_invitations; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.organization_invitations TO anon;
-GRANT ALL ON TABLE public.organization_invitations TO authenticated;
-GRANT ALL ON TABLE public.organization_invitations TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organization_invitations TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organization_invitations TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organization_invitations TO service_role;
 
 
 --
--- TOC entry 5804 (class 0 OID 0)
--- Dependencies: 269
+-- TOC entry 5942 (class 0 OID 0)
+-- Dependencies: 331
 -- Name: TABLE organization_members; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.organization_members TO anon;
-GRANT ALL ON TABLE public.organization_members TO authenticated;
-GRANT ALL ON TABLE public.organization_members TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organization_members TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organization_members TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organization_members TO service_role;
 
 
 --
--- TOC entry 5805 (class 0 OID 0)
--- Dependencies: 268
+-- TOC entry 5943 (class 0 OID 0)
+-- Dependencies: 330
 -- Name: TABLE organizations; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.organizations TO anon;
-GRANT ALL ON TABLE public.organizations TO authenticated;
-GRANT ALL ON TABLE public.organizations TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organizations TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organizations TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.organizations TO service_role;
 
 
 --
--- TOC entry 5811 (class 0 OID 0)
--- Dependencies: 280
+-- TOC entry 5952 (class 0 OID 0)
+-- Dependencies: 346
 -- Name: TABLE prep_checklist; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.prep_checklist TO anon;
-GRANT ALL ON TABLE public.prep_checklist TO authenticated;
-GRANT ALL ON TABLE public.prep_checklist TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.prep_checklist TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.prep_checklist TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.prep_checklist TO service_role;
 
 
 --
--- TOC entry 5812 (class 0 OID 0)
--- Dependencies: 301
+-- TOC entry 5953 (class 0 OID 0)
+-- Dependencies: 356
 -- Name: TABLE recall_ai_webhooks; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.recall_ai_webhooks TO anon;
-GRANT ALL ON TABLE public.recall_ai_webhooks TO authenticated;
-GRANT ALL ON TABLE public.recall_ai_webhooks TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.recall_ai_webhooks TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.recall_ai_webhooks TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.recall_ai_webhooks TO service_role;
 
 
 --
--- TOC entry 5814 (class 0 OID 0)
--- Dependencies: 325
+-- TOC entry 5954 (class 0 OID 0)
+-- Dependencies: 383
 -- Name: TABLE referral_audit_logs; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.referral_audit_logs TO anon;
-GRANT ALL ON TABLE public.referral_audit_logs TO authenticated;
-GRANT ALL ON TABLE public.referral_audit_logs TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.referral_audit_logs TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.referral_audit_logs TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.referral_audit_logs TO service_role;
 
 
 --
--- TOC entry 5815 (class 0 OID 0)
--- Dependencies: 318
+-- TOC entry 5955 (class 0 OID 0)
+-- Dependencies: 390
 -- Name: TABLE referral_fraud_checks; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.referral_fraud_checks TO anon;
-GRANT ALL ON TABLE public.referral_fraud_checks TO authenticated;
-GRANT ALL ON TABLE public.referral_fraud_checks TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.referral_fraud_checks TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.referral_fraud_checks TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.referral_fraud_checks TO service_role;
 
 
 --
--- TOC entry 5816 (class 0 OID 0)
--- Dependencies: 302
+-- TOC entry 5956 (class 0 OID 0)
+-- Dependencies: 373
 -- Name: TABLE report_activity; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.report_activity TO anon;
-GRANT ALL ON TABLE public.report_activity TO authenticated;
-GRANT ALL ON TABLE public.report_activity TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_activity TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_activity TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_activity TO service_role;
 
 
 --
--- TOC entry 5817 (class 0 OID 0)
--- Dependencies: 303
+-- TOC entry 5957 (class 0 OID 0)
+-- Dependencies: 375
 -- Name: TABLE report_bookmarks; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.report_bookmarks TO anon;
-GRANT ALL ON TABLE public.report_bookmarks TO authenticated;
-GRANT ALL ON TABLE public.report_bookmarks TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_bookmarks TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_bookmarks TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_bookmarks TO service_role;
 
 
 --
--- TOC entry 5818 (class 0 OID 0)
--- Dependencies: 304
+-- TOC entry 5958 (class 0 OID 0)
+-- Dependencies: 374
 -- Name: TABLE report_collaborators; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.report_collaborators TO anon;
-GRANT ALL ON TABLE public.report_collaborators TO authenticated;
-GRANT ALL ON TABLE public.report_collaborators TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_collaborators TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_collaborators TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_collaborators TO service_role;
 
 
 --
--- TOC entry 5819 (class 0 OID 0)
--- Dependencies: 305
+-- TOC entry 5959 (class 0 OID 0)
+-- Dependencies: 370
 -- Name: TABLE report_comments; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.report_comments TO anon;
-GRANT ALL ON TABLE public.report_comments TO authenticated;
-GRANT ALL ON TABLE public.report_comments TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_comments TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_comments TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.report_comments TO service_role;
 
 
 --
--- TOC entry 5820 (class 0 OID 0)
--- Dependencies: 281
+-- TOC entry 5960 (class 0 OID 0)
+-- Dependencies: 345
 -- Name: TABLE session_context; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.session_context TO anon;
-GRANT ALL ON TABLE public.session_context TO authenticated;
-GRANT ALL ON TABLE public.session_context TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.session_context TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.session_context TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.session_context TO service_role;
 
 
 --
--- TOC entry 5821 (class 0 OID 0)
--- Dependencies: 282
+-- TOC entry 5961 (class 0 OID 0)
+-- Dependencies: 344
 -- Name: TABLE session_timeline_events; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.session_timeline_events TO anon;
-GRANT ALL ON TABLE public.session_timeline_events TO authenticated;
-GRANT ALL ON TABLE public.session_timeline_events TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.session_timeline_events TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.session_timeline_events TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.session_timeline_events TO service_role;
 
 
 --
--- TOC entry 5824 (class 0 OID 0)
--- Dependencies: 271
+-- TOC entry 5970 (class 0 OID 0)
+-- Dependencies: 334
 -- Name: TABLE sessions; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.sessions TO anon;
-GRANT ALL ON TABLE public.sessions TO authenticated;
-GRANT ALL ON TABLE public.sessions TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.sessions TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.sessions TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.sessions TO service_role;
 
 
 --
--- TOC entry 5828 (class 0 OID 0)
--- Dependencies: 306
+-- TOC entry 5974 (class 0 OID 0)
+-- Dependencies: 363
 -- Name: TABLE shared_reports; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.shared_reports TO anon;
-GRANT ALL ON TABLE public.shared_reports TO authenticated;
-GRANT ALL ON TABLE public.shared_reports TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.shared_reports TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.shared_reports TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.shared_reports TO service_role;
 
 
 --
--- TOC entry 5829 (class 0 OID 0)
--- Dependencies: 307
+-- TOC entry 5979 (class 0 OID 0)
+-- Dependencies: 358
 -- Name: TABLE smart_notes; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.smart_notes TO anon;
-GRANT ALL ON TABLE public.smart_notes TO authenticated;
-GRANT ALL ON TABLE public.smart_notes TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.smart_notes TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.smart_notes TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.smart_notes TO service_role;
 
 
 --
--- TOC entry 5830 (class 0 OID 0)
--- Dependencies: 308
+-- TOC entry 5980 (class 0 OID 0)
+-- Dependencies: 353
 -- Name: TABLE subscription_events; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.subscription_events TO anon;
-GRANT ALL ON TABLE public.subscription_events TO authenticated;
-GRANT ALL ON TABLE public.subscription_events TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.subscription_events TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.subscription_events TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.subscription_events TO service_role;
 
 
 --
--- TOC entry 5831 (class 0 OID 0)
--- Dependencies: 284
+-- TOC entry 5981 (class 0 OID 0)
+-- Dependencies: 338
 -- Name: TABLE summaries; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.summaries TO anon;
-GRANT ALL ON TABLE public.summaries TO authenticated;
-GRANT ALL ON TABLE public.summaries TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.summaries TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.summaries TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.summaries TO service_role;
 
 
 --
--- TOC entry 5832 (class 0 OID 0)
--- Dependencies: 285
+-- TOC entry 5982 (class 0 OID 0)
+-- Dependencies: 343
 -- Name: TABLE system_logs; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.system_logs TO anon;
-GRANT ALL ON TABLE public.system_logs TO authenticated;
-GRANT ALL ON TABLE public.system_logs TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.system_logs TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.system_logs TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.system_logs TO service_role;
 
 
 --
--- TOC entry 5833 (class 0 OID 0)
--- Dependencies: 309
+-- TOC entry 5983 (class 0 OID 0)
+-- Dependencies: 355
 -- Name: TABLE system_settings; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.system_settings TO anon;
-GRANT ALL ON TABLE public.system_settings TO authenticated;
-GRANT ALL ON TABLE public.system_settings TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.system_settings TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.system_settings TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.system_settings TO service_role;
 
 
 --
--- TOC entry 5834 (class 0 OID 0)
--- Dependencies: 273
+-- TOC entry 5984 (class 0 OID 0)
+-- Dependencies: 333
 -- Name: TABLE templates; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.templates TO anon;
-GRANT ALL ON TABLE public.templates TO authenticated;
-GRANT ALL ON TABLE public.templates TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.templates TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.templates TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.templates TO service_role;
 
 
 --
--- TOC entry 5839 (class 0 OID 0)
--- Dependencies: 272
+-- TOC entry 5988 (class 0 OID 0)
+-- Dependencies: 336
 -- Name: TABLE transcripts; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.transcripts TO anon;
-GRANT ALL ON TABLE public.transcripts TO authenticated;
-GRANT ALL ON TABLE public.transcripts TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.transcripts TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.transcripts TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.transcripts TO service_role;
 
 
 --
--- TOC entry 5840 (class 0 OID 0)
--- Dependencies: 286
+-- TOC entry 5989 (class 0 OID 0)
+-- Dependencies: 341
 -- Name: TABLE usage_records; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.usage_records TO anon;
-GRANT ALL ON TABLE public.usage_records TO authenticated;
-GRANT ALL ON TABLE public.usage_records TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.usage_records TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.usage_records TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.usage_records TO service_role;
 
 
 --
--- TOC entry 5841 (class 0 OID 0)
--- Dependencies: 275
+-- TOC entry 5990 (class 0 OID 0)
+-- Dependencies: 349
 -- Name: TABLE usage_tracking; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.usage_tracking TO anon;
-GRANT ALL ON TABLE public.usage_tracking TO authenticated;
-GRANT ALL ON TABLE public.usage_tracking TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.usage_tracking TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.usage_tracking TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.usage_tracking TO service_role;
 
 
 --
--- TOC entry 5842 (class 0 OID 0)
--- Dependencies: 287
+-- TOC entry 5991 (class 0 OID 0)
+-- Dependencies: 342
 -- Name: TABLE user_app_sessions; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.user_app_sessions TO anon;
-GRANT ALL ON TABLE public.user_app_sessions TO authenticated;
-GRANT ALL ON TABLE public.user_app_sessions TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_app_sessions TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_app_sessions TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_app_sessions TO service_role;
 
 
 --
--- TOC entry 5843 (class 0 OID 0)
--- Dependencies: 316
+-- TOC entry 5992 (class 0 OID 0)
+-- Dependencies: 382
 -- Name: TABLE user_credits; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.user_credits TO anon;
-GRANT ALL ON TABLE public.user_credits TO authenticated;
-GRANT ALL ON TABLE public.user_credits TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_credits TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_credits TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_credits TO service_role;
 
 
 --
--- TOC entry 5844 (class 0 OID 0)
--- Dependencies: 317
+-- TOC entry 5993 (class 0 OID 0)
+-- Dependencies: 389
 -- Name: TABLE user_credit_balance; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.user_credit_balance TO anon;
-GRANT ALL ON TABLE public.user_credit_balance TO authenticated;
-GRANT ALL ON TABLE public.user_credit_balance TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_credit_balance TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_credit_balance TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_credit_balance TO service_role;
 
 
 --
--- TOC entry 5846 (class 0 OID 0)
--- Dependencies: 324
+-- TOC entry 5994 (class 0 OID 0)
+-- Dependencies: 378
 -- Name: TABLE user_preferences; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.user_preferences TO anon;
-GRANT ALL ON TABLE public.user_preferences TO authenticated;
-GRANT ALL ON TABLE public.user_preferences TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_preferences TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_preferences TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_preferences TO service_role;
 
 
 --
--- TOC entry 5851 (class 0 OID 0)
--- Dependencies: 315
+-- TOC entry 5995 (class 0 OID 0)
+-- Dependencies: 381
 -- Name: TABLE user_referrals; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.user_referrals TO anon;
-GRANT ALL ON TABLE public.user_referrals TO authenticated;
-GRANT ALL ON TABLE public.user_referrals TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_referrals TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_referrals TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_referrals TO service_role;
 
 
 --
--- TOC entry 5853 (class 0 OID 0)
--- Dependencies: 267
+-- TOC entry 5998 (class 0 OID 0)
+-- Dependencies: 329
 -- Name: TABLE users; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.users TO anon;
-GRANT ALL ON TABLE public.users TO authenticated;
-GRANT ALL ON TABLE public.users TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.users TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.users TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.users TO service_role;
 
 
 --
--- TOC entry 5854 (class 0 OID 0)
--- Dependencies: 288
+-- TOC entry 5999 (class 0 OID 0)
+-- Dependencies: 351
 -- Name: TABLE user_stats; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.user_stats TO anon;
-GRANT ALL ON TABLE public.user_stats TO authenticated;
-GRANT ALL ON TABLE public.user_stats TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_stats TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_stats TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.user_stats TO service_role;
 
 
 --
--- TOC entry 5855 (class 0 OID 0)
--- Dependencies: 310
+-- TOC entry 6001 (class 0 OID 0)
+-- Dependencies: 361
 -- Name: TABLE webhook_dead_letter_queue; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.webhook_dead_letter_queue TO anon;
-GRANT ALL ON TABLE public.webhook_dead_letter_queue TO authenticated;
-GRANT ALL ON TABLE public.webhook_dead_letter_queue TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_dead_letter_queue TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_dead_letter_queue TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_dead_letter_queue TO service_role;
 
 
 --
--- TOC entry 5856 (class 0 OID 0)
--- Dependencies: 312
+-- TOC entry 6002 (class 0 OID 0)
+-- Dependencies: 376
 -- Name: TABLE webhook_logs; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.webhook_logs TO anon;
-GRANT ALL ON TABLE public.webhook_logs TO authenticated;
-GRANT ALL ON TABLE public.webhook_logs TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_logs TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_logs TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_logs TO service_role;
 
 
 --
--- TOC entry 5857 (class 0 OID 0)
--- Dependencies: 311
+-- TOC entry 6004 (class 0 OID 0)
+-- Dependencies: 360
 -- Name: TABLE webhook_retry_queue; Type: ACL; Schema: public; Owner: postgres
 --
 
-GRANT ALL ON TABLE public.webhook_retry_queue TO anon;
-GRANT ALL ON TABLE public.webhook_retry_queue TO authenticated;
-GRANT ALL ON TABLE public.webhook_retry_queue TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_retry_queue TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_retry_queue TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE public.webhook_retry_queue TO service_role;
 
 
 --
--- TOC entry 5858 (class 0 OID 0)
--- Dependencies: 265
+-- TOC entry 6005 (class 0 OID 0)
+-- Dependencies: 328
 -- Name: TABLE messages; Type: ACL; Schema: realtime; Owner: supabase_realtime_admin
 --
 
-GRANT ALL ON TABLE realtime.messages TO postgres;
-GRANT ALL ON TABLE realtime.messages TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages TO dashboard_user;
 GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO anon;
 GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO authenticated;
 GRANT SELECT,INSERT,UPDATE ON TABLE realtime.messages TO service_role;
 
 
 --
--- TOC entry 5859 (class 0 OID 0)
--- Dependencies: 313
+-- TOC entry 6006 (class 0 OID 0)
+-- Dependencies: 379
 -- Name: TABLE messages_2025_07_12; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.messages_2025_07_12 TO postgres;
-GRANT ALL ON TABLE realtime.messages_2025_07_12 TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_12 TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_12 TO dashboard_user;
 
 
 --
--- TOC entry 5860 (class 0 OID 0)
--- Dependencies: 314
+-- TOC entry 6007 (class 0 OID 0)
+-- Dependencies: 380
 -- Name: TABLE messages_2025_07_13; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.messages_2025_07_13 TO postgres;
-GRANT ALL ON TABLE realtime.messages_2025_07_13 TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_13 TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_13 TO dashboard_user;
 
 
 --
--- TOC entry 5861 (class 0 OID 0)
--- Dependencies: 319
+-- TOC entry 6008 (class 0 OID 0)
+-- Dependencies: 385
 -- Name: TABLE messages_2025_07_14; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.messages_2025_07_14 TO postgres;
-GRANT ALL ON TABLE realtime.messages_2025_07_14 TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_14 TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_14 TO dashboard_user;
 
 
 --
--- TOC entry 5862 (class 0 OID 0)
--- Dependencies: 320
+-- TOC entry 6009 (class 0 OID 0)
+-- Dependencies: 387
 -- Name: TABLE messages_2025_07_15; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.messages_2025_07_15 TO postgres;
-GRANT ALL ON TABLE realtime.messages_2025_07_15 TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_15 TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_15 TO dashboard_user;
 
 
 --
--- TOC entry 5863 (class 0 OID 0)
--- Dependencies: 321
+-- TOC entry 6010 (class 0 OID 0)
+-- Dependencies: 388
 -- Name: TABLE messages_2025_07_16; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.messages_2025_07_16 TO postgres;
-GRANT ALL ON TABLE realtime.messages_2025_07_16 TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_16 TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_16 TO dashboard_user;
 
 
 --
--- TOC entry 5864 (class 0 OID 0)
--- Dependencies: 327
+-- TOC entry 6011 (class 0 OID 0)
+-- Dependencies: 391
 -- Name: TABLE messages_2025_07_17; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.messages_2025_07_17 TO postgres;
-GRANT ALL ON TABLE realtime.messages_2025_07_17 TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_17 TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_17 TO dashboard_user;
 
 
 --
--- TOC entry 5865 (class 0 OID 0)
--- Dependencies: 330
+-- TOC entry 6012 (class 0 OID 0)
+-- Dependencies: 395
 -- Name: TABLE messages_2025_07_18; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.messages_2025_07_18 TO postgres;
-GRANT ALL ON TABLE realtime.messages_2025_07_18 TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_18 TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.messages_2025_07_18 TO dashboard_user;
 
 
 --
--- TOC entry 5866 (class 0 OID 0)
--- Dependencies: 257
+-- TOC entry 6013 (class 0 OID 0)
+-- Dependencies: 320
 -- Name: TABLE schema_migrations; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.schema_migrations TO postgres;
-GRANT ALL ON TABLE realtime.schema_migrations TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.schema_migrations TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.schema_migrations TO dashboard_user;
 GRANT SELECT ON TABLE realtime.schema_migrations TO anon;
 GRANT SELECT ON TABLE realtime.schema_migrations TO authenticated;
 GRANT SELECT ON TABLE realtime.schema_migrations TO service_role;
-GRANT ALL ON TABLE realtime.schema_migrations TO supabase_realtime_admin;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.schema_migrations TO supabase_realtime_admin;
 
 
 --
--- TOC entry 5867 (class 0 OID 0)
--- Dependencies: 262
+-- TOC entry 6014 (class 0 OID 0)
+-- Dependencies: 325
 -- Name: TABLE subscription; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
-GRANT ALL ON TABLE realtime.subscription TO postgres;
-GRANT ALL ON TABLE realtime.subscription TO dashboard_user;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.subscription TO postgres;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.subscription TO dashboard_user;
 GRANT SELECT ON TABLE realtime.subscription TO anon;
 GRANT SELECT ON TABLE realtime.subscription TO authenticated;
 GRANT SELECT ON TABLE realtime.subscription TO service_role;
-GRANT ALL ON TABLE realtime.subscription TO supabase_realtime_admin;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE realtime.subscription TO supabase_realtime_admin;
 
 
 --
--- TOC entry 5868 (class 0 OID 0)
--- Dependencies: 261
+-- TOC entry 6015 (class 0 OID 0)
+-- Dependencies: 324
 -- Name: SEQUENCE subscription_id_seq; Type: ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -16627,54 +17557,54 @@
 
 
 --
--- TOC entry 5870 (class 0 OID 0)
--- Dependencies: 240
+-- TOC entry 6017 (class 0 OID 0)
+-- Dependencies: 303
 -- Name: TABLE buckets; Type: ACL; Schema: storage; Owner: supabase_storage_admin
 --
 
-GRANT ALL ON TABLE storage.buckets TO anon;
-GRANT ALL ON TABLE storage.buckets TO authenticated;
-GRANT ALL ON TABLE storage.buckets TO service_role;
-GRANT ALL ON TABLE storage.buckets TO postgres WITH GRANT OPTION;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.buckets TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.buckets TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.buckets TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.buckets TO postgres;
 
 
 --
--- TOC entry 5872 (class 0 OID 0)
--- Dependencies: 241
+-- TOC entry 6019 (class 0 OID 0)
+-- Dependencies: 304
 -- Name: TABLE objects; Type: ACL; Schema: storage; Owner: supabase_storage_admin
 --
 
-GRANT ALL ON TABLE storage.objects TO anon;
-GRANT ALL ON TABLE storage.objects TO authenticated;
-GRANT ALL ON TABLE storage.objects TO service_role;
-GRANT ALL ON TABLE storage.objects TO postgres WITH GRANT OPTION;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.objects TO anon;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.objects TO authenticated;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.objects TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.objects TO postgres;
 
 
 --
--- TOC entry 5873 (class 0 OID 0)
--- Dependencies: 258
+-- TOC entry 6020 (class 0 OID 0)
+-- Dependencies: 321
 -- Name: TABLE s3_multipart_uploads; Type: ACL; Schema: storage; Owner: supabase_storage_admin
 --
 
-GRANT ALL ON TABLE storage.s3_multipart_uploads TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.s3_multipart_uploads TO service_role;
 GRANT SELECT ON TABLE storage.s3_multipart_uploads TO authenticated;
 GRANT SELECT ON TABLE storage.s3_multipart_uploads TO anon;
 
 
 --
--- TOC entry 5874 (class 0 OID 0)
--- Dependencies: 259
+-- TOC entry 6021 (class 0 OID 0)
+-- Dependencies: 322
 -- Name: TABLE s3_multipart_uploads_parts; Type: ACL; Schema: storage; Owner: supabase_storage_admin
 --
 
-GRANT ALL ON TABLE storage.s3_multipart_uploads_parts TO service_role;
+GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLE storage.s3_multipart_uploads_parts TO service_role;
 GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO authenticated;
 GRANT SELECT ON TABLE storage.s3_multipart_uploads_parts TO anon;
 
 
 --
--- TOC entry 5875 (class 0 OID 0)
--- Dependencies: 243
+-- TOC entry 6022 (class 0 OID 0)
+-- Dependencies: 306
 -- Name: TABLE secrets; Type: ACL; Schema: vault; Owner: supabase_admin
 --
 
@@ -16683,8 +17613,8 @@
 
 
 --
--- TOC entry 5876 (class 0 OID 0)
--- Dependencies: 244
+-- TOC entry 6023 (class 0 OID 0)
+-- Dependencies: 307
 -- Name: TABLE decrypted_secrets; Type: ACL; Schema: vault; Owner: supabase_admin
 --
 
@@ -16693,7 +17623,7 @@
 
 
 --
--- TOC entry 2824 (class 826 OID 16601)
+-- TOC entry 2902 (class 826 OID 16590)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -16702,7 +17632,7 @@
 
 
 --
--- TOC entry 2825 (class 826 OID 16602)
+-- TOC entry 2903 (class 826 OID 16591)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
@@ -16711,16 +17641,16 @@
 
 
 --
--- TOC entry 2823 (class 826 OID 16600)
+-- TOC entry 2901 (class 826 OID 16589)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: auth; Owner: supabase_auth_admin
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES TO postgres;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT ALL ON TABLES TO dashboard_user;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_auth_admin IN SCHEMA auth GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO dashboard_user;
 
 
 --
--- TOC entry 2834 (class 826 OID 16680)
+-- TOC entry 2912 (class 826 OID 16664)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -16728,7 +17658,7 @@
 
 
 --
--- TOC entry 2833 (class 826 OID 16679)
+-- TOC entry 2911 (class 826 OID 16663)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
 --
 
@@ -16736,15 +17666,15 @@
 
 
 --
--- TOC entry 2832 (class 826 OID 16678)
+-- TOC entry 2910 (class 826 OID 16662)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: extensions; Owner: supabase_admin
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT ALL ON TABLES TO postgres WITH GRANT OPTION;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA extensions GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres WITH GRANT OPTION;
 
 
 --
--- TOC entry 2837 (class 826 OID 16635)
+-- TOC entry 2915 (class 826 OID 16624)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
 --
 
@@ -16755,7 +17685,7 @@
 
 
 --
--- TOC entry 2836 (class 826 OID 16634)
+-- TOC entry 2914 (class 826 OID 16623)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
 --
 
@@ -16766,18 +17696,18 @@
 
 
 --
--- TOC entry 2835 (class 826 OID 16633)
+-- TOC entry 2913 (class 826 OID 16622)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql; Owner: supabase_admin
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO postgres;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO anon;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO authenticated;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT ALL ON TABLES TO service_role;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO anon;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO authenticated;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO service_role;
 
 
 --
--- TOC entry 2829 (class 826 OID 16615)
+-- TOC entry 2907 (class 826 OID 16604)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
 --
 
@@ -16788,7 +17718,7 @@
 
 
 --
--- TOC entry 2831 (class 826 OID 16614)
+-- TOC entry 2909 (class 826 OID 16603)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
 --
 
@@ -16799,18 +17729,18 @@
 
 
 --
--- TOC entry 2830 (class 826 OID 16613)
+-- TOC entry 2908 (class 826 OID 16602)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: graphql_public; Owner: supabase_admin
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO postgres;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO anon;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO authenticated;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT ALL ON TABLES TO service_role;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO anon;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO authenticated;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA graphql_public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO service_role;
 
 
 --
--- TOC entry 2816 (class 826 OID 16488)
+-- TOC entry 2894 (class 826 OID 16477)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: postgres
 --
 
@@ -16821,7 +17751,7 @@
 
 
 --
--- TOC entry 2817 (class 826 OID 16489)
+-- TOC entry 2895 (class 826 OID 16478)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -16832,7 +17762,7 @@
 
 
 --
--- TOC entry 2815 (class 826 OID 16487)
+-- TOC entry 2893 (class 826 OID 16476)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: postgres
 --
 
@@ -16843,7 +17773,7 @@
 
 
 --
--- TOC entry 2819 (class 826 OID 16491)
+-- TOC entry 2897 (class 826 OID 16480)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
 --
 
@@ -16854,29 +17784,29 @@
 
 
 --
--- TOC entry 2814 (class 826 OID 16486)
+-- TOC entry 2916 (class 826 OID 16475)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: postgres
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO postgres;
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO anon;
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO authenticated;
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT ALL ON TABLES TO service_role;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO anon;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO authenticated;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO service_role;
 
 
 --
--- TOC entry 2818 (class 826 OID 16490)
+-- TOC entry 2896 (class 826 OID 16479)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: public; Owner: supabase_admin
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO postgres;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO anon;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO authenticated;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT ALL ON TABLES TO service_role;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO anon;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO authenticated;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA public GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO service_role;
 
 
 --
--- TOC entry 2827 (class 826 OID 16605)
+-- TOC entry 2905 (class 826 OID 16594)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -16885,7 +17815,7 @@
 
 
 --
--- TOC entry 2828 (class 826 OID 16606)
+-- TOC entry 2906 (class 826 OID 16595)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
 --
 
@@ -16894,16 +17824,16 @@
 
 
 --
--- TOC entry 2826 (class 826 OID 16604)
+-- TOC entry 2904 (class 826 OID 16593)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: realtime; Owner: supabase_admin
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES TO postgres;
-ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT ALL ON TABLES TO dashboard_user;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres;
+ALTER DEFAULT PRIVILEGES FOR ROLE supabase_admin IN SCHEMA realtime GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO dashboard_user;
 
 
 --
--- TOC entry 2822 (class 826 OID 16543)
+-- TOC entry 2900 (class 826 OID 16532)
 -- Name: DEFAULT PRIVILEGES FOR SEQUENCES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
 --
 
@@ -16914,7 +17844,7 @@
 
 
 --
--- TOC entry 2821 (class 826 OID 16542)
+-- TOC entry 2899 (class 826 OID 16531)
 -- Name: DEFAULT PRIVILEGES FOR FUNCTIONS; Type: DEFAULT ACL; Schema: storage; Owner: postgres
 --
 
@@ -16925,18 +17855,18 @@
 
 
 --
--- TOC entry 2820 (class 826 OID 16541)
+-- TOC entry 2898 (class 826 OID 16530)
 -- Name: DEFAULT PRIVILEGES FOR TABLES; Type: DEFAULT ACL; Schema: storage; Owner: postgres
 --
 
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO postgres;
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO anon;
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO authenticated;
-ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT ALL ON TABLES TO service_role;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO postgres;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO anon;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO authenticated;
+ALTER DEFAULT PRIVILEGES FOR ROLE postgres IN SCHEMA storage GRANT SELECT,INSERT,REFERENCES,DELETE,TRIGGER,TRUNCATE,UPDATE ON TABLES TO service_role;
 
 
 --
--- TOC entry 4027 (class 3466 OID 16619)
+-- TOC entry 4104 (class 3466 OID 16608)
 -- Name: issue_graphql_placeholder; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
 --
 
@@ -16948,7 +17878,7 @@
 ALTER EVENT TRIGGER issue_graphql_placeholder OWNER TO supabase_admin;
 
 --
--- TOC entry 4032 (class 3466 OID 16698)
+-- TOC entry 4109 (class 3466 OID 16677)
 -- Name: issue_pg_cron_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
 --
 
@@ -16960,7 +17890,7 @@
 ALTER EVENT TRIGGER issue_pg_cron_access OWNER TO supabase_admin;
 
 --
--- TOC entry 4026 (class 3466 OID 16617)
+-- TOC entry 4103 (class 3466 OID 16606)
 -- Name: issue_pg_graphql_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
 --
 
@@ -16972,7 +17902,7 @@
 ALTER EVENT TRIGGER issue_pg_graphql_access OWNER TO supabase_admin;
 
 --
--- TOC entry 4033 (class 3466 OID 16701)
+-- TOC entry 4110 (class 3466 OID 16678)
 -- Name: issue_pg_net_access; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
 --
 
@@ -16984,7 +17914,7 @@
 ALTER EVENT TRIGGER issue_pg_net_access OWNER TO supabase_admin;
 
 --
--- TOC entry 4028 (class 3466 OID 16620)
+-- TOC entry 4105 (class 3466 OID 16609)
 -- Name: pgrst_ddl_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
 --
 
@@ -16995,7 +17925,7 @@
 ALTER EVENT TRIGGER pgrst_ddl_watch OWNER TO supabase_admin;
 
 --
--- TOC entry 4029 (class 3466 OID 16621)
+-- TOC entry 4106 (class 3466 OID 16610)
 -- Name: pgrst_drop_watch; Type: EVENT TRIGGER; Schema: -; Owner: supabase_admin
 --
 
@@ -17005,7 +17935,7 @@
 
 ALTER EVENT TRIGGER pgrst_drop_watch OWNER TO supabase_admin;
 
--- Completed on 2025-07-15 13:43:35 +0545
+-- Completed on 2025-07-15 13:41:15 +0545
 
 --
 -- PostgreSQL database dump complete
